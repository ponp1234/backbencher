<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Magnets & Interactions - P4 Science</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
             margin: 0;
             font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
             background: #f1f5f9;
             overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            color: #0360a5;
        }
        
        .slide-modal {
             width: 100vw;
             height: 100vh;
             background: #f1f5f9;
             display: flex;
             align-items: stretch;
             justify-content: center;
             transition: padding-left 0.3s ease;
            position: relative;
        }
        
        .slide-modal.sidebar-open { padding-left: 280px; }
        
        .sidebar {
            width: 280px;
            background: #ffffff;
            border-right: 1px solid #e5e7eb;
            padding: 20px 0 0 0;
            display: flex;
            flex-direction: column;
            gap: 4px;
            overflow-y: auto;
            position: fixed;
            left: -280px;
            top: 0;
            height: 100vh;
            z-index: 1000;
            transition: left 0.3s ease;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            -webkit-overflow-scrolling: touch;
        }
        
        .sidebar.open { left: 0; }
        
        .menu-toggle {
            position: fixed;
            top: 16px;
            left: 16px;
            z-index: 1001;
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px 14px;
            cursor: pointer;
            font-size: 1.3rem;
            box-shadow: 0 3px 12px rgba(220,38,38,0.3);
            transition: all 0.3s ease;
            min-height: 50px;
            min-width: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .menu-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220,38,38,0.4);
        }
        
        .menu-toggle.sidebar-open {
            left: 16px;
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            transform: none;
        }
        
        .subtopic-section {
            margin-bottom: 16px;
        }
        .subtopic-header {
            background: #e5e7eb;
            padding: 12px 20px;
            font-size: 0.85rem;
            font-weight: 600;
            color: #dc2626;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .subtopic-btn {
            background: none;
            border: none;
            text-align: left;
            padding: 14px 24px;
            font-size: 0.95rem;
            color: #374151;
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 4px solid transparent;
            width: 100%;
            display: block;
            min-height: 50px;
            line-height: 1.5;
        }
        .subtopic-btn.active, .subtopic-btn:hover {
            background: #fef2f2;
            color: #dc2626;
            border-left: 4px solid #dc2626;
            font-weight: 600;
        }
        
        .slide-container {
             background: #ffffff;
             border-radius: 12px;
             width: 100vw;
             max-width: none;
             height: 95vh;
             box-shadow: 0 6px 24px rgba(0,0,0,0.1);
             display: flex;
             flex-direction: column;
             flex: 1;
             margin: 12px;
            position: relative;
        }
        
        .slide-header {
             background: linear-gradient(135deg, #dc2626, #b91c1c);
             color: white;
             padding: 20px 32px;
             display: flex;
             justify-content: space-between;
             align-items: center;
             flex-shrink: 0;
            border-radius: 12px 12px 0 0;
        }
        .slide-title {
             font-size: 1.5rem;
             font-weight: 700;
             display: flex;
             align-items: center;
             gap: 12px;
             margin: 0;
            letter-spacing: -0.02em;
        }
        .slide-counter {
             background: rgba(255,255,255,0.15);
             padding: 8px 16px;
             border-radius: 20px;
             font-weight: 600;
             font-size: 0.9rem;
        }
        
        .slide-content {
             flex: 1;
             overflow-y: auto;
             display: flex;
             flex-direction: column;
            background: #f8fafc;
             padding: 24px;
            -webkit-overflow-scrolling: touch;
        }
        
        .main-slide-area {
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
            min-height: 600px;
        }
        
        .slide {
             width: 100%;
             margin: 0 auto;
             padding: 32px 24px;
             background: #ffffff;
             border-radius: 16px;
             box-shadow: 0 4px 20px rgba(220,38,38,0.08);
             display: flex;
             flex-direction: column;
             align-items: center;
             text-align: center;
            line-height: 1.6;
        }
        
        .slide h2, .slide h3 {
            color: #dc2626;
            margin-bottom: 16px;
            font-weight: 700;
        }
        
        .slide p {
            color: #374151;
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto 16px;
            line-height: 1.7;
        }

        .slide-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
            width: 100%;
            max-width: 700px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
            width: 100%;
            max-width: 700px;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
            width: 100%;
            max-width: 800px;
        }

        .info-card {
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .info-card h4 {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1rem;
            color: #dc2626;
        }

        .info-card p {
            font-size: 0.95rem;
            margin: 0;
        }

        .info-card ul {
            text-align: left;
            margin: 10px 0;
            padding-left: 20px;
        }

        .info-card li {
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .red-card { background: linear-gradient(135deg, #fecaca 0%, #f87171 100%); }
        .blue-card { background: linear-gradient(135deg, #dbeafe 0%, #93c5fd 100%); }
        .purple-card { background: linear-gradient(135deg, #e9d5ff 0%, #c4b5fd 100%); }
        .yellow-card { background: linear-gradient(135deg, #fef3c7 0%, #fcd34d 100%); }
        .orange-card { background: linear-gradient(135deg, #fed7aa 0%, #fdba74 100%); }
        .green-card { background: linear-gradient(135deg, #d4f4dd 0%, #a7f3d0 100%); }
        .gray-card { background: linear-gradient(135deg, #f3f4f6 0%, #d1d5db 100%); }
        .pink-card { background: linear-gradient(135deg, #fce7f3 0%, #f9a8d4 100%); }

        .magnet-diagram {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            max-width: 700px;
            text-align: left;
            border: 2px solid #dc2626;
        }

        .magnet-diagram h4 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #991b1b;
            text-align: center;
        }

        .magnet-diagram ul {
            list-style: none;
            padding: 0;
        }

        .magnet-diagram li {
            padding: 8px 0;
            font-size: 1rem;
            color: #dc2626;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .magnet-diagram strong {
            color: #991b1b;
            font-size: 1.1rem;
        }

        .process-flow {
            background: linear-gradient(135deg, #fef3c7 0%, #fcd34d 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            max-width: 700px;
            text-align: left;
            border: 2px solid #f59e0b;
        }

        .process-flow h4 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #92400e;
            text-align: center;
        }

        .process-step {
            display: flex;
            align-items: center;
            margin: 15px 0;
            padding: 12px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            gap: 15px;
        }

        .step-number {
            background: #f59e0b;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-content strong {
            color: #92400e;
            display: block;
            margin-bottom: 5px;
        }

        .step-content p {
            margin: 0;
            font-size: 0.9rem;
            color: #a16207;
        }

        .video-container {
            width: 100%;
            max-width: 700px;
            margin: 24px 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .video-placeholder {
            width: 100%;
            height: 250px;
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.1rem;
            border-radius: 12px;
            text-align: center;
            padding: 20px;
        }

        .fun-fact {
            background: linear-gradient(135deg, #fce7f3 0%, #f9a8d4 100%);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            max-width: 600px;
            border-left: 4px solid #ec4899;
        }

        .fun-fact h4 {
            color: #be185d;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .fun-fact p {
            color: #be185d;
            margin: 0;
            font-size: 0.95rem;
        }

        /* Interactive Magnet Experiment */
        .magnet-experiment {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            max-width: 700px;
            border: 2px solid #0ea5e9;
        }

        .experiment-area {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            min-height: 300px;
            position: relative;
            border: 2px dashed #e5e7eb;
        }

        .magnet-object {
            position: absolute;
            width: 60px;
            height: 30px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }

        .magnet-object.dragging {
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .magnet-north {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
        }

        .magnet-south {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
        }

        .test-object {
            background: #f3f4f6;
            color: #374151;
            border: 2px solid #d1d5db;
        }

        .test-object.magnetic {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
        }

        .test-object.attracted {
            animation: attract 0.5s ease-in-out;
        }

        .test-object.repelled {
            animation: repel 0.5s ease-in-out;
        }

        @keyframes attract {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); background: #22c55e; }
            100% { transform: scale(1); }
        }

        @keyframes repel {
            0% { transform: scale(1); }
            50% { transform: scale(0.8); background: #ef4444; }
            100% { transform: scale(1); }
        }

        .experiment-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .experiment-btn {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .experiment-btn:hover {
            background: linear-gradient(135deg, #b91c1c, #991b1b);
            transform: translateY(-1px);
        }

        /* Magnetic Field Visualization */
        .magnetic-field {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            max-width: 700px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .field-visualization {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            min-height: 250px;
            position: relative;
            overflow: hidden;
        }

        .field-line {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, #dc2626, #2563eb);
            border-radius: 1px;
            opacity: 0.7;
        }

        .field-magnet {
            position: absolute;
            width: 80px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .field-magnet.north-side {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
        }

        .field-magnet.south-side {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
        }

        /* Compass Simulation */
        .compass-container {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            max-width: 600px;
            border: 2px solid #22c55e;
        }

        .compass {
            width: 150px;
            height: 150px;
            border: 4px solid #374151;
            border-radius: 50%;
            background: white;
            position: relative;
            margin: 20px auto;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .compass-needle {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, #dc2626 0%, #dc2626 50%, #6b7280 50%, #6b7280 100%);
            transform-origin: center;
            transform: translate(-50%, -50%) rotate(0deg);
            transition: transform 1s ease-in-out;
            border-radius: 2px;
        }

        .compass-center {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 12px;
            height: 12px;
            background: #374151;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        .compass-directions {
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            font-weight: bold;
            color: #374151;
        }

        .compass-n { position: absolute; top: 0; left: 50%; transform: translateX(-50%); }
        .compass-s { position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); }
        .compass-e { position: absolute; right: 0; top: 50%; transform: translateY(-50%); }
        .compass-w { position: absolute; left: 0; top: 50%; transform: translateY(-50%); }

        /* Quiz Styles */
        .quiz-option {
             background: #ffffff;
             border: 2px solid #e5e7eb;
             border-radius: 10px;
             padding: 16px 20px;
             cursor: pointer;
             margin: 8px 0;
             font-size: 1rem;
             width: 100%;
            max-width: 600px;
            transition: all 0.2s ease;
            min-height: 50px;
            text-align: left;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .quiz-option:hover {
            border-color: #dc2626;
            transform: translateY(-1px);
        }
        .quiz-option.selected {
             background: #fef2f2;
             border-color: #dc2626;
             color: #991b1b;
         }
        .quiz-option.correct {
             background: #dcfce7;
             border-color: #22c55e;
             color: #15803d;
         }
        .quiz-option.incorrect {
             background: #fee2e2;
             border-color: #dc2626;
             color: #b91c1c;
         }
        .quiz-explanation {
             background: #f0fdf4;
             border-radius: 10px;
             padding: 20px;
             border-left: 4px solid #22c55e;
             margin-top: 20px;
             display: none;
             max-width: 600px;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        .quiz-explanation.show { display: block; }
        
        .slide-navigation {
             background: #ffffff;
             padding: 20px 32px;
             display: flex;
             justify-content: space-between;
             align-items: center;
             border-top: 1px solid #e5e7eb;
             flex-shrink: 0;
            border-radius: 0 0 12px 12px;
        }
        
        .nav-btn {
             background: linear-gradient(135deg, #dc2626, #b91c1c);
             color: white;
             border: none;
             border-radius: 10px;
             padding: 12px 24px;
             font-size: 1rem;
             font-weight: 600;
             cursor: pointer;
             min-height: 50px;
            transition: all 0.2s ease;
        }
        .nav-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(220,38,38,0.3);
        }
        .nav-btn:disabled {
             opacity: 0.5;
             cursor: not-allowed;
             transform: none;
            box-shadow: none;
        }
        .slide-progress {
             display: flex;
             gap: 8px;
             align-items: center;
             flex-wrap: wrap;
            justify-content: center;
        }
        .progress-dot {
             width: 10px;
             height: 10px;
             border-radius: 50%;
             background: #d1d5db;
             transition: all 0.2s ease;
        }
        .progress-dot.active {
             background: linear-gradient(135deg, #dc2626, #b91c1c);
            transform: scale(1.3);
        }
        
        .back-home-btn {
            background: #ffffff;
            color: #dc2626;
            font-weight: 600;
            border-radius: 10px;
            padding: 8px 16px;
            text-decoration: none;
            box-shadow: 0 2px 8px rgba(220,38,38,0.1);
            font-size: 0.9rem;
            border: none;
            margin-left: 12px;
            transition: all 0.2s ease;
            min-height: 40px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        .back-home-btn:hover {
            background: #fef2f2;
            color: #991b1b;
        }
        
        /* Overlay for mobile menu */
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
            transition: opacity 0.3s ease;
        }
        
        .sidebar-overlay.show {
            display: block;
            opacity: 1;
        }

        /* AI Help Floating Widget */
        .ai-help-widget {
            position: fixed;
            top: 16px;
            right: 16px;
            z-index: 1002;
            font-family: inherit;
        }
        
        .ai-help-toggle {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            cursor: pointer;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(16, 185, 129, 0.4);
            transition: all 0.3s ease;
        }
        
        .ai-help-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(16, 185, 129, 0.5);
        }
        
        .ai-help-toggle.active {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            box-shadow: 0 4px 20px rgba(239, 68, 68, 0.4);
        }
        
        .ai-help-panel {
            position: absolute;
            top: 70px;
            right: 0;
            width: 340px;
            max-height: 480px;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            border: 1px solid #e5e7eb;
            transform: translateY(-20px) scale(0.95);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .ai-help-panel.open {
            transform: translateY(0) scale(1);
            opacity: 1;
            visibility: visible;
        }
        
        .ai-help-header {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 16px 20px;
            border-radius: 12px 12px 0 0;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.95rem;
        }
        
        .ai-help-content {
            padding: 20px;
            max-height: 320px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .ai-chat-messages {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 16px;
            min-height: 80px;
        }
        
        .ai-message {
            padding: 10px 14px;
            border-radius: 10px;
            font-size: 0.85rem;
            line-height: 1.5;
            word-wrap: break-word;
        }
        
        .ai-message.user {
            background: #fef2f2;
            color: #991b1b;
            align-self: flex-end;
            max-width: 80%;
        }
        
        .ai-message.bot {
            background: #f0fdf4;
            color: #166534;
            align-self: flex-start;
            max-width: 90%;
        }
        
        .ai-input-area {
            display: flex;
            gap: 8px;
            border-top: 1px solid #e5e7eb;
            padding-top: 16px;
        }
        
        .ai-input {
            flex: 1;
            padding: 10px 14px;
            border: 1px solid #e5e7eb;
            border-radius: 20px;
            font-size: 0.9rem;
            outline: none;
            transition: border-color 0.2s;
            min-height: 40px;
        }
        
        .ai-input:focus {
            border-color: #10b981;
        }
        
        .ai-send-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
            flex-shrink: 0;
        }
        
        .ai-send-btn:hover {
            transform: scale(1.05);
        }
        
        .ai-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 16px;
        }
        
        .ai-suggestion {
            background: #f3f4f6;
            color: #374151;
            border: none;
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 36px;
        }
        
        .ai-suggestion:hover {
            background: #fef2f2;
            color: #991b1b;
        }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .slide-modal {
                 padding-left: 0 !important;
             }
            .slide-modal.sidebar-open {
                 padding-left: 0;
             }
            
            .menu-toggle {
                 top: 12px;
                left: 12px;
                min-height: 48px;
                min-width: 48px;
                font-size: 1.2rem;
                border-radius: 8px;
            }
            
            .sidebar {
                 width: 85vw;
                max-width: 320px;
                border-radius: 0 16px 16px 0;
                padding-top: 70px;
            }
            
            .slide-container {
                 width: 100vw;
                 height: 100vh;
                 border-radius: 0;
                 margin: 0;
            }
            
            .slide-header {
                padding: 16px 20px;
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .slide-title {
                font-size: 1.2rem;
                gap: 8px;
            }
            
            .slide {
                 padding: 20px 16px;
                 border-radius: 0;
                 margin: 0;
            }
            
            .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .slide-navigation {
                 padding: 16px 20px;
                flex-wrap: wrap;
                gap: 12px;
            }
            
            .nav-btn {
                font-size: 0.9rem;
                padding: 10px 20px;
                min-height: 48px;
            }
            
            .slide-progress {
                order: -1;
                width: 100%;
                justify-content: center;
                margin-bottom: 8px;
            }
            
            .progress-dot {
                width: 8px;
                height: 8px;
            }
            
            .ai-help-widget {
                top: 12px;
                right: 12px;
            }
            
            .ai-help-toggle {
                width: 52px;
                height: 52px;
                font-size: 1.3rem;
            }
            
            .ai-help-panel {
                width: calc(100vw - 40px);
                max-width: 320px;
                top: 70px;
                right: 10px;
                max-height: 400px;
            }

            .experiment-area {
                min-height: 200px;
            }

            .magnet-object {
                width: 50px;
                height: 25px;
                font-size: 0.8rem;
            }

            .compass {
                width: 120px;
                height: 120px;
            }

            .compass-needle {
                width: 80px;
            }
        }

        /* Small mobile phones */
        @media (max-width: 480px) {
            .menu-toggle {
                top: 10px;
                left: 10px;
                min-height: 48px;
                min-width: 48px;
            }
            
            .sidebar {
                width: 90vw;
                max-width: 300px;
            }
            
            .slide-header {
                padding: 12px 16px;
            }
            
            .slide-title {
                font-size: 1.1rem;
            }
            
            .slide {
                padding: 16px 12px;
            }
            
            .slide h2, .slide h3 {
                font-size: 1.2rem;
            }
            
            .slide p {
                font-size: 0.95rem;
            }
            
            .slide-navigation {
                padding: 12px 16px;
            }
            
            .nav-btn {
                font-size: 0.85rem;
                padding: 8px 16px;
                min-height: 44px;
            }
            
            .ai-help-widget {
                top: 10px;
                right: 10px;
            }
            
            .ai-help-toggle {
                width: 48px;
                height: 48px;
                font-size: 1.2rem;
            }
            
            .ai-help-panel {
                width: calc(100vw - 30px);
                right: 5px;
            }

            .experiment-area {
                min-height: 180px;
            }

            .magnet-object {
                width: 45px;
                height: 22px;
                font-size: 0.7rem;
            }

            .compass {
                width: 100px;
                height: 100px;
            }

            .compass-needle {
                width: 60px;
            }
        }

        /* Touch improvements */
        @media (hover: none) and (pointer: coarse) {
            .nav-btn:hover,
            .menu-toggle:hover,
            .ai-help-toggle:hover,
            .quiz-option:hover,
            .subtopic-btn:hover,
            .back-home-btn:hover,
            .ai-suggestion:hover {
                transform: none;
                box-shadow: inherit;
            }
            
            .nav-btn:active,
            .menu-toggle:active,
            .ai-help-toggle:active,
            .subtopic-btn:active,
            .back-home-btn:active,
            .ai-suggestion:active {
                transform: scale(0.98);
            }
            
            .quiz-option:active {
                transform: scale(0.99);
            }
        }
    </style>
</head>
<body>

<div class="sidebar-overlay" id="sidebar-overlay"></div>

<button class="menu-toggle" id="menu-toggle" onclick="toggleSidebar()">
    🧲
</button>

<div class="slide-modal" id="slide-modal">
    <div class="sidebar" id="sidebar">
        <!-- Subtopics will be rendered here -->
    </div>
    
    <div class="slide-container">
        <div class="slide-header">
            <span style="display:flex;align-items:center;">
                <h2 class="slide-title" style="margin:0;">
                    <span id="slide-icon">🧲</span>
                    <span id="slide-title-text">Magnets & Interactions</span>
                </h2>
            </span>
            <span style="display:flex;align-items:center;flex-wrap:wrap;gap:8px;">
                <div class="slide-counter" id="slide-counter" style="display:inline-block;">1 / 20</div>
                <a href="#" class="back-home-btn">🏠 Back to Home</a>
            </span>
        </div>
        
        <div class="slide-content" id="slide-content">
            <div class="main-slide-area" id="main-slide-area"></div>
        </div>
        
        <div class="slide-navigation">
            <div class="slide-progress" id="slide-progress"></div>
            <button class="nav-btn" id="prev-slide-btn" onclick="previousSlide()" disabled>← Previous</button>
            <button class="nav-btn" id="next-slide-btn" onclick="nextSlide()">Next →</button>
        </div>
    </div>
</div>

<!-- AI Help Widget -->
<div class="ai-help-widget">
    <button class="ai-help-toggle" id="ai-help-toggle" onclick="toggleAIHelp()">🤖</button>
    <div class="ai-help-panel" id="ai-help-panel">
        <div class="ai-help-header">
            <span>🤖</span>
            <span>Magnet AI Assistant</span>
        </div>
        <div class="ai-help-content">
            <div class="ai-suggestions">
                <button class="ai-suggestion" onclick="askAI('What are magnets?')">What are magnets?</button>
                <button class="ai-suggestion" onclick="askAI('How do magnets work?')">How do magnets work?</button>
                <button class="ai-suggestion" onclick="askAI('Uses of magnets')">Uses of magnets</button>
            </div>
            <div class="ai-chat-messages" id="ai-chat-messages">
                <div class="ai-message bot">
                    Hi! I'm your Magnet AI assistant. Ask me anything about magnets, magnetic fields, and how they work! 🧲
                </div>
            </div>
            <div class="ai-input-area">
                <input type="text" class="ai-input" id="ai-input" placeholder="Ask me about magnets..." onkeypress="handleAIKeyPress(event)">
                <button class="ai-send-btn" onclick="sendAIMessage()">➤</button>
            </div>
        </div>
    </div>
</div>

<script>
// Complete slides data with all 20 slides
const slides = [
    {
        content: `
            <div class="slide-icon">🧲</div>
            <h2>What are Magnets?</h2>
            <div class="video-container">
                <div class="video-placeholder">
                    🎬 Educational Video: Amazing World of Magnets
                </div>
            </div>
            <p>Magnets are special objects that can attract certain metals like iron, nickel, and cobalt. They have invisible forces called magnetic fields!</p>
            <div class="magnet-diagram">
                <h4>Key Properties of Magnets:</h4>
                <ul>
                    <li>🧲 <strong>Attraction:</strong> Pull magnetic materials toward them</li>
                    <li>⚡ <strong>Invisible Force:</strong> Work without touching objects</li>
                    <li>🔄 <strong>Two Poles:</strong> Every magnet has North and South poles</li>
                    <li>🌍 <strong>Magnetic Field:</strong> Area around magnet where force works</li>
                </ul>
            </div>
            <div class="fun-fact">
                <h4>🤯 Amazing Fact!</h4>
                <p>The word "magnet" comes from ancient Greece, where people found magnetic rocks called "magnetite" near a city called Magnesia!</p>
            </div>
        `,
        notes: {
            text: "Magnets are fascinating objects that demonstrate invisible forces. They work through magnetic fields - areas of influence around the magnet where magnetic materials can be affected. This introduces students to the concept of forces that work at a distance.",
            images: ["🧲 Different magnet shapes", "⚡ Magnetic field lines"]
        }
    },
    {
        content: `
            <h3>Types of Magnets</h3>
            <p>There are different types of magnets, each with special properties and uses!</p>
            <div class="grid-2">
                <div class="info-card red-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">🧲</div>
                    <h4>Permanent Magnets</h4>
                    <p>Stay magnetic for a very long time</p>
                    <ul>
                        <li>Bar magnets</li>
                        <li>Horseshoe magnets</li>
                        <li>Ring magnets</li>
                        <li>Fridge magnets</li>
                    </ul>
                </div>
                <div class="info-card blue-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">⚡</div>
                    <h4>Temporary Magnets</h4>
                    <p>Only magnetic when near other magnets</p>
                    <ul>
                        <li>Iron nails</li>
                        <li>Paper clips</li>
                        <li>Steel screws</li>
                        <li>Iron filings</li>
                    </ul>
                </div>
            </div>
            <div class="grid-2" style="margin-top: 20px;">
                <div class="info-card green-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">🌍</div>
                    <h4>Natural Magnets</h4>
                    <p>Found in nature</p>
                    <ul>
                        <li>Magnetite (lodestone)</li>
                        <li>Earth itself</li>
                        <li>Some meteorites</li>
                    </ul>
                </div>
                <div class="info-card purple-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">🏭</div>
                    <h4>Artificial Magnets</h4>
                    <p>Made by people</p>
                    <ul>
                        <li>Neodymium magnets</li>
                        <li>Ceramic magnets</li>
                        <li>Electromagnets</li>
                    </ul>
                </div>
            </div>
        `,
        notes: {
            text: "Understanding different types of magnets helps students recognize that magnetism can be permanent or temporary, natural or artificial. This classification helps them understand the variety of magnetic materials in their environment.",
            images: ["🧲 Magnet shapes", "🌍 Natural magnetite"]
        }
    },
    {
        content: `
            <h3>Magnetic Properties</h3>
            <p>All magnets share certain special properties that make them unique and useful!</p>
            <div class="process-flow">
                <h4>Universal Magnetic Properties:</h4>
                <div class="process-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <strong>Attraction & Repulsion</strong>
                        <p>Magnets can pull things toward them or push them away</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <strong>Invisible Force</strong>
                        <p>Magnetic force works through air, water, and thin materials</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <strong>Directional Force</strong>
                        <p>Magnetic force has direction - from North to South pole</p>
                    </div>
                </div>
            </div>
            <div class="grid-3">
                <div class="info-card yellow-card">
                    <h4>🎯 Selective</h4>
                    <p>Only attract certain materials like iron, nickel, and cobalt</p>
                </div>
                <div class="info-card orange-card">
                    <h4>💪 Strength Varies</h4>
                    <p>Some magnets are stronger than others</p>
                </div>
                <div class="info-card pink-card">
                    <h4>🌡️ Temperature Sensitive</h4>
                    <p>Very hot temperatures can destroy magnetism</p>
                </div>
            </div>
            <div class="fun-fact">
                <h4>🔬 Cool Discovery!</h4>
                <p>If you break a magnet in half, you don't get separate North and South poles - you get two complete magnets, each with both poles!</p>
            </div>
        `,
        notes: {
            text: "Magnetic properties are consistent across all magnets, regardless of size or strength. Understanding these universal properties helps students predict how any magnet will behave in different situations.",
            images: ["🎯 Selective attraction", "💪 Magnetic strength"]
        }
    },
    {
        content: `
            <h3>Poles of Magnets</h3>
            <p>Every magnet has two poles - North and South. These poles determine how magnets interact with each other!</p>
            <div class="magnet-diagram">
                <h4>Magnetic Pole Rules:</h4>
                <ul>
                    <li>🔴 <strong>North Pole (N):</strong> Usually colored red, points toward Earth's North</li>
                    <li>🔵 <strong>South Pole (S):</strong> Usually colored blue, points toward Earth's South</li>
                    <li>🤝 <strong>Opposite Poles Attract:</strong> N and S poles pull toward each other</li>
                    <li>↔️ <strong>Same Poles Repel:</strong> N and N, or S and S push away</li>
                </ul>
            </div>
            <div class="grid-2">
                <div class="info-card red-card">
                    <h4>🤝 Attraction</h4>
                    <div style="font-size: 2rem; margin: 10px 0;">🧲➡️⬅️🧲</div>
                    <p><strong>N ↔ S</strong></p>
                    <p>Opposite poles attract each other with a pulling force</p>
                </div>
                <div class="info-card blue-card">
                    <h4>↔️ Repulsion</h4>
                    <div style="font-size: 2rem; margin: 10px 0;">🧲⬅️➡️🧲</div>
                    <p><strong>N ↔ N or S ↔ S</strong></p>
                    <p>Same poles repel each other with a pushing force</p>
                </div>
            </div>
            <div class="process-flow">
                <h4>Remember the Pole Rule:</h4>
                <div class="process-step">
                    <div class="step-number">💕</div>
                    <div class="step-content">
                        <strong>"Opposites Attract"</strong>
                        <p>Just like in friendship, opposite poles are drawn to each other!</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">🚫</div>
                    <div class="step-content">
                        <strong>"Same Poles Repel"</strong>
                        <p>Same poles push each other away - they need their space!</p>
                    </div>
                </div>
            </div>
        `,
        notes: {
            text: "Understanding magnetic poles is crucial for predicting magnetic behavior. The attraction and repulsion rules are fundamental to all magnetic interactions and help explain how compasses work and why magnets behave as they do.",
            images: ["🔴🔵 Magnetic poles", "🤝↔️ Attraction and repulsion"]
        }
    },
    {
        content: `
            <h3>Magnetic Fields</h3>
            <p>Around every magnet is an invisible area called a magnetic field where the magnet's force can be felt!</p>
            <div class="magnetic-field">
                <h4 style="text-align: center; color: #dc2626; margin-bottom: 20px;">🌀 Visualizing Magnetic Fields</h4>
                <div class="field-visualization" id="field-visualization">
                    <div class="field-magnet north-side" style="left: 30%;">N</div>
                    <div class="field-magnet south-side" style="right: 30%;">S</div>
                    <!-- Field lines will be added by JavaScript -->
                </div>
                <div style="text-align: center; margin-top: 15px;">
                    <button class="experiment-btn" onclick="toggleFieldLines()">Show/Hide Field Lines</button>
                    <button class="experiment-btn" onclick="animateField()">Animate Field</button>
                </div>
            </div>
            <div class="grid-2">
                <div class="info-card green-card">
                    <h4>🌀 Field Properties</h4>
                    <ul>
                        <li><strong>Invisible:</strong> Can't see without special tools</li>
                        <li><strong>3D Shape:</strong> Surrounds the entire magnet</li>
                        <li><strong>Strongest at Poles:</strong> Most powerful at N and S</li>
                        <li><strong>Weakens with Distance:</strong> Gets weaker farther away</li>
                    </ul>
                </div>
                <div class="info-card blue-card">
                    <h4>🔍 How to See Fields</h4>
                    <ul>
                        <li><strong>Iron Filings:</strong> Tiny iron pieces show field lines</li>
                        <li><strong>Compass:</strong> Needle follows field direction</li>
                        <li><strong>Magnetic Viewing Film:</strong> Special plastic shows fields</li>
                        <li><strong>Computer Simulation:</strong> Digital visualization</li>
                    </ul>
                </div>
            </div>
            <div class="fun-fact">
                <h4>🌍 Earth's Giant Field!</h4>
                <p>Earth itself is like a giant magnet with a magnetic field that protects us from harmful space radiation and helps animals navigate!</p>
            </div>
        `,
        notes: {
            text: "Magnetic fields are one of the most important concepts in magnetism. They help explain action at a distance and provide a model for understanding how magnets affect their surroundings without direct contact.",
            images: ["🌀 Field line patterns", "🔍 Iron filing demonstrations"]
        }
    },
    {
        content: `
            <h3>Magnetic Materials</h3>
            <p>Not all materials are affected by magnets! Let's explore which materials are magnetic and which are not.</p>
            <div class="grid-3">
                <div class="info-card red-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">🧲</div>
                    <h4>Magnetic Materials</h4>
                    <p><strong>Attracted to magnets</strong></p>
                    <ul>
                        <li>Iron (Fe)</li>
                        <li>Nickel (Ni)</li>
                        <li>Cobalt (Co)</li>
                        <li>Steel (contains iron)</li>
                    </ul>
                </div>
                <div class="info-card gray-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">🚫</div>
                    <h4>Non-Magnetic Materials</h4>
                    <p><strong>Not attracted to magnets</strong></p>
                    <ul>
                        <li>Aluminum</li>
                        <li>Copper</li>
                        <li>Gold</li>
                        <li>Silver</li>
                        <li>Plastic</li>
                        <li>Wood</li>
                        <li>Glass</li>
                    </ul>
                </div>
                <div class="info-card yellow-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">⚡</div>
                    <h4>Special Materials</h4>
                    <p><strong>Weakly magnetic</strong></p>
                    <ul>
                        <li>Oxygen (gas)</li>
                        <li>Some ceramics</li>
                        <li>Rare earth metals</li>
                    </ul>
                </div>
            </div>
            <div class="process-flow">
                <h4>Testing Materials for Magnetism:</h4>
                <div class="process-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <strong>Bring magnet close</strong>
                        <p>Hold magnet near the material without touching</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <strong>Observe the reaction</strong>
                        <p>Does the material move toward the magnet?</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <strong>Record results</strong>
                        <p>Magnetic if attracted, non-magnetic if no movement</p>
                    </div>
                </div>
            </div>
            <div class="fun-fact">
                <h4>💰 Magnet Money Test!</h4>
                <p>You can test if coins are real by using a magnet! Real gold and silver coins won't be attracted, but fake ones made with iron will be!</p>
            </div>
        `,
        notes: {
            text: "Understanding which materials are magnetic helps students predict and explain magnetic behavior in everyday situations. The classification into magnetic and non-magnetic materials is fundamental to understanding how magnets work.",
            images: ["🧲 Magnetic materials", "🚫 Non-magnetic materials"]
        }
    },
    {
        content: `
            <h3>Attraction & Repulsion</h3>
            <p>Magnets can either pull objects toward them (attraction) or push them away (repulsion). Let's explore both forces!</p>
            <div class="grid-2">
                <div class="info-card green-card">
                    <h4>🤝 Magnetic Attraction</h4>
                    <div style="font-size: 3rem; margin: 15px 0;">🧲 ← 📎</div>
                    <ul>
                        <li><strong>Opposite poles attract</strong> (N ↔ S)</li>
                        <li><strong>Magnets attract magnetic materials</strong></li>
                        <li><strong>Force gets stronger</strong> as objects get closer</li>
                        <li><strong>Can work through</strong> thin materials</li>
                    </ul>
                </div>
                <div class="info-card red-card">
                    <h4>↔️ Magnetic Repulsion</h4>
                    <div style="font-size: 3rem; margin: 15px 0;">🧲 ← → 🧲</div>
                    <ul>
                        <li><strong>Same poles repel</strong> (N ↔ N, S ↔ S)</li>
                        <li><strong>Pushing force</strong> without touching</li>
                        <li><strong>Force gets stronger</strong> as magnets get closer</li>
                        <li><strong>Can make objects levitate</strong></li>
                    </ul>
                </div>
            </div>
            <div class="magnet-diagram">
                <h4>Force Strength Rules:</h4>
                <ul>
                    <li>💪 <strong>Distance Matters:</strong> Closer = stronger force</li>
                    <li>📏 <strong>Size Matters:</strong> Bigger magnets = stronger force</li>
                    <li>🎯 <strong>Material Matters:</strong> Iron attracted more than nickel</li>
                    <li>🌡️ <strong>Temperature Matters:</strong> Cold magnets work better</li>
                </ul>
            </div>
            <div class="process-flow">
                <h4>Predicting Magnetic Behavior:</h4>
                <div class="process-step">
                    <div class="step-number">🔍</div>
                    <div class="step-content">
                        <strong>Identify the poles</strong>
                        <p>Find which end is North and which is South</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">🤔</div>
                    <div class="step-content">
                        <strong>Apply the rule</strong>
                        <p>Opposite poles attract, same poles repel</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">📊</div>
                    <div class="step-content">
                        <strong>Predict the result</strong>
                        <p>Will they move together or apart?</p>
                    </div>
                </div>
            </div>
        `,
        notes: {
            text: "Attraction and repulsion are the two fundamental magnetic forces. Understanding these forces helps students predict magnetic behavior and explains many everyday phenomena involving magnets.",
            images: ["🤝 Attraction examples", "↔️ Repulsion examples"]
        }
    },
    {
        content: `
            <h3>Interactive Magnet Experiment</h3>
            <p>Try this hands-on experiment! Drag the magnets and objects around to see how they interact with each other.</p>
            <div class="magnet-experiment">
                <h4 style="text-align: center; color: #0c4a6e; margin-bottom: 20px;">🧪 Virtual Magnet Lab</h4>
                <div class="experiment-area" id="experiment-area">
                    <!-- Magnets -->
                    <div class="magnet-object magnet-north" id="magnet1" style="top: 50px; left: 100px;" draggable="true">N</div>
                    <div class="magnet-object magnet-south" id="magnet2" style="top: 50px; right: 100px;" draggable="true">S</div>
                    
                    <!-- Test objects -->
                    <div class="magnet-object test-object magnetic" id="iron-nail" style="top: 150px; left: 150px;" draggable="true">Iron</div>
                    <div class="magnet-object test-object" id="plastic-toy" style="top: 150px; right: 150px;" draggable="true">Plastic</div>
                    <div class="magnet-object test-object magnetic" id="steel-clip" style="top: 200px; left: 200px;" draggable="true">Steel</div>
                    <div class="magnet-object test-object" id="wood-block" style="top: 200px; right: 200px;" draggable="true">Wood</div>
                </div>
                <div class="experiment-controls">
                    <button class="experiment-btn" onclick="resetExperiment()">🔄 Reset Positions</button>
                    <button class="experiment-btn" onclick="showFieldLines()">🌀 Show Field Lines</button>
                    <button class="experiment-btn" onclick="testAttraction()">🧲 Test Attraction</button>
                </div>
                <div class="fun-fact" style="margin-top: 20px;">
                    <h4>🎯 Experiment Tips!</h4>
                    <p id="experiment-tip">Drag the red North pole near different objects. Notice which ones are attracted and which ones aren't affected!</p>
                </div>
            </div>
        `,
        notes: {
            text: "Interactive experiments help students understand magnetic principles through hands-on exploration. This virtual lab allows safe experimentation with magnetic forces and materials.",
            images: ["🧪 Lab setup", "🧲 Magnetic interactions"]
        }
    },
    {
        content: `
            <h3>How Magnets are Made</h3>
            <p>Magnets can be created in different ways, from natural formation to modern manufacturing processes!</p>
            <div class="process-flow">
                <h4>Natural Magnet Formation:</h4>
                <div class="process-step">
                    <div class="step-number">🌋</div>
                    <div class="step-content">
                        <strong>Volcanic Activity</strong>
                        <p>Iron-rich rocks cool in Earth's magnetic field, becoming naturally magnetized</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">⚡</div>
                    <div class="step-content">
                        <strong>Lightning Strikes</strong>
                        <p>Powerful electrical currents can magnetize iron objects they strike</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">🌍</div>
                    <div class="step-content">
                        <strong>Earth's Field</strong>
                        <p>Long exposure to Earth's magnetic field slowly magnetizes some materials</p>
                    </div>
                </div>
            </div>
            <div class="grid-2">
                <div class="info-card blue-card">
                    <h4>🏭 Artificial Magnet Making</h4>
                    <ul>
                        <li><strong>Stroking Method:</strong> Rub iron with existing magnet</li>
                        <li><strong>Electric Current:</strong> Pass electricity through coiled wire</li>
                        <li><strong>Induction:</strong> Place iron in strong magnetic field</li>
                        <li><strong>Heat Treatment:</strong> Heat and cool in magnetic field</li>
                    </ul>
                </div>
                <div class="info-card green-card">
                    <h4>🔬 Modern Manufacturing</h4>
                    <ul>
                        <li><strong>Powder Metallurgy:</strong> Press magnetic powder into shapes</li>
                        <li><strong>Sintering:</strong> Heat-treat to bond particles</li>
                        <li><strong>Magnetization:</strong> Apply strong magnetic field</li>
                        <li><strong>Quality Control:</strong> Test strength and durability</li>
                    </ul>
                </div>
            </div>
            <div class="magnet-diagram">
                <h4>Magnet Strength Factors:</h4>
                <ul>
                    <li>🧪 <strong>Material Type:</strong> Neodymium strongest, ceramic weakest</li>
                    <li>📏 <strong>Size & Shape:</strong> Larger magnets generally stronger</li>
                    <li>🌡️ <strong>Temperature:</strong> Made at optimal temperature for strength</li>
                    <li>⚡ <strong>Magnetizing Field:</strong> Stronger field creates stronger magnet</li>
                </ul>
            </div>
            <div class="fun-fact">
                <h4>🏺 Ancient Discovery!</h4>
                <p>The first magnets were discovered over 2,000 years ago in ancient Greece! They found naturally magnetic rocks that could attract iron.</p>
            </div>
        `,
        notes: {
            text: "Understanding how magnets are made helps students appreciate both natural phenomena and human ingenuity. The contrast between natural and artificial magnet creation shows the evolution of magnetic technology.",
            images: ["🌋 Natural magnetite", "🏭 Manufacturing process"]
        }
    },
    {
        content: `
            <h3>Making Temporary Magnets</h3>
            <p>You can turn ordinary iron objects into temporary magnets using simple methods! Let's learn how.</p>
            <div class="process-flow">
                <h4>Stroking Method - Make a Magnet:</h4>
                <div class="process-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <strong>Get Materials</strong>
                        <p>Iron nail, steel needle, or paper clip + strong permanent magnet</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <strong>Stroke in One Direction</strong>
                        <p>Rub the magnet along the iron object 20-30 times, always in the same direction</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <strong>Test Your New Magnet</strong>
                        <p>Try picking up small iron objects like paper clips or iron filings</p>
                    </div>
                </div>
            </div>
            <div class="grid-2">
                <div class="info-card yellow-card">
                    <h4>✅ What Works Best</h4>
                    <ul>
                        <li><strong>Iron nails:</strong> Easy to magnetize</li>
                        <li><strong>Steel needles:</strong> Hold magnetism longer</li>
                        <li><strong>Paper clips:</strong> Quick temporary magnets</li>
                        <li><strong>Screwdrivers:</strong> Useful magnetized tools</li>
                    </ul>
                </div>
                <div class="info-card orange-card">
                    <h4>❌ What Doesn't Work</h4>
                    <ul>
                        <li><strong>Aluminum:</strong> Not magnetic material</li>
                        <li><strong>Copper:</strong> Won't become magnetized</li>
                        <li><strong>Plastic:</strong> No magnetic properties</li>
                        <li><strong>Wood:</strong> Cannot hold magnetism</li>
                    </ul>
                </div>
            </div>
            <div class="magnet-diagram">
                <h4>Why Stroking Works:</h4>
                <ul>
                    <li>🔄 <strong>Aligns Domains:</strong> Tiny magnetic regions line up in same direction</li>
                    <li>⚡ <strong>Transfers Magnetism:</strong> Permanent magnet influences iron atoms</li>
                    <li>📏 <strong>Creates Poles:</strong> One end becomes North, other becomes South</li>
                    <li>⏰ <strong>Temporary Effect:</strong> Magnetism fades over time without reinforcement</li>
                </ul>
            </div>
            <div class="fun-fact">
                <h4>🔧 Handy Trick!</h4>
                <p>Mechanics often magnetize their screwdrivers to hold screws while working. This makes repairs much easier in tight spaces!</p>
            </div>
        `,
        notes: {
            text: "Creating temporary magnets demonstrates the fundamental principle of magnetic induction. This hands-on activity helps students understand how magnetism can be transferred and how magnetic domains align.",
            images: ["🔧 Stroking method", "📎 Temporary magnets"]
        }
    },
    {
        content: `
            <h3>Permanent vs Temporary Magnets</h3>
            <p>Understanding the difference between permanent and temporary magnets helps us choose the right type for different jobs!</p>
            <div class="grid-2">
                <div class="info-card red-card">
                    <h4>🧲 Permanent Magnets</h4>
                    <div style="font-size: 2rem; margin: 10px 0;">🔒</div>
                    <ul>
                        <li><strong>Stay magnetic</strong> for years or decades</li>
                        <li><strong>Made from hard materials</strong> like steel, neodymium</li>
                        <li><strong>Difficult to demagnetize</strong></li>
                        <li><strong>Keep their strength</strong> over time</li>
                        <li><strong>More expensive</strong> to make</li>
                    </ul>
                </div>
                <div class="info-card blue-card">
                    <h4>⚡ Temporary Magnets</h4>
                    <div style="font-size: 2rem; margin: 10px 0;">⏰</div>
                    <ul>
                        <li><strong>Lose magnetism</strong> quickly</li>
                        <li><strong>Made from soft materials</strong> like soft iron</li>
                        <li><strong>Easy to magnetize and demagnetize</strong></li>
                        <li><strong>Strength fades</strong> without magnetic field</li>
                        <li><strong>Less expensive</strong> to make</li>
                    </ul>
                </div>
            </div>
            <div class="process-flow">
                <h4>How to Destroy Magnetism:</h4>
                <div class="process-step">
                    <div class="step-number">🔥</div>
                    <div class="step-content">
                        <strong>Heat</strong>
                        <p>High temperatures scramble magnetic domains, destroying magnetism</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">🔨</div>
                    <div class="step-content">
                        <strong>Impact</strong>
                        <p>Hard hits can knock magnetic domains out of alignment</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">🌀</div>
                    <div class="step-content">
                        <strong>Opposing Field</strong>
                        <p>Strong magnetic field in opposite direction cancels magnetism</p>
                    </div>
                </div>
            </div>
            <div class="grid-3">
                <div class="info-card green-card">
                    <h4>🏠 Home Uses</h4>
                    <p><strong>Permanent:</strong> Fridge magnets, speakers, motors</p>
                    <p><strong>Temporary:</strong> Electromagnets in doorbells</p>
                </div>
                <div class="info-card purple-card">
                    <h4>🏭 Industrial Uses</h4>
                    <p><strong>Permanent:</strong> Generators, hard drives</p>
                    <p><strong>Temporary:</strong> Cranes, MRI machines</p>
                </div>
                <div class="info-card yellow-card">
                    <h4>🔬 Scientific Uses</h4>
                    <p><strong>Permanent:</strong> Lab equipment, sensors</p>
                    <p><strong>Temporary:</strong> Research electromagnets</p>
                </div>
            </div>
        `,
        notes: {
            text: "The distinction between permanent and temporary magnets is crucial for understanding magnetic applications. Each type has advantages that make it suitable for specific purposes.",
            images: ["🔒 Permanent magnet examples", "⏰ Temporary magnet uses"]
        }
    },
    {
        content: `
            <h3>Compass & Navigation</h3>
            <p>A compass is a special magnet that always points North, helping people navigate and find their way!</p>
            <div class="compass-container">
                <h4 style="text-align: center; color: #166534; margin-bottom: 20px;">🧭 Interactive Compass</h4>
                <div class="compass" id="compass">
                    <div class="compass-needle" id="compass-needle"></div>
                    <div class="compass-center"></div>
                    <div class="compass-directions">
                        <div class="compass-n">N</div>
                        <div class="compass-s">S</div>
                        <div class="compass-e">E</div>
                        <div class="compass-w">W</div>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="experiment-btn" onclick="spinCompass()">🌀 Spin Compass</button>
                    <button class="experiment-btn" onclick="addMagnet()">🧲 Add Magnet Interference</button>
                    <button class="experiment-btn" onclick="resetCompass()">🔄 Reset</button>
                </div>
                <div id="compass-status" style="text-align: center; margin-top: 15px; font-weight: bold; color: #166534;">
                    Compass pointing to Magnetic North
                </div>
            </div>
            <div class="grid-2">
                <div class="info-card blue-card">
                    <h4>🧭 How Compasses Work</h4>
                    <ul>
                        <li><strong>Magnetized Needle:</strong> Free to rotate and align with Earth's field</li>
                        <li><strong>North Seeking:</strong> Red end points to magnetic North</li>
                        <li><strong>Earth's Magnet:</strong> Our planet acts like a giant magnet</li>
                        <li><strong>Magnetic Declination:</strong> Difference between magnetic and true North</li>
                    </ul>
                </div>
                <div class="info-card green-card">
                    <h4>🗺️ Navigation Uses</h4>
                    <ul>
                        <li><strong>Hiking & Camping:</strong> Find direction in wilderness</li>
                        <li><strong>Marine Navigation:</strong> Ships use compasses at sea</li>
                        <li><strong>Aviation:</strong> Pilots use magnetic compasses</li>
                        <li><strong>Surveying:</strong> Map making and land measurement</li>
                    </ul>
                </div>
            </div>
            <div class="magnet-diagram">
                <h4>Earth's Magnetic Field:</h4>
                <ul>
                    <li>🌍 <strong>Giant Magnet:</strong> Earth has North and South magnetic poles</li>
                    <li>🧭 <strong>Magnetic North:</strong> Different from geographic North Pole</li>
                    <li>🔄 <strong>Field Lines:</strong> Invisible lines from South to North pole</li>
                    <li>🛡️ <strong>Protection:</strong> Shields us from harmful solar radiation</li>
                </ul>
            </div>
            <div class="fun-fact">
                <h4>🐦 Animal Navigation!</h4>
                <p>Many animals like birds, sea turtles, and whales have built-in magnetic sensors that help them navigate during long migrations!</p>
            </div>
        `,
        notes: {
            text: "Compasses demonstrate the practical application of magnetism and Earth's magnetic field. Understanding how compasses work connects magnetism to navigation and geography.",
            images: ["🧭 Compass parts", "🌍 Earth's magnetic field"]
        }
    },
    {
        content: `
            <h3>Magnets at Home</h3>
            <p>Look around your house - magnets are everywhere! Let's discover the many ways magnets make our daily lives easier.</p>
            <div class="grid-4">
                <div class="info-card red-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">🧊</div>
                    <h4>Refrigerator</h4>
                    <p>Door seals and decorative magnets</p>
                </div>
                <div class="info-card blue-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">🔊</div>
                    <h4>Speakers</h4>
                    <p>Convert electricity to sound waves</p>
                </div>
                <div class="info-card green-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">📺</div>
                    <h4>TV & Monitors</h4>
                    <p>Control electron beams (older TVs)</p>
                </div>
                <div class="info-card yellow-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">🚪</div>
                    <h4>Cabinet Doors</h4>
                    <p>Magnetic latches keep doors closed</p>
                </div>
            </div>
            <div class="grid-3" style="margin-top: 20px;">
                <div class="info-card purple-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">🎧</div>
                    <h4>Headphones</h4>
                    <p>Tiny magnets create sound in your ears</p>
                </div>
                <div class="info-card orange-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">🔌</div>
                    <h4>Electric Motors</h4>
                    <p>Fans, blenders, washing machines</p>
                </div>
                <div class="info-card pink-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">💳</div>
                    <h4>Credit Cards</h4>
                    <p>Magnetic strips store information</p>
                </div>
            </div>
            <div class="process-flow">
                <h4>Magnet Hunt at Home:</h4>
                <div class="process-step">
                    <div class="step-number">🔍</div>
                    <div class="step-content">
                        <strong>Kitchen Search</strong>
                        <p>Fridge magnets, can openers, microwave door seals</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">🛏️</div>
                    <div class="step-content">
                        <strong>Bedroom Hunt</strong>
                        <p>Speakers, alarm clocks, jewelry clasps</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">🚗</div>
                    <div class="step-content">
                        <strong>Garage Discovery</strong>
                        <p>Car speakers, garage door openers, tools</p>
                    </div>
                </div>
            </div>
            <div class="fun-fact">
                <h4>🏠 Hidden Magnets!</h4>
                <p>The average home contains over 100 magnets! Most are hidden inside appliances and electronics, working quietly to make our lives better.</p>
            </div>
        `,
        notes: {
            text: "Identifying magnets in everyday objects helps students recognize the practical importance of magnetism. This connects abstract magnetic concepts to familiar, concrete applications.",
            images: ["🏠 Household magnets", "🔍 Hidden magnetic devices"]
        }
    },
    {
        content: `
            <h3>Magnets in Technology</h3>
            <p>Modern technology depends heavily on magnets! From computers to transportation, magnets power our digital world.</p>
            <div class="grid-2">
                <div class="info-card blue-card">
                    <h4>💻 Computer Technology</h4>
                    <ul>
                        <li><strong>Hard Drives:</strong> Store data using magnetic fields</li>
                        <li><strong>Speakers:</strong> Convert digital signals to sound</li>
                        <li><strong>Cooling Fans:</strong> Keep computers from overheating</li>
                        <li><strong>Magnetic Sensors:</strong> Detect position and movement</li>
                    </ul>
                </div>
                <div class="info-card green-card">
                    <h4>🚗 Transportation</h4>
                    <ul>
                        <li><strong>Electric Motors:</strong> Power electric cars</li>
                        <li><strong>Maglev Trains:</strong> Float above tracks using magnetism</li>
                        <li><strong>ABS Brakes:</strong> Magnetic sensors prevent skidding</li>
                        <li><strong>Navigation:</strong> GPS and compass systems</li>
                    </ul>
                </div>
            </div>
            <div class="grid-3">
                <div class="info-card red-card">
                    <h4>📱 Mobile Devices</h4>
                    <ul>
                        <li>Speakers & microphones</li>
                        <li>Vibration motors</li>
                        <li>Wireless charging</li>
                        <li>Compass apps</li>
                    </ul>
                </div>
                <div class="info-card purple-card">
                    <h4>🏭 Industrial Uses</h4>
                    <ul>
                        <li>Magnetic separators</li>
                        <li>Lifting electromagnets</li>
                        <li>Quality control sensors</li>
                        <li>Magnetic bearings</li>
                    </ul>
                </div>
                <div class="info-card yellow-card">
                    <h4>🔬 Scientific Equipment</h4>
                    <ul>
                        <li>Particle accelerators</li>
                        <li>Electron microscopes</li>
                        <li>Mass spectrometers</li>
                        <li>Research magnets</li>
                    </ul>
                </div>
            </div>
            <div class="magnet-diagram">
                <h4>Future Magnetic Technologies:</h4>
                <ul>
                    <li>🚄 <strong>Maglev Transportation:</strong> Super-fast trains floating on magnetic fields</li>
                    <li>⚡ <strong>Magnetic Energy Storage:</strong> Store electricity in magnetic fields</li>
                    <li>🏠 <strong>Magnetic Refrigeration:</strong> Eco-friendly cooling without chemicals</li>
                    <li>🌌 <strong>Space Applications:</strong> Magnetic shields for spacecraft</li>
                </ul>
            </div>
            <div class="fun-fact">
                <h4>🚄 Floating Trains!</h4>
                <p>Maglev trains in Japan can travel over 300 mph by floating on magnetic fields - no wheels touching the track means no friction to slow them down!</p>
            </div>
        `,
        notes: {
            text: "Exploring magnets in technology shows students how fundamental magnetic principles enable modern innovations. This helps them understand the connection between basic science and advanced applications.",
            images: ["💻 Computer magnets", "🚄 Maglev technology"]
        }
    },
    {
        content: `
            <h3>Magnets in Medicine</h3>
            <p>Magnets play a crucial role in modern medicine, helping doctors see inside our bodies and treat diseases!</p>
            <div class="grid-2">
                <div class="info-card blue-card">
                    <h4>🏥 MRI Machines</h4>
                    <div style="font-size: 2rem; margin: 10px 0;">🧠</div>
                    <ul>
                        <li><strong>Magnetic Resonance Imaging</strong></li>
                        <li><strong>See inside body</strong> without surgery</li>
                        <li><strong>No harmful radiation</strong> like X-rays</li>
                        <li><strong>Detailed pictures</strong> of organs and tissues</li>
                        <li><strong>Powerful magnets</strong> 10,000 times stronger than Earth's field</li>
                    </ul>
                </div>
                <div class="info-card green-card">
                    <h4>🩺 Medical Treatments</h4>
                    <div style="font-size: 2rem; margin: 10px 0;">💊</div>
                    <ul>
                        <li><strong>Magnetic Drug Delivery:</strong> Guide medicine to specific body parts</li>
                        <li><strong>Magnetic Therapy:</strong> Some believe magnets reduce pain</li>
                        <li><strong>Pacemakers:</strong> Use magnetic switches (but avoid strong magnets!)</li>
                        <li><strong>Prosthetics:</strong> Magnetic attachments for artificial limbs</li>
                    </ul>
                </div>
            </div>
            <div class="process-flow">
                <h4>How MRI Works:</h4>
                <div class="process-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <strong>Strong Magnetic Field</strong>
                        <p>Aligns hydrogen atoms in your body like tiny compasses</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <strong>Radio Waves</strong>
                        <p>Pulse radio signals to disturb the aligned atoms</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <strong>Signal Detection</strong>
                        <p>Computer reads signals as atoms return to alignment</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <strong>Image Creation</strong>
                        <p>Computer creates detailed pictures from the signals</p>
                    </div>
                </div>
            </div>
            <div class="magnet-diagram">
                <h4>MRI Safety Rules:</h4>
                <ul>
                    <li>🚫 <strong>No Metal Objects:</strong> Keys, jewelry, phones must stay outside</li>
                    <li>💳 <strong>No Credit Cards:</strong> Magnetic field erases magnetic strips</li>
                    <li>🦷 <strong>Dental Work:</strong> Some fillings and braces may be affected</li>
                    <li>⚡ <strong>Pacemakers:</strong> Can be dangerous - always tell doctors!</li>
                </ul>
            </div>
            <div class="fun-fact">
                <h4>🧲 Super Strong!</h4>
                <p>MRI magnets are so powerful they can pull a wheelchair across the room! That's why hospitals have strict safety rules about metal objects.</p>
            </div>
        `,
        notes: {
            text: "Medical applications of magnetism demonstrate how scientific principles directly benefit human health. MRI technology shows how understanding magnetic fields leads to life-saving medical tools.",
            images: ["🏥 MRI machine", "🧠 Medical imaging"]
        }
    },
    {
        content: `
            <h3>Earth as a Magnet</h3>
            <p>Our entire planet is like a giant magnet with its own magnetic field that protects us and helps animals navigate!</p>
            <div class="magnetic-field">
                <h4 style="text-align: center; color: #dc2626; margin-bottom: 20px;">🌍 Earth's Magnetic Field</h4>
                <div class="field-visualization" style="background: linear-gradient(to bottom, #87CEEB 0%, #87CEEB 30%, #90EE90 30%, #90EE90 70%, #8B4513 70%, #8B4513 100%); min-height: 200px; position: relative;">
                    <div style="position: absolute; top: 20px; left: 50%; transform: translateX(-50%); font-size: 2rem;">🌞</div>
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 3rem;">🌍</div>
                    <div style="position: absolute; bottom: 20px; left: 20px; font-size: 1rem; color: #333;">Magnetic South Pole</div>
                    <div style="position: absolute; top: 20px; right: 20px; font-size: 1rem; color: #333;">Magnetic North Pole</div>
                </div>
                <div style="text-align: center; margin-top: 15px;">
                    <button class="experiment-btn" onclick="showEarthField()">🌀 Show Field Lines</button>
                    <button class="experiment-btn" onclick="showSolarWind()">☀️ Show Solar Wind Protection</button>
                </div>
            </div>
            <div class="grid-2">
                <div class="info-card blue-card">
                    <h4>🌍 Earth's Magnetic Properties</h4>
                    <ul>
                        <li><strong>Magnetic Poles:</strong> North and South magnetic poles</li>
                        <li><strong>Not Geographic Poles:</strong> Magnetic poles move and shift</li>
                        <li><strong>Magnetic Declination:</strong> Difference between magnetic and true North</li>
                        <li><strong>Field Strength:</strong> Varies from 25-65 microteslas</li>
                    </ul>
                </div>
                <div class="info-card green-card">
                    <h4>🛡️ Protection & Benefits</h4>
                    <ul>
                        <li><strong>Solar Wind Shield:</strong> Deflects harmful space radiation</li>
                        <li><strong>Aurora Creation:</strong> Beautiful northern and southern lights</li>
                        <li><strong>Navigation Aid:</strong> Compasses work because of Earth's field</li>
                        <li><strong>Animal Migration:</strong> Many animals use it to navigate</li>
                    </ul>
                </div>
            </div>
            <div class="process-flow">
                <h4>How Earth's Magnetism Works:</h4>
                <div class="process-step">
                    <div class="step-number">🌋</div>
                    <div class="step-content">
                        <strong>Molten Iron Core</strong>
                        <p>Earth's liquid iron outer core moves and creates electric currents</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">🔄</div>
                    <div class="step-content">
                        <strong>Dynamo Effect</strong>
                        <p>Moving liquid metal generates magnetic fields like a giant dynamo</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">🌍</div>
                    <div class="step-content">
                        <strong>Global Field</strong>
                        <p>Magnetic field extends far into space, creating magnetosphere</p>
                    </div>
                </div>
            </div>
            <div class="grid-3">
                <div class="info-card red-card">
                    <h4>🐦 Animal Navigation</h4>
                    <p>Birds, sea turtles, whales, and many other animals have magnetic sensors</p>
                </div>
                <div class="info-card purple-card">
                    <h4>🌌 Aurora Lights</h4>
                    <p>Solar particles interact with magnetic field to create beautiful light shows</p>
                </div>
                <div class="info-card yellow-card">
                    <h4>📡 Technology Impact</h4>
                    <p>Satellites and GPS systems must account for Earth's magnetic field</p>
                </div>
            </div>
            <div class="fun-fact">
                <h4>🔄 Magnetic Flip!</h4>
                <p>Earth's magnetic poles have flipped many times in history! The last flip was about 780,000 years ago, and scientists think another flip might happen in the future.</p>
            </div>
        `,
        notes: {
            text: "Understanding Earth as a magnet connects local magnetic phenomena to global and cosmic scales. This helps students appreciate the role of magnetism in protecting life on Earth and enabling navigation.",
            images: ["🌍 Earth's magnetic field", "🌌 Magnetosphere protection"]
        }
    },
    {
        content: `
            <h3>Review & Summary</h3>
            <p>Let's review everything we've learned about magnets and their amazing properties!</p>
            <div class="grid-2">
                <div class="info-card red-card">
                    <h4>🧲 Magnet Basics</h4>
                    <ul>
                        <li><strong>Definition:</strong> Objects that attract magnetic materials</li>
                        <li><strong>Poles:</strong> Every magnet has North and South poles</li>
                        <li><strong>Rule:</strong> Opposite poles attract, same poles repel</li>
                        <li><strong>Field:</strong> Invisible area of magnetic influence</li>
                    </ul>
                </div>
                <div class="info-card blue-card">
                    <h4>🔬 Types & Properties</h4>
                    <ul>
                        <li><strong>Permanent:</strong> Stay magnetic for long time</li>
                        <li><strong>Temporary:</strong> Lose magnetism quickly</li>
                        <li><strong>Natural:</strong> Found in nature (magnetite)</li>
                        <li><strong>Artificial:</strong> Made by people</li>
                    </ul>
                </div>
            </div>
            <div class="grid-3">
                <div class="info-card green-card">
                    <h4>🏠 Home Uses</h4>
                    <ul>
                        <li>Refrigerator magnets</li>
                        <li>Speakers & headphones</li>
                        <li>Cabinet latches</li>
                        <li>Electric motors</li>
                    </ul>
                </div>
                <div class="info-card purple-card">
                    <h4>💻 Technology</h4>
                    <ul>
                        <li>Computer hard drives</li>
                        <li>MRI medical machines</li>
                        <li>Maglev trains</li>
                        <li>Electric cars</li>
                    </ul>
                </div>
                <div class="info-card yellow-card">
                    <h4>🌍 Earth & Nature</h4>
                    <ul>
                        <li>Earth's magnetic field</li>
                        <li>Compass navigation</li>
                        <li>Animal migration</li>
                        <li>Aurora lights</li>
                    </ul>
                </div>
            </div>
            <div class="magnet-diagram">
                <h4>Key Magnetic Principles:</h4>
                <ul>
                    <li>🧲 <strong>Attraction & Repulsion:</strong> Fundamental forces between magnets</li>
                    <li>🌀 <strong>Magnetic Fields:</strong> Invisible areas where magnetic forces work</li>
                    <li>🎯 <strong>Selective Materials:</strong> Only iron, nickel, cobalt are strongly magnetic</li>
                    <li>🔄 <strong>Induction:</strong> Magnets can create temporary magnets in iron objects</li>
                    <li>🌍 <strong>Earth's Magnetism:</strong> Our planet is a giant magnet protecting us</li>
                </ul>
            </div>
            <div class="process-flow">
                <h4>Making & Using Magnets:</h4>
                <div class="process-step">
                    <div class="step-number">🔧</div>
                    <div class="step-content">
                        <strong>Create Temporary Magnets</strong>
                        <p>Stroke iron objects with permanent magnets</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">🧭</div>
                    <div class="step-content">
                        <strong>Navigation</strong>
                        <p>Use compasses to find direction using Earth's field</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">🔍</div>
                    <div class="step-content">
                        <strong>Test Materials</strong>
                        <p>Identify magnetic vs non-magnetic materials</p>
                    </div>
                </div>
            </div>
        `,
        notes: {
            text: "This comprehensive review helps students consolidate their understanding of magnetic principles and applications. It connects all the topics covered and reinforces key concepts.",
            images: ["📚 Concept summary", "🔄 Review materials"]
        }
    },
    {
        content: `
            <h3>Quiz 1</h3>
            <div style="margin: 20px 0;">
                <div style="font-size: 1.2rem; margin-bottom: 20px; font-weight: 600;">What happens when you bring the North pole of one magnet near the North pole of another magnet?</div>
                <div style="display: flex; flex-direction: column; gap: 10px; max-width: 600px; margin: 0 auto;">
                    <button class="quiz-option" onclick="selectQuizAnswer(this, false, 17)">They attract each other</button>
                    <button class="quiz-option" onclick="selectQuizAnswer(this, true, 17)">They repel each other</button>
                    <button class="quiz-option" onclick="selectQuizAnswer(this, false, 17)">Nothing happens</button>
                    <button class="quiz-option" onclick="selectQuizAnswer(this, false, 17)">They stick together permanently</button>
                </div>
            </div>
            <div class="quiz-explanation" id="explanation17">
                <strong>Correct!</strong> When two North poles (or two South poles) are brought together, they repel each other. This is because same poles push away from each other. Remember: "Opposite poles attract, same poles repel!"
            </div>
        `,
        notes: {
            text: "This quiz tests understanding of the fundamental rule of magnetic poles. Repulsion between like poles is a key concept that students often find counterintuitive at first.",
            images: ["🧲 Pole interactions", "↔️ Repulsion demonstration"]
        }
    },
    {
        content: `
            <h3>Quiz 2</h3>
            <div style="margin: 20px 0;">
                <div style="font-size: 1.2rem; margin-bottom: 20px; font-weight: 600;">Which of these materials would be attracted to a magnet?</div>
                <div style="display: flex; flex-direction: column; gap: 10px; max-width: 600px; margin: 0 auto;">
                    <button class="quiz-option" onclick="selectQuizAnswer(this, false, 18)">Plastic spoon</button>
                    <button class="quiz-option" onclick="selectQuizAnswer(this, false, 18)">Wooden pencil</button>
                    <button class="quiz-option" onclick="selectQuizAnswer(this, true, 18)">Iron nail</button>
                    <button class="quiz-option" onclick="selectQuizAnswer(this, false, 18)">Aluminum can</button>
                </div>
            </div>
            <div class="quiz-explanation" id="explanation18">
                <strong>Excellent!</strong> An iron nail would be attracted to a magnet because iron is one of the three main magnetic materials (iron, nickel, and cobalt). Plastic, wood, and aluminum are not magnetic materials, so they won't be attracted to magnets.
            </div>
        `,
        notes: {
            text: "This quiz tests knowledge of magnetic materials. Understanding which materials are magnetic is essential for predicting magnetic behavior in everyday situations.",
            images: ["🧲 Magnetic materials", "🚫 Non-magnetic materials"]
        }
    },
    {
        content: `
            <h3>Final Challenge</h3>
            <p>Congratulations! You've learned so much about magnets. Test your mastery with this final challenge!</p>
            
            <div class="magnet-experiment">
                <div class="game-header" style="text-align: center; margin-bottom: 20px;">
                    <h4>🏆 Magnet Master Challenge</h4>
                    <div style="background: linear-gradient(135deg, #dc2626, #b91c1c); color: white; padding: 10px 20px; border-radius: 20px; font-weight: bold; display: inline-block; margin-bottom: 20px;" id="final-score">Score: 0/3</div>
                </div>
                
                <div style="background: #f8fafc; padding: 20px; border-radius: 10px; margin-bottom: 20px;" id="final-question">
                    <div style="font-size: 3rem; margin-bottom: 15px; text-align: center;" id="final-image">🧲🧭</div>
                    <h5 style="font-size: 1.2rem; margin-bottom: 20px; text-align: center;" id="final-question-text">Why does a compass needle always point North?</h5>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;" id="final-options">
                        <button class="quiz-option" onclick="selectFinalAnswer(this, false, 0)">The needle is made of gold</button>
                        <button class="quiz-option" onclick="selectFinalAnswer(this, true, 0)">Earth has a magnetic field</button>
                        <button class="quiz-option" onclick="selectFinalAnswer(this, false, 0)">The Sun pulls the needle</button>
                        <button class="quiz-option" onclick="selectFinalAnswer(this, false, 0)">Gravity makes it point North</button>
                    </div>
                    
                    <div class="quiz-explanation" id="final-feedback" style="margin-top: 20px;">
                        <strong>Perfect!</strong> A compass needle points North because Earth itself is like a giant magnet with a magnetic field. The magnetized needle aligns with Earth's magnetic field lines, which point toward the magnetic North pole. This is why compasses have been used for navigation for over 1,000 years!
                    </div>
                </div>
                
                <div style="text-align: center;">
                    <button class="experiment-btn" onclick="nextFinalQuestion()" id="next-final-btn" disabled>Next Question ➡️</button>
                    <button class="experiment-btn" onclick="completeMagnetCourse()" id="complete-course-btn" style="display: none;">🎓 Complete Course</button>
                </div>
                
                <div style="background: white; padding: 20px; border-radius: 10px; margin-top: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h4 style="text-align: center; color: #dc2626;">🎯 Challenge Progress</h4>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <span>Question <span id="final-current-question">1</span> of <span id="final-total-questions">3</span></span>
                        <span>Mastery Level: <span id="final-accuracy">0%</span></span>
                    </div>
                    <div style="background: #e5e7eb; height: 6px; border-radius: 3px; overflow: hidden;">
                        <div style="background: linear-gradient(135deg, #dc2626, #b91c1c); height: 100%; width: 0%; transition: width 1s ease; border-radius: 3px;" id="final-progress-bar"></div>
                    </div>
                </div>
                
                <div class="fun-fact" style="margin-top: 20px;">
                    <h4>🌟 Amazing Journey!</h4>
                    <p>You've explored magnetic poles, fields, materials, and applications. From simple fridge magnets to Earth's protective magnetic field - you now understand the invisible forces that shape our world!</p>
                </div>
            </div>
        `,
        notes: {
            text: "This final challenge brings together all the key concepts learned throughout the lesson, testing students' comprehensive understanding of magnetism and its applications.",
            images: ["🏆 Achievement unlocked", "🎓 Course completion"]
        }
    }
];

// Subtopic sections for sidebar navigation
const subtopicSections = [
    {
        title: "Introduction to Magnets",
        subtopics: [
            { title: "What are Magnets?", slideIndex: 0 },
            { title: "Types of Magnets", slideIndex: 1 },
            { title: "Magnetic Properties", slideIndex: 2 },
            { title: "Poles of Magnets", slideIndex: 3 }
        ]
    },
    {
        title: "How Magnets Work",
        subtopics: [
            { title: "Magnetic Fields", slideIndex: 4 },
            { title: "Magnetic Materials", slideIndex: 5 },
            { title: "Attraction & Repulsion", slideIndex: 6 },
            { title: "Interactive Experiment", slideIndex: 7 }
        ]
    },
    {
        title: "Creating Magnets",
        subtopics: [
            { title: "How Magnets are Made", slideIndex: 8 },
            { title: "Making Temporary Magnets", slideIndex: 9 },
            { title: "Permanent vs Temporary", slideIndex: 10 },
            { title: "Compass & Navigation", slideIndex: 11 }
        ]
    },
    {
        title: "Uses of Magnets",
        subtopics: [
            { title: "Magnets at Home", slideIndex: 12 },
            { title: "Magnets in Technology", slideIndex: 13 },
            { title: "Magnets in Medicine", slideIndex: 14 },
            { title: "Earth as a Magnet", slideIndex: 15 }
        ]
    },
    {
        title: "Assessment",
        subtopics: [
            { title: "Review & Summary", slideIndex: 16 },
            { title: "Quiz 1", slideIndex: 17 },
            { title: "Quiz 2", slideIndex: 18 },
            { title: "Final Challenge", slideIndex: 19 }
        ]
    }
];

// Global variables for interactive features
let currentSlideIndex = 0;
let sidebarOpen = false;
let aiHelpOpen = false;
let fieldLinesVisible = false;
let compassAngle = 0;
let compassMagnetInterference = false;

// Final challenge variables
let finalQuestions = [
    {
        question: "Why does a compass needle always point North?",
        image: "🧲🧭",
        options: [
            { text: "The needle is made of gold", correct: false },
            { text: "Earth has a magnetic field", correct: true },
            { text: "The Sun pulls the needle", correct: false },
            { text: "Gravity makes it point North", correct: false }
        ],
        explanation: "Perfect! A compass needle points North because Earth itself is like a giant magnet with a magnetic field. The magnetized needle aligns with Earth's magnetic field lines, which point toward the magnetic North pole. This is why compasses have been used for navigation for over 1,000 years!"
    },
    {
        question: "What happens when you stroke an iron nail with a magnet many times?",
        image: "🔧🧲",
        options: [
            { text: "The nail becomes temporarily magnetic", correct: true },
            { text: "The nail turns into gold", correct: false },
            { text: "Nothing happens to the nail", correct: false },
            { text: "The nail becomes permanently hot", correct: false }
        ],
        explanation: "Excellent! When you stroke an iron nail with a magnet repeatedly in the same direction, the nail becomes temporarily magnetic. This happens because the magnet aligns the tiny magnetic domains in the iron, creating poles in the nail. This is called magnetic induction!"
    },
    {
        question: "Which of these is NOT a use of magnets in everyday life?",
        image: "🏠🧲",
        options: [
            { text: "Refrigerator door seals", correct: false },
            { text: "Computer hard drives", correct: false },
            { text: "Making food taste better", correct: true },
            { text: "MRI medical machines", correct: false }
        ],
        explanation: "Great job! Magnets don't make food taste better - that's not one of their properties! However, magnets are used in refrigerator seals, computer hard drives for data storage, and MRI machines to see inside our bodies. Magnets have many amazing uses, but changing food taste isn't one of them!"
    }
];

let currentFinalQuestion = 0;
let finalScore = 0;
let finalAnswered = false;

// Experiment variables
let draggedElement = null;
let experimentObjects = [];

function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const slideModal = document.getElementById('slide-modal');
    const menuToggle = document.getElementById('menu-toggle');
    const overlay = document.getElementById('sidebar-overlay');
    
    sidebarOpen = !sidebarOpen;
    
    if (sidebarOpen) {
        sidebar.classList.add('open');
        slideModal.classList.add('sidebar-open');
        menuToggle.classList.add('sidebar-open');
        menuToggle.innerHTML = '✕';
        overlay.classList.add('show');
        document.body.style.overflow = 'hidden';
    } else {
        sidebar.classList.remove('open');
        slideModal.classList.remove('sidebar-open');
        menuToggle.classList.remove('sidebar-open');
        menuToggle.innerHTML = '🧲';
        overlay.classList.remove('show');
        document.body.style.overflow = '';
    }
}

function toggleAIHelp() {
    const panel = document.getElementById('ai-help-panel');
    const toggle = document.getElementById('ai-help-toggle');
    
    aiHelpOpen = !aiHelpOpen;
    
    if (aiHelpOpen) {
        panel.classList.add('open');
        toggle.classList.add('active');
        toggle.innerHTML = '✕';
    } else {
        panel.classList.remove('open');
        toggle.classList.remove('active');
        toggle.innerHTML = '🤖';
    }
}

function askAI(question) {
    const input = document.getElementById('ai-input');
    input.value = question;
    sendAIMessage();
}

function sendAIMessage() {
    const input = document.getElementById('ai-input');
    const messages = document.getElementById('ai-chat-messages');
    const question = input.value.trim();
    
    if (!question) return;
    
    const userMessage = document.createElement('div');
    userMessage.className = 'ai-message user';
    userMessage.textContent = question;
    messages.appendChild(userMessage);
    
    input.value = '';
    
    setTimeout(() => {
        const botMessage = document.createElement('div');
        botMessage.className = 'ai-message bot';
        botMessage.textContent = generateAIResponse(question);
        messages.appendChild(botMessage);
        messages.scrollTop = messages.scrollHeight;
    }, 1000);
    
    messages.scrollTop = messages.scrollHeight;
}

function generateAIResponse(question) {
    const responses = {
        'what are magnets': 'Magnets are special objects that can attract certain metals like iron, nickel, and cobalt! They have invisible forces called magnetic fields and always have two poles - North and South. 🧲',
        'how do magnets work': 'Magnets work through invisible magnetic fields! These fields can attract magnetic materials and interact with other magnets. Opposite poles attract each other, while same poles repel! 🌀',
        'uses of magnets': 'Magnets are everywhere! They\'re in your fridge, speakers, computers, MRI machines, compasses, and even electric cars. Earth itself is a giant magnet that protects us! 🏠💻🏥',
        'magnetic field': 'A magnetic field is the invisible area around a magnet where its force can be felt. You can see field lines using iron filings - they show the path from North to South pole! 🌀',
        'poles': 'Every magnet has two poles: North (usually red) and South (usually blue). Opposite poles attract each other, but same poles repel. You can never have just one pole! 🔴🔵',
        'compass': 'A compass works because Earth is like a giant magnet! The magnetized needle aligns with Earth\'s magnetic field and points toward magnetic North. That\'s how people navigate! 🧭',
        'earth magnet': 'Earth has a magnetic field created by its molten iron core! This field protects us from harmful space radiation and creates beautiful auroras. It also helps animals navigate during migration! 🌍',
        'mri': 'MRI machines use super strong magnets to see inside your body without surgery! They align hydrogen atoms in your body and use radio waves to create detailed pictures. No harmful radiation! 🏥',
        'temporary magnet': 'You can make temporary magnets by stroking iron objects with a permanent magnet! The iron becomes magnetized but loses its magnetism over time. Try it with a nail! 🔧',
        'magnetic materials': 'Only three elements are strongly magnetic: iron, nickel, and cobalt! Steel contains iron so it\'s magnetic too. Aluminum, copper, plastic, and wood are not magnetic! 🧲'
    };
    
    const key = question.toLowerCase();
    for (const [keyword, response] of Object.entries(responses)) {
        if (key.includes(keyword.replace(/\s+/g, '')) || key.includes(keyword)) {
            return response;
        }
    }
    
    return `That's a great question about magnets! Based on slide ${currentSlideIndex + 1}, I'd suggest exploring how magnetic forces work invisibly around us. Feel free to ask more specific questions! 🧲`;
}

function handleAIKeyPress(event) {
    if (event.key === 'Enter') {
        event.preventDefault();
        sendAIMessage();
    }
}

function renderSidebar() {
    const sidebar = document.getElementById('sidebar');
    sidebar.innerHTML = '';
    
    subtopicSections.forEach(section => {
        const headerDiv = document.createElement('div');
        headerDiv.className = 'subtopic-section';
        
        const header = document.createElement('div');
        header.className = 'subtopic-header';
        header.textContent = section.title;
        headerDiv.appendChild(header);
        
        section.subtopics.forEach(subtopic => {
            const btn = document.createElement('button');
            btn.className = 'subtopic-btn' + (currentSlideIndex === subtopic.slideIndex ? ' active' : '');
            btn.textContent = subtopic.title;
            btn.onclick = () => {
                currentSlideIndex = subtopic.slideIndex;
                loadSlide();
                if (window.innerWidth <= 768) {
                    toggleSidebar();
                }
            };
            headerDiv.appendChild(btn);
        });
        
        sidebar.appendChild(headerDiv);
    });
}

function loadSlide() {
    const slideContentEl = document.getElementById('slide-content');
    
    slideContentEl.innerHTML = '';
    
    const mainArea = document.createElement('div');
    mainArea.className = 'main-slide-area';
    mainArea.id = 'main-slide-area';
    
    const slideEl = document.createElement('div');
    slideEl.className = 'slide active';
    slideEl.innerHTML = slides[currentSlideIndex].content;
    mainArea.appendChild(slideEl);
    
    slideContentEl.appendChild(mainArea);
    
    if (slides[currentSlideIndex].notes) {
        const notesSection = document.createElement('div');
        notesSection.className = 'notes-section';
        notesSection.style.cssText = `
            background: #ffffff;
            border-radius: 12px;
            margin-top: 24px;
            padding: 24px;
            box-shadow: 0 3px 12px rgba(0,0,0,0.06);
            border-top: 3px solid #dc2626;
        `;
        
        notesSection.innerHTML = `
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 16px; color: #dc2626; font-weight: 600; font-size: 1.1rem;">
                <span>📝</span>
                <span>Study Notes</span>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; align-items: start;">
                <div style="font-size: 0.95rem; line-height: 1.7; color: #374151;">
                    ${slides[currentSlideIndex].notes.text}
                </div>
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    ${slides[currentSlideIndex].notes.images.map(img => 
                        `<div style="width: 100%; height: 120px; background: #f7f7f7; border: 2px solid #e5e7eb; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 0.85rem; color: #6b7280; filter: grayscale(100%); position: relative; overflow: hidden; text-align: center; padding: 12px;">${img}</div>`
                    ).join('')}
                </div>
            </div>
        `;
        
        slideContentEl.appendChild(notesSection);
    }
    
    // Initialize interactive features based on slide content
    initializeSlideFeatures();
    
    updateSlideCounter();
    updateNavigationButtons();
    updateSlideProgress();
    renderSidebar();
}

function initializeSlideFeatures() {
    // Initialize magnetic field visualization if on that slide
    if (currentSlideIndex === 4) {
        initializeMagneticField();
    }
    
    // Initialize interactive experiment if on that slide
    if (currentSlideIndex === 7) {
        initializeExperiment();
    }
    
    // Initialize compass if on that slide
    if (currentSlideIndex === 11) {
        initializeCompass();
    }
    
    // Initialize final challenge if on that slide
    if (currentSlideIndex === 19) {
        initializeFinalChallenge();
    }
}

function initializeMagneticField() {
    // Add field lines to visualization
    const visualization = document.getElementById('field-visualization');
    if (visualization) {
        // Clear existing field lines
        const existingLines = visualization.querySelectorAll('.field-line');
        existingLines.forEach(line => line.remove());
        
        // Add some field lines
        for (let i = 0; i < 8; i++) {
            const line = document.createElement('div');
            line.className = 'field-line';
            line.style.cssText = `
                position: absolute;
                height: 2px;
                background: linear-gradient(90deg, #dc2626, #2563eb);
                border-radius: 1px;
                opacity: 0;
                transition: opacity 0.5s ease;
                width: ${100 + i * 20}px;
                top: ${40 + i * 20}px;
                left: 50%;
                transform: translateX(-50%) rotate(${i * 5 - 20}deg);
            `;
            visualization.appendChild(line);
        }
    }
}

function toggleFieldLines() {
    const lines = document.querySelectorAll('.field-line');
    fieldLinesVisible = !fieldLinesVisible;
    
    lines.forEach(line => {
        line.style.opacity = fieldLinesVisible ? '0.7' : '0';
    });
}

function animateField() {
    const lines = document.querySelectorAll('.field-line');
    lines.forEach((line, index) => {
        setTimeout(() => {
            line.style.opacity = '0.7';
            setTimeout(() => {
                line.style.opacity = '0.3';
            }, 500);
        }, index * 100);
    });
}

function initializeExperiment() {
    // Initialize drag and drop for experiment objects
    const objects = document.querySelectorAll('.magnet-object');
    objects.forEach(obj => {
        obj.addEventListener('dragstart', handleDragStart);
        obj.addEventListener('dragend', handleDragEnd);
    });
    
    const area = document.getElementById('experiment-area');
    if (area) {
        area.addEventListener('dragover', handleDragOver);
        area.addEventListener('drop', handleDrop);
    }
}

function handleDragStart(e) {
    draggedElement = e.target;
    e.target.classList.add('dragging');
}

function handleDragEnd(e) {
    e.target.classList.remove('dragging');
    draggedElement = null;
}

function handleDragOver(e) {
    e.preventDefault();
}

function handleDrop(e) {
    e.preventDefault();
    if (draggedElement) {
        const rect = e.currentTarget.getBoundingClientRect();
        const x = e.clientX - rect.left - draggedElement.offsetWidth / 2;
        const y = e.clientY - rect.top - draggedElement.offsetHeight / 2;
        
        draggedElement.style.left = Math.max(0, Math.min(x, rect.width - draggedElement.offsetWidth)) + 'px';
        draggedElement.style.top = Math.max(0, Math.min(y, rect.height - draggedElement.offsetHeight)) + 'px';
        
        checkMagneticInteraction();
    }
}

function checkMagneticInteraction() {
    const magnets = document.querySelectorAll('.magnet-north, .magnet-south');
    const testObjects = document.querySelectorAll('.test-object');
    
    magnets.forEach(magnet => {
        testObjects.forEach(obj => {
            const distance = getDistance(magnet, obj);
            if (distance < 80) {
                if (obj.classList.contains('magnetic')) {
                    obj.classList.add('attracted');
                    setTimeout(() => obj.classList.remove('attracted'), 500);
                }
            }
        });
    });
}

function getDistance(elem1, elem2) {
    const rect1 = elem1.getBoundingClientRect();
    const rect2 = elem2.getBoundingClientRect();
    const dx = rect1.left - rect2.left;
    const dy = rect1.top - rect2.top;
    return Math.sqrt(dx * dx + dy * dy);
}

function resetExperiment() {
    const objects = document.querySelectorAll('.magnet-object');
    const positions = [
        { top: '50px', left: '100px' },
        { top: '50px', right: '100px' },
        { top: '150px', left: '150px' },
        { top: '150px', right: '150px' },
        { top: '200px', left: '200px' },
        { top: '200px', right: '200px' }
    ];
    
    objects.forEach((obj, index) => {
        if (positions[index]) {
            Object.assign(obj.style, positions[index]);
            obj.classList.remove('attracted', 'repelled');
        }
    });
    
    const tip = document.getElementById('experiment-tip');
    if (tip) {
        tip.textContent = 'Drag the red North pole near different objects. Notice which ones are attracted and which ones aren\'t affected!';
    }
}

function showFieldLines() {
    toggleFieldLines();
    const tip = document.getElementById('experiment-tip');
    if (tip) {
        tip.textContent = fieldLinesVisible ? 
            'Field lines show the invisible magnetic field! They go from North to South pole.' :
            'Field lines are now hidden. Click again to show the invisible magnetic field!';
    }
}

function testAttraction() {
    const magneticObjects = document.querySelectorAll('.test-object.magnetic');
    magneticObjects.forEach(obj => {
        obj.classList.add('attracted');
        setTimeout(() => obj.classList.remove('attracted'), 1000);
    });
    
    const tip = document.getElementById('experiment-tip');
    if (tip) {
        tip.textContent = 'The iron and steel objects are attracted because they are magnetic materials!';
    }
}

function initializeCompass() {
    resetCompass();
}

function spinCompass() {
    const needle = document.getElementById('compass-needle');
    const status = document.getElementById('compass-status');
    
    if (needle && status) {
        // Spin animation
        let spins = 0;
        const spinInterval = setInterval(() => {
            spins += 30;
            needle.style.transform = `translate(-50%, -50%) rotate(${spins}deg)`;
            
            if (spins >= 720) {
                clearInterval(spinInterval);
                // Return to North
                setTimeout(() => {
                    needle.style.transform = 'translate(-50%, -50%) rotate(0deg)';
                    status.textContent = 'Compass needle settled pointing North';
                }, 500);
            }
        }, 50);
        
        status.textContent = 'Compass spinning...';
    }
}

function addMagnet() {
    const needle = document.getElementById('compass-needle');
    const status = document.getElementById('compass-status');
    
    if (needle && status) {
        compassMagnetInterference = !compassMagnetInterference;
        
        if (compassMagnetInterference) {
            // Deflect needle
            needle.style.transform = 'translate(-50%, -50%) rotate(45deg)';
            status.textContent = 'Strong magnet nearby - compass deflected!';
            status.style.color = '#dc2626';
        } else {
            // Return to North
            needle.style.transform = 'translate(-50%, -50%) rotate(0deg)';
            status.textContent = 'Magnet removed - compass points North again';
            status.style.color = '#166534';
        }
    }
}

function resetCompass() {
    const needle = document.getElementById('compass-needle');
    const status = document.getElementById('compass-status');
    
    if (needle && status) {
        needle.style.transform = 'translate(-50%, -50%) rotate(0deg)';
        status.textContent = 'Compass pointing to Magnetic North';
        status.style.color = '#166534';
        compassMagnetInterference = false;
    }
}

function showEarthField() {
    alert('🌍 Earth\'s magnetic field extends far into space, creating the magnetosphere that protects us from solar wind and cosmic radiation!');
}

function showSolarWind() {
    alert('☀️ Solar wind particles are deflected by Earth\'s magnetic field, creating beautiful auroras at the poles when some particles interact with our atmosphere!');
}

function initializeFinalChallenge() {
    currentFinalQuestion = 0;
    finalScore = 0;
    finalAnswered = false;
    loadFinalQuestion();
}

function loadFinalQuestion() {
    const question = finalQuestions[currentFinalQuestion];
    
    document.getElementById('final-image').textContent = question.image;
    document.getElementById('final-question-text').textContent = question.question;
    document.getElementById('final-current-question').textContent = currentFinalQuestion + 1;
    document.getElementById('final-total-questions').textContent = finalQuestions.length;
    
    const optionsContainer = document.getElementById('final-options');
    optionsContainer.innerHTML = '';
    
    question.options.forEach((option, index) => {
        const button = document.createElement('button');
        button.className = 'quiz-option';
        button.textContent = option.text;
        button.onclick = () => selectFinalAnswer(button, option.correct, index);
        optionsContainer.appendChild(button);
    });
    
    document.getElementById('final-feedback').style.display = 'none';
    document.getElementById('next-final-btn').disabled = true;
    finalAnswered = false;
    
    updateFinalProgress();
}

function selectFinalAnswer(button, isCorrect, index) {
    if (finalAnswered) return;
    
    finalAnswered = true;
    const question = finalQuestions[currentFinalQuestion];
    
    // Mark all options
    const options = document.querySelectorAll('#final-options .quiz-option');
    options.forEach((opt, i) => {
        opt.classList.remove('selected', 'correct', 'incorrect');
        if (question.options[i].correct) {
            opt.classList.add('correct');
        } else if (opt === button && !isCorrect) {
            opt.classList.add('incorrect');
        }
    });
    
    button.classList.add('selected');
    
    if (isCorrect) {
        finalScore++;
    }
    
    // Show explanation
    const feedback = document.getElementById('final-feedback');
    feedback.innerHTML = `<strong>${isCorrect ? 'Correct!' : 'Not quite right.'}</strong> ${question.explanation}`;
    feedback.style.display = 'block';
    
    // Enable next button
    document.getElementById('next-final-btn').disabled = false;
    
    updateFinalProgress();
}

function nextFinalQuestion() {
    currentFinalQuestion++;
    
    if (currentFinalQuestion < finalQuestions.length) {
        loadFinalQuestion();
    } else {
        showFinalResults();
    }
}

function showFinalResults() {
    const accuracy = Math.round((finalScore / finalQuestions.length) * 100);
    
    document.getElementById('next-final-btn').style.display = 'none';
    document.getElementById('complete-course-btn').style.display = 'inline-block';
    
    const feedback = document.getElementById('final-feedback');
    feedback.innerHTML = `
        <div style="text-align: center; padding: 20px;">
            <div style="font-size: 3rem; margin-bottom: 15px;">🎉</div>
            <h3 style="color: #dc2626; margin-bottom: 15px;">Challenge Complete!</h3>
            <p style="font-size: 1.2rem; margin-bottom: 10px;">Final Score: <strong>${finalScore}/${finalQuestions.length}</strong></p>
            <p style="font-size: 1.1rem; margin-bottom: 20px;">Mastery Level: <strong>${accuracy}%</strong></p>
            <div style="background: ${accuracy >= 80 ? '#dcfce7' : accuracy >= 60 ? '#fef3c7' : '#fee2e2'}; 
                        color: ${accuracy >= 80 ? '#166534' : accuracy >= 60 ? '#92400e' : '#991b1b'}; 
                        padding: 15px; border-radius: 10px; margin-top: 15px;">
                ${accuracy >= 80 ? '🌟 Excellent! You\'re a Magnet Master!' : 
                  accuracy >= 60 ? '👍 Good job! You understand the basics well!' : 
                  '📚 Keep studying! Review the slides and try again!'}
            </div>
        </div>
    `;
    feedback.style.display = 'block';
}

function updateFinalProgress() {
    const progress = ((currentFinalQuestion + (finalAnswered ? 1 : 0)) / finalQuestions.length) * 100;
    const accuracy = finalQuestions.length > 0 ? Math.round((finalScore / Math.max(currentFinalQuestion + (finalAnswered ? 1 : 0), 1)) * 100) : 0;
    
    document.getElementById('final-score').textContent = `Score: ${finalScore}/${finalQuestions.length}`;
    document.getElementById('final-accuracy').textContent = `${accuracy}%`;
    document.getElementById('final-progress-bar').style.width = `${progress}%`;
}

function completeMagnetCourse() {
    alert('🎓 Congratulations! You have successfully completed the Magnets & Interactions course! You now understand the invisible forces that shape our world. Keep exploring science!');
}

function selectQuizAnswer(element, isCorrect, slideIndex) {
    const options = element.parentElement.querySelectorAll('.quiz-option');
    options.forEach(opt => {
        opt.classList.remove('selected', 'correct', 'incorrect');
        opt.disabled = true;
    });
    
    element.classList.add('selected');
    element.classList.add(isCorrect ? 'correct' : 'incorrect');
    
    const explanation = document.getElementById(`explanation${slideIndex}`);
    if (explanation) {
        explanation.classList.add('show');
    }
}

function updateSlideCounter() {
    document.getElementById('slide-counter').textContent = `${currentSlideIndex + 1} / ${slides.length}`;
}

function updateNavigationButtons() {
    document.getElementById('prev-slide-btn').disabled = currentSlideIndex === 0;
    document.getElementById('next-slide-btn').disabled = currentSlideIndex >= slides.length - 1;
}

function updateSlideProgress() {
    const progressEl = document.getElementById('slide-progress');
    progressEl.innerHTML = '';
    
    for (let i = 0; i < slides.length; i++) {
        const dot = document.createElement('div');
        dot.className = 'progress-dot' + (i === currentSlideIndex ? ' active' : '');
        dot.onclick = () => {
            currentSlideIndex = i;
            loadSlide();
        };
        progressEl.appendChild(dot);
    }
}

function nextSlide() {
    if (currentSlideIndex < slides.length - 1) {
        currentSlideIndex++;
        loadSlide();
    }
}

function previousSlide() {
    if (currentSlideIndex > 0) {
        currentSlideIndex--;
        loadSlide();
    }
}

// Initialize the application
document.addEventListener('DOMContentLoaded', function() {
    renderSidebar();
    loadSlide();
    
    // Close sidebar when clicking overlay
    document.getElementById('sidebar-overlay').addEventListener('click', toggleSidebar);
    
    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowRight' || e.key === ' ') {
            e.preventDefault();
            nextSlide();
        } else if (e.key === 'ArrowLeft') {
            e.preventDefault();
            previousSlide();
        } else if (e.key === 'Escape') {
            if (sidebarOpen) toggleSidebar();
            if (aiHelpOpen) toggleAIHelp();
        }
    });
});
</script>
</body>
</html>
