<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Light & Heat Systems - P4 Science</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
             margin: 0;
             font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
             background: #f1f5f9;
             overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            color: #0360a5;
        }
        
        .slide-modal {
             width: 100vw;
             height: 100vh;
             background: #f1f5f9;
             display: flex;
             align-items: stretch;
             justify-content: center;
             transition: padding-left 0.3s ease;
            position: relative;
        }
        
        .slide-modal.sidebar-open { padding-left: 280px; }
        
        .sidebar {
            width: 280px;
            background: #ffffff;
            border-right: 1px solid #e5e7eb;
            padding: 20px 0 0 0;
            display: flex;
            flex-direction: column;
            gap: 4px;
            overflow-y: auto;
            position: fixed;
            left: -280px;
            top: 0;
            height: 100vh;
            z-index: 1000;
            transition: left 0.3s ease;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            -webkit-overflow-scrolling: touch;
        }
        
        .sidebar.open { left: 0; }
        
        .menu-toggle {
            position: fixed;
            top: 16px;
            left: 16px;
            z-index: 1001;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px 14px;
            cursor: pointer;
            font-size: 1.3rem;
            box-shadow: 0 3px 12px rgba(245,158,11,0.3);
            transition: all 0.3s ease;
            min-height: 50px;
            min-width: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .menu-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245,158,11,0.4);
        }
        
        .menu-toggle.sidebar-open {
            left: 16px;
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            transform: none;
        }
        
        .subtopic-section {
            margin-bottom: 16px;
        }
        .subtopic-header {
            background: #e5e7eb;
            padding: 12px 20px;
            font-size: 0.85rem;
            font-weight: 600;
            color: #f59e0b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .subtopic-btn {
            background: none;
            border: none;
            text-align: left;
            padding: 14px 24px;
            font-size: 0.95rem;
            color: #374151;
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 4px solid transparent;
            width: 100%;
            display: block;
            min-height: 50px;
            line-height: 1.5;
        }
        .subtopic-btn.active, .subtopic-btn:hover {
            background: #fef3c7;
            color: #92400e;
            border-left: 4px solid #f59e0b;
            font-weight: 600;
        }
        
        .slide-container {
             background: #ffffff;
             border-radius: 12px;
             width: 100vw;
             max-width: none;
             height: 95vh;
             box-shadow: 0 6px 24px rgba(0,0,0,0.1);
             display: flex;
             flex-direction: column;
             flex: 1;
             margin: 12px;
            position: relative;
        }
        
        .slide-header {
             background: linear-gradient(135deg, #f59e0b, #d97706);
             color: white;
             padding: 20px 32px;
             display: flex;
             justify-content: space-between;
             align-items: center;
             flex-shrink: 0;
            border-radius: 12px 12px 0 0;
        }
        .slide-title {
             font-size: 1.5rem;
             font-weight: 700;
             display: flex;
             align-items: center;
             gap: 12px;
             margin: 0;
            letter-spacing: -0.02em;
        }
        .slide-counter {
             background: rgba(255,255,255,0.15);
             padding: 8px 16px;
             border-radius: 20px;
             font-weight: 600;
             font-size: 0.9rem;
        }
        
        .slide-content {
             flex: 1;
             overflow-y: auto;
             display: flex;
             flex-direction: column;
            background: #f8fafc;
             padding: 24px;
            -webkit-overflow-scrolling: touch;
        }
        
        .main-slide-area {
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
           
        }
        
        .slide {
             width: 100%;
             max-width: 900px;
             margin: 0 auto;
             padding: 32px 24px;
             background: #ffffff;
             border-radius: 16px;
             box-shadow: 0 4px 20px rgba(245,158,11,0.08);
             display: flex;
             flex-direction: column;
             align-items: center;
             text-align: center;
            line-height: 1.6;
        }
        
        .slide h2, .slide h3 {
            color: #f59e0b;
            margin-bottom: 16px;
            font-weight: 700;
        }
        
        .slide p {
            color: #374151;
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto 16px;
            line-height: 1.7;
        }

        .slide-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
            width: 100%;
            max-width: 700px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
            width: 100%;
            max-width: 700px;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
            width: 100%;
            max-width: 800px;
        }

        .info-card {
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .info-card h4 {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1rem;
            color: #f59e0b;
        }

        .info-card p {
            font-size: 0.95rem;
            margin: 0;
        }

        .info-card ul {
            text-align: left;
            margin: 10px 0;
            padding-left: 20px;
        }

        .info-card li {
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .yellow-card { background: linear-gradient(135deg, #fef3c7 0%, #fcd34d 100%); }
        .orange-card { background: linear-gradient(135deg, #fed7aa 0%, #fdba74 100%); }
        .red-card { background: linear-gradient(135deg, #fecaca 0%, #f87171 100%); }
        .blue-card { background: linear-gradient(135deg, #dbeafe 0%, #93c5fd 100%); }
        .purple-card { background: linear-gradient(135deg, #e9d5ff 0%, #c4b5fd 100%); }
        .green-card { background: linear-gradient(135deg, #d4f4dd 0%, #a7f3d0 100%); }
        .gray-card { background: linear-gradient(135deg, #f3f4f6 0%, #d1d5db 100%); }
        .pink-card { background: linear-gradient(135deg, #fce7f3 0%, #f9a8d4 100%); }

        .system-diagram {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            max-width: 700px;
            text-align: left;
            border: 2px solid #f59e0b;
        }

        .system-diagram h4 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #92400e;
            text-align: center;
        }

        .system-diagram ul {
            list-style: none;
            padding: 0;
        }

        .system-diagram li {
            padding: 8px 0;
            font-size: 1rem;
            color: #a16207;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .system-diagram strong {
            color: #92400e;
            font-size: 1.1rem;
        }

        .process-flow {
            background: linear-gradient(135deg, #dbeafe 0%, #93c5fd 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            max-width: 700px;
            text-align: left;
            border: 2px solid #3b82f6;
        }

        .process-flow h4 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #1e40af;
            text-align: center;
        }

        .process-step {
            display: flex;
            align-items: center;
            margin: 15px 0;
            padding: 12px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            gap: 15px;
        }

        .step-number {
            background: #3b82f6;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-content strong {
            color: #1e40af;
            display: block;
            margin-bottom: 5px;
        }

        .step-content p {
            margin: 0;
            font-size: 0.9rem;
            color: #1e3a8a;
        }

        .video-container {
            width: 100%;
            max-width: 700px;
            margin: 24px 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .video-placeholder {
            width: 100%;
            height: 250px;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.1rem;
            border-radius: 12px;
            text-align: center;
            padding: 20px;
        }

        .fun-fact {
            background: linear-gradient(135deg, #fce7f3 0%, #f9a8d4 100%);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            max-width: 600px;
            border-left: 4px solid #ec4899;
        }

        .fun-fact h4 {
            color: #be185d;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .fun-fact p {
            color: #be185d;
            margin: 0;
            font-size: 0.95rem;
        }

        /* Interactive Light Experiment Styles */
        .light-experiment {
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            max-width: 700px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .light-source {
            position: absolute;
            width: 40px;
            height: 40px;
            background: radial-gradient(circle, #fbbf24 0%, #f59e0b 70%);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.6);
        }

        .light-source.active {
            box-shadow: 0 0 40px rgba(251, 191, 36, 0.9);
            transform: scale(1.1);
        }

        .light-ray {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, rgba(251, 191, 36, 0.8) 0%, rgba(251, 191, 36, 0) 100%);
            transform-origin: left center;
            transition: all 0.5s ease;
            opacity: 0;
        }

        .light-ray.visible {
            opacity: 1;
        }

        .shadow-object {
            position: absolute;
            background: #374151;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 5px;
        }

        .shadow-object:hover {
            background: #4b5563;
        }

        .shadow-cast {
            position: absolute;
            background: rgba(0, 0, 0, 0.6);
            transition: all 0.5s ease;
            border-radius: 5px;
        }

        .experiment-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .experiment-btn {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .experiment-btn:hover {
            background: linear-gradient(135deg, #d97706, #b45309);
            transform: translateY(-1px);
        }

        .experiment-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Heat Transfer Simulator Styles */
        .heat-simulator {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            max-width: 700px;
            color: white;
        }

        .heat-objects {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px 0;
            min-height: 150px;
            position: relative;
        }

        .heat-object {
            width: 80px;
            height: 80px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.5s ease;
            position: relative;
        }

        .heat-object.hot {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.6);
            animation: heat-glow 2s infinite alternate;
        }

        .heat-object.warm {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            box-shadow: 0 0 15px rgba(245, 158, 11, 0.5);
        }

        .heat-object.cool {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            box-shadow: 0 0 10px rgba(59, 130, 246, 0.4);
        }

        @keyframes heat-glow {
            0% { box-shadow: 0 0 20px rgba(220, 38, 38, 0.6); }
            100% { box-shadow: 0 0 30px rgba(220, 38, 38, 0.9); }
        }

        .heat-transfer-arrow {
            position: absolute;
            font-size: 2rem;
            color: #fbbf24;
            opacity: 0;
            transition: all 0.5s ease;
        }

        .heat-transfer-arrow.active {
            opacity: 1;
            animation: heat-flow 1.5s infinite;
        }

        @keyframes heat-flow {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .temperature-display {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
        }

        /* Conductor Test Game Styles */
        .conductor-game {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            max-width: 700px;
            color: white;
        }

        .circuit-board {
            background: #1f2937;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            position: relative;
            min-height: 200px;
        }

        .battery {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 60px;
            height: 30px;
            background: linear-gradient(135deg, #374151, #1f2937);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            border: 2px solid #6b7280;
        }

        .light-bulb {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            background: #374151;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: all 0.3s ease;
        }

        .light-bulb.lit {
            background: #fbbf24;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.8);
            color: #92400e;
        }

        .test-materials {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .material-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .material-item:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .material-item.conductor {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.3);
        }

        .material-item.insulator {
            border-color: #dc2626;
            background: rgba(220, 38, 38, 0.3);
        }

        .material-item.selected {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.3);
        }

        /* Shadow Theater Styles */
        .shadow-theater {
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            max-width: 700px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .theater-screen {
            background: #f3f4f6;
            height: 200px;
            border-radius: 10px;
            position: relative;
            margin: 20px 0;
            overflow: hidden;
        }

        .puppet {
            position: absolute;
            bottom: 0;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 3rem;
            user-select: none;
        }

        .puppet:hover {
            transform: scale(1.1);
        }

        .puppet-shadow {
            position: absolute;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            transition: all 0.3s ease;
            border-radius: 50%;
        }

        .theater-light {
            position: absolute;
            top: 10px;
            background: radial-gradient(circle, #fbbf24 0%, #f59e0b 70%);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.6);
        }

        .puppet-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        /* Quiz Styles */
        .quiz-option {
             background: #ffffff;
             border: 2px solid #e5e7eb;
             border-radius: 10px;
             padding: 16px 20px;
             cursor: pointer;
             margin: 8px 0;
             font-size: 1rem;
             width: 100%;
            max-width: 600px;
            transition: all 0.2s ease;
            min-height: 50px;
            text-align: left;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .quiz-option:hover {
            border-color: #f59e0b;
            transform: translateY(-1px);
        }
        .quiz-option.selected {
             background: #fef3c7;
             border-color: #f59e0b;
             color: #92400e;
         }
        .quiz-option.correct {
             background: #dcfce7;
             border-color: #22c55e;
             color: #15803d;
         }
        .quiz-option.incorrect {
             background: #fee2e2;
             border-color: #dc2626;
             color: #b91c1c;
         }
        .quiz-explanation {
             background: #f0fdf4;
             border-radius: 10px;
             padding: 20px;
             border-left: 4px solid #22c55e;
             margin-top: 20px;
             display: none;
             max-width: 600px;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        .quiz-explanation.show { display: block; }
        
        .slide-navigation {
             background: #ffffff;
             padding: 20px 32px;
             display: flex;
             justify-content: space-between;
             align-items: center;
             border-top: 1px solid #e5e7eb;
             flex-shrink: 0;
            border-radius: 0 0 12px 12px;
        }
        
        .nav-btn {
             background: linear-gradient(135deg, #f59e0b, #d97706);
             color: white;
             border: none;
             border-radius: 10px;
             padding: 12px 24px;
             font-size: 1rem;
             font-weight: 600;
             cursor: pointer;
             min-height: 50px;
            transition: all 0.2s ease;
        }
        .nav-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(245,158,11,0.3);
        }
        .nav-btn:disabled {
             opacity: 0.5;
             cursor: not-allowed;
             transform: none;
            box-shadow: none;
        }
        .slide-progress {
             display: flex;
             gap: 8px;
             align-items: center;
             flex-wrap: wrap;
            justify-content: center;
        }
        .progress-dot {
             width: 10px;
             height: 10px;
             border-radius: 50%;
             background: #d1d5db;
             transition: all 0.2s ease;
        }
        .progress-dot.active {
             background: linear-gradient(135deg, #f59e0b, #d97706);
            transform: scale(1.3);
        }
        
        .back-home-btn {
            background: #ffffff;
            color: #f59e0b;
            font-weight: 600;
            border-radius: 10px;
            padding: 8px 16px;
            text-decoration: none;
            box-shadow: 0 2px 8px rgba(245,158,11,0.1);
            font-size: 0.9rem;
            border: none;
            margin-left: 12px;
            transition: all 0.2s ease;
            min-height: 40px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        .back-home-btn:hover {
            background: #fef3c7;
            color: #92400e;
        }
        
        /* Overlay for mobile menu */
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
            transition: opacity 0.3s ease;
        }
        
        .sidebar-overlay.show {
            display: block;
            opacity: 1;
        }

        /* AI Help Floating Widget */
        .ai-help-widget {
            position: fixed;
            top: 16px;
            right: 16px;
            z-index: 1002;
            font-family: inherit;
        }
        
        .ai-help-toggle {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            cursor: pointer;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(16, 185, 129, 0.4);
            transition: all 0.3s ease;
        }
        
        .ai-help-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(16, 185, 129, 0.5);
        }
        
        .ai-help-toggle.active {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            box-shadow: 0 4px 20px rgba(239, 68, 68, 0.4);
        }
        
        .ai-help-panel {
            position: absolute;
            top: 70px;
            right: 0;
            width: 340px;
            max-height: 480px;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            border: 1px solid #e5e7eb;
            transform: translateY(-20px) scale(0.95);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .ai-help-panel.open {
            transform: translateY(0) scale(1);
            opacity: 1;
            visibility: visible;
        }
        
        .ai-help-header {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 16px 20px;
            border-radius: 12px 12px 0 0;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.95rem;
        }
        
        .ai-help-content {
            padding: 20px;
            max-height: 320px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .ai-chat-messages {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 16px;
            min-height: 80px;
        }
        
        .ai-message {
            padding: 10px 14px;
            border-radius: 10px;
            font-size: 0.85rem;
            line-height: 1.5;
            word-wrap: break-word;
        }
        
        .ai-message.user {
            background: #fef3c7;
            color: #92400e;
            align-self: flex-end;
            max-width: 80%;
        }
        
        .ai-message.bot {
            background: #f0fdf4;
            color: #166534;
            align-self: flex-start;
            max-width: 90%;
        }
        
        .ai-input-area {
            display: flex;
            gap: 8px;
            border-top: 1px solid #e5e7eb;
            padding-top: 16px;
        }
        
        .ai-input {
            flex: 1;
            padding: 10px 14px;
            border: 1px solid #e5e7eb;
            border-radius: 20px;
            font-size: 0.9rem;
            outline: none;
            transition: border-color 0.2s;
            min-height: 40px;
        }
        
        .ai-input:focus {
            border-color: #10b981;
        }
        
        .ai-send-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
            flex-shrink: 0;
        }
        
        .ai-send-btn:hover {
            transform: scale(1.05);
        }
        
        .ai-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 16px;
        }
        
        .ai-suggestion {
            background: #f3f4f6;
            color: #374151;
            border: none;
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 36px;
        }
        
        .ai-suggestion:hover {
            background: #fef3c7;
            color: #92400e;
        }

        /* Notes Section */
        .notes-section {
            background: #ffffff;
            border-radius: 12px;
            margin-top: 24px;
            padding: 24px;
            box-shadow: 0 3px 12px rgba(0,0,0,0.06);
            border-top: 3px solid #f59e0b;
        }
        
        .notes-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 16px;
            color: #f59e0b;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .notes-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            align-items: start;
        }
        
        .notes-text {
            font-size: 0.95rem;
            line-height: 1.7;
            color: #374151;
        }
        
        .notes-images {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .bw-image {
            width: 100%;
            height: 120px;
            background: #f7f7f7;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            color: #6b7280;
            filter: grayscale(100%);
            position: relative;
            overflow: hidden;
            text-align: center;
            padding: 12px;
        }
        
        .bw-image::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, #f3f4f6 25%, transparent 25%),
                         linear-gradient(-45deg, #f3f4f6 25%, transparent 25%),
                         linear-gradient(45deg, transparent 75%, #f3f4f6 75%),
                         linear-gradient(-45deg, transparent 75%, #f3f4f6 75%);
            background-size: 15px 15px;
            background-position: 0 0, 0 7.5px, 7.5px -7.5px, -7.5px 0px;
            opacity: 0.1;
        }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .slide-modal {
                 padding-left: 0 !important;
             }
            .slide-modal.sidebar-open {
                 padding-left: 0;
             }
            
            .menu-toggle {
                 top: 12px;
                left: 12px;
                min-height: 48px;
                min-width: 48px;
                font-size: 1.2rem;
                border-radius: 8px;
            }
            
            .menu-toggle.sidebar-open {
                 left: 12px;
                 background: linear-gradient(135deg, #dc2626, #b91c1c);
                transform: none;
            }
            
            .sidebar {
                 width: 85vw;
                max-width: 320px;
                border-radius: 0 16px 16px 0;
                padding-top: 70px;
            }
            
            .slide-container {
                 width: 100vw;
                 height: 100vh;
                 border-radius: 0;
                 margin: 0;
            }
            
            .slide-header {
                padding: 16px 20px;
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .slide-title {
                font-size: 1.2rem;
                gap: 8px;
            }
            
            .slide {
                 padding: 20px 16px;
                 border-radius: 0;
                 margin: 0;
            }
            
            .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .test-materials {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .slide-navigation {
                 padding: 16px 20px;
                flex-wrap: wrap;
                gap: 12px;
            }
            
            .slide-progress {
                order: -1;
                width: 100%;
                justify-content: center;
                margin-bottom: 8px;
            }
            
            .ai-help-panel {
                width: calc(100vw - 40px);
                max-width: 320px;
                top: 70px;
                right: 10px;
                max-height: 400px;
            }

            .light-experiment, .heat-simulator, .conductor-game, .shadow-theater {
                padding: 20px 15px;
            }

            .heat-objects {
                flex-direction: column;
                gap: 20px;
                min-height: auto;
            }

            .heat-object {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }

            .notes-content {
                grid-template-columns: 1fr;
                gap: 16px;
            }
        }

        /* Small mobile phones */
        @media (max-width: 480px) {
            .light-experiment, .heat-simulator, .conductor-game, .shadow-theater {
                padding: 15px 10px;
            }

            .theater-screen {
                height: 150px;
            }

            .puppet {
                font-size: 2rem;
            }
        }

        /* Touch improvements */
        @media (hover: none) and (pointer: coarse) {
            .nav-btn:hover,
            .menu-toggle:hover,
            .ai-help-toggle:hover,
            .quiz-option:hover,
            .subtopic-btn:hover,
            .back-home-btn:hover,
            .ai-suggestion:hover {
                transform: none;
                box-shadow: inherit;
            }
            
            .nav-btn:active,
            .menu-toggle:active,
            .ai-help-toggle:active,
            .subtopic-btn:active,
            .back-home-btn:active,
            .ai-suggestion:active {
                transform: scale(0.98);
            }
        }
    </style>
</head>
<body>

<div class="sidebar-overlay" id="sidebar-overlay"></div>

<button class="menu-toggle" id="menu-toggle" onclick="toggleSidebar()">
    ‚ò∞
</button>

<div class="slide-modal" id="slide-modal">
    <div class="sidebar" id="sidebar">
        <!-- Subtopics will be rendered here -->
    </div>
    
    <div class="slide-container">
        <div class="slide-header">
            <span style="display:flex;align-items:center;">
                <h2 class="slide-title" style="margin:0;">
                    <span id="slide-icon">üí°</span>
                    <span id="slide-title-text">Light & Heat Systems</span>
                </h2>
            </span>
            <span style="display:flex;align-items:center;flex-wrap:wrap;gap:8px;">
                <div class="slide-counter" id="slide-counter" style="display:inline-block;">1 / 50</div>
                <a href="{{ url_for('learn', code='Primary4') }}"  class="back-home-btn">üè† Back to Home</a>
            </span>
        </div>
        
        <div class="slide-content" id="slide-content">
            <div class="main-slide-area" id="main-slide-area"></div>
        </div>
        
        <div class="slide-navigation">
            <div class="slide-progress" id="slide-progress"></div>
            <button class="nav-btn" id="prev-slide-btn" onclick="previousSlide()" disabled>‚Üê Previous</button>
            <button class="nav-btn" id="next-slide-btn" onclick="nextSlide()">Next ‚Üí</button>
        </div>
    </div>
</div>

<!-- AI Help Widget -->
<div class="ai-help-widget">
    <button class="ai-help-toggle" id="ai-help-toggle" onclick="toggleAIHelp()">ü§ñ</button>
    <div class="ai-help-panel" id="ai-help-panel">
        <div class="ai-help-header">
            <span>ü§ñ</span>
            <span>Light & Heat AI Assistant</span>
        </div>
        <div class="ai-help-content">
            <div class="ai-suggestions">
                <button class="ai-suggestion" onclick="askAI('How does light travel?')">How does light travel?</button>
                <button class="ai-suggestion" onclick="askAI('What creates shadows?')">What creates shadows?</button>
                <button class="ai-suggestion" onclick="askAI('How does heat transfer?')">How does heat transfer?</button>
                <button class="ai-suggestion" onclick="askAI('Help with experiment')">Help with experiment</button>
            </div>
            <div class="ai-chat-messages" id="ai-chat-messages">
                <div class="ai-message bot">
                    Hi! I'm your Light & Heat AI assistant. Ask me anything about how light travels, creates shadows, or how heat moves between objects! üí°üî•
                </div>
            </div>
            <div class="ai-input-area">
                <input type="text" class="ai-input" id="ai-input" placeholder="Ask me anything..." onkeypress="handleAIKeyPress(event)">
                <button class="ai-send-btn" onclick="sendAIMessage()">‚û§</button>
            </div>
        </div>
    </div>
</div>

<script>
// Slide data with all interactive features
const subtopicSections = [
    {
        title: "Introduction to Light & Heat Systems",
        subtopics: [
            { title: "What are Light & Heat Systems?", slideIndex: 0 },
            { title: "Light as Energy", slideIndex: 1 },
            { title: "Heat as Energy", slideIndex: 2 },
            { title: "Energy Transfer", slideIndex: 3 },
            { title: "Systems in Daily Life", slideIndex: 4 }
        ]
    },
    {
        title: "Light Systems",
        subtopics: [
            { title: "Properties of Light", slideIndex: 5 },
            { title: "Light Sources", slideIndex: 6 },
            { title: "How Light Travels", slideIndex: 7 },
            { title: "Interactive Light Experiment", slideIndex: 8 },
            { title: "Straight-Line Travel", slideIndex: 9 },
            { title: "Light Ray Diagrams", slideIndex: 10 },
            { title: "Shadows Formation", slideIndex: 11 },
            { title: "Shadow Theater", slideIndex: 12 },
            { title: "Types of Shadows", slideIndex: 13 },
            { title: "Shadow Size & Distance", slideIndex: 14 },
            { title: "Light Reflection", slideIndex: 15 },
            { title: "Mirrors & Reflection", slideIndex: 16 }
        ]
    },
    {
        title: "Interactive Light Activities",
        subtopics: [
            { title: "Virtual Light Lab", slideIndex: 17 },
            { title: "Shadow Puppet Game", slideIndex: 18 },
            { title: "Light Path Tracer", slideIndex: 19 },
            { title: "Reflection Explorer", slideIndex: 20 },
            { title: "Light Quiz Challenge", slideIndex: 21 }
        ]
    },
    {
        title: "Heat Systems",
        subtopics: [
            { title: "What is Heat?", slideIndex: 22 },
            { title: "Heat vs Temperature", slideIndex: 23 },
            { title: "Sources of Heat", slideIndex: 24 },
            { title: "Forms of Heat Energy", slideIndex: 25 },
            { title: "Heat Transfer Methods", slideIndex: 26 },
            { title: "Conduction", slideIndex: 27 },
            { title: "Interactive Heat Transfer", slideIndex: 28 },
            { title: "Convection", slideIndex: 29 },
            { title: "Radiation", slideIndex: 30 },
            { title: "Conductors", slideIndex: 31 },
            { title: "Insulators", slideIndex: 32 },
            { title: "Conductor vs Insulator Game", slideIndex: 33 }
        ]
    },
    {
        title: "Interactive Heat Activities",
        subtopics: [
            { title: "Heat Transfer Simulator", slideIndex: 34 },
            { title: "Conductor Testing Lab", slideIndex: 35 },
            { title: "Temperature Detective", slideIndex: 36 },
            { title: "Heat Source Explorer", slideIndex: 37 },
            { title: "Thermal Imaging Game", slideIndex: 38 },
            { title: "Heat Quiz Challenge", slideIndex: 39 }
        ]
    },
    {
        title: "Systems Integration",
        subtopics: [
            { title: "Light & Heat Together", slideIndex: 40 },
            { title: "Solar Energy Systems", slideIndex: 41 },
            { title: "Light Bulbs & Heat", slideIndex: 42 },
            { title: "Greenhouse Effect", slideIndex: 43 },
            { title: "Daily Life Applications", slideIndex: 44 }
        ]
    },
    {
        title: "Assessment & Review",
        subtopics: [
            { title: "Light Systems Review", slideIndex: 45 },
            { title: "Heat Systems Review", slideIndex: 46 },
            { title: "Final Quiz 1", slideIndex: 47 },
            { title: "Final Quiz 2", slideIndex: 48 },
            { title: "Master Challenge", slideIndex: 49 }
        ]
    }
];

const slides = [
    {
        content: `
            <div class="slide-icon">üí°</div>
            <h2>What are Light & Heat Systems?</h2>
            <div class="video-container">
                <div class="video-placeholder">
                    üé¨ Educational Video: Introduction to Light & Heat Energy Systems
                </div>
            </div>
            <p>Light and heat are forms of energy that work in systems all around us. They help us see, keep us warm, and power many things we use every day!</p>
            <div class="system-diagram">
                <h4>Energy Systems Around Us:</h4>
                <ul>
                    <li>‚òÄÔ∏è <strong>The Sun:</strong> Our biggest source of light and heat energy</li>
                    <li>üí° <strong>Light Bulbs:</strong> Convert electricity into light (and some heat)</li>
                    <li>üî• <strong>Fire:</strong> Chemical energy becomes light and heat</li>
                    <li>üå°Ô∏è <strong>Heating Systems:</strong> Move heat energy to warm our homes</li>
                </ul>
            </div>
            <div class="fun-fact">
                <h4>üåü Amazing Fact!</h4>
                <p>Light from the Sun travels 93 million miles to reach Earth in just 8 minutes and 20 seconds!</p>
            </div>
        `,
        notes: {
            text: "Light and heat are fundamental forms of energy that students encounter daily. Understanding these as systems helps students see how energy moves and transforms in predictable ways throughout our world.",
            images: ["üí° Light sources", "üî• Heat sources"]
        }
    },
    {
        content: `
            <h3>Light as Energy</h3>
            <p>Light is a form of energy that travels in waves and helps us see the world around us!</p>
            <div class="grid-3">
                <div class="info-card yellow-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">‚òÄÔ∏è</div>
                    <h4>Natural Light</h4>
                    <p>Sun, stars, fire, lightning</p>
                </div>
                <div class="info-card orange-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">üí°</div>
                    <h4>Artificial Light</h4>
                    <p>Light bulbs, flashlights, screens</p>
                </div>
                <div class="info-card blue-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">üåà</div>
                    <h4>Light Colors</h4>
                    <p>White light contains all colors</p>
                </div>
            </div>
            <div class="process-flow">
                <h4>How Light Helps Us:</h4>
                <div class="process-step">
                    <div class="step-number">üëÅÔ∏è</div>
                    <div class="step-content">
                        <strong>Vision</strong>
                        <p>Light enters our eyes so we can see objects and colors</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">üì∏</div>
                    <div class="step-content">
                        <strong>Photography</strong>
                        <p>Cameras capture light to create pictures</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">üå±</div>
                    <div class="step-content">
                        <strong>Plant Growth</strong>
                        <p>Plants use light energy to make food through photosynthesis</p>
                    </div>
                </div>
            </div>
        `,
        notes: {
            text: "Light energy is electromagnetic radiation that our eyes can detect. It travels at incredible speed and behaves both as waves and particles, though Primary 4 students focus on its practical properties and effects.",
            images: ["üåà Light spectrum", "üëÅÔ∏è How we see"]
        }
    },
    {
        content: `
            <h3>Heat as Energy</h3>
            <p>Heat is energy that makes things warm and can move from one object to another!</p>
            <div class="grid-2">
                <div class="info-card red-card">
                    <h4>üî• What Heat Does:</h4>
                    <ul>
                        <li>Makes objects warmer</li>
                        <li>Can change states of matter</li>
                        <li>Makes molecules move faster</li>
                        <li>Flows from hot to cold</li>
                    </ul>
                </div>
                <div class="info-card orange-card">
                    <h4>üå°Ô∏è Heat Sources:</h4>
                    <ul>
                        <li>Sun (solar energy)</li>
                        <li>Fire (burning fuel)</li>
                        <li>Electricity (heaters)</li>
                        <li>Friction (rubbing)</li>
                        <li>Our bodies (metabolism)</li>
                    </ul>
                </div>
            </div>
            <div class="system-diagram">
                <h4>Heat Energy in Action:</h4>
                <ul>
                    <li>üç≥ <strong>Cooking:</strong> Heat changes food from raw to cooked</li>
                    <li>üè† <strong>Heating Homes:</strong> Heat systems keep us comfortable</li>
                    <li>üöó <strong>Car Engines:</strong> Heat from fuel creates motion</li>
                    <li>‚òï <strong>Hot Drinks:</strong> Heat makes liquids warm and steamy</li>
                </ul>
            </div>
            <div class="fun-fact">
                <h4>üå°Ô∏è Cool Fact!</h4>
                <p>Your body produces about as much heat as a 100-watt light bulb when you're resting!</p>
            </div>
        `,
        notes: {
            text: "Heat is thermal energy in motion. It always flows from warmer objects to cooler ones until they reach the same temperature. This fundamental principle drives many natural processes and human technologies.",
            images: ["üî• Heat sources", "üå°Ô∏è Temperature measurement"]
        }
    },
    {
        content: `
            <h3>Energy Transfer</h3>
            <p>Both light and heat energy can move from one place to another in different ways!</p>
            <div class="process-flow">
                <h4>How Light Energy Travels:</h4>
                <div class="process-step">
                    <div class="step-number">‚û°Ô∏è</div>
                    <div class="step-content">
                        <strong>Straight Lines</strong>
                        <p>Light travels in straight lines called rays</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">‚ö°</div>
                    <div class="step-content">
                        <strong>Very Fast</strong>
                        <p>Light is the fastest thing in the universe</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">ü™û</div>
                    <div class="step-content">
                        <strong>Can Bounce</strong>
                        <p>Light reflects off mirrors and shiny surfaces</p>
                    </div>
                </div>
            </div>
            <div class="grid-3">
                <div class="info-card red-card">
                    <h4>üî• Conduction</h4>
                    <p>Heat moves through touching objects (like a metal spoon in hot soup)</p>
                </div>
                <div class="info-card orange-card">
                    <h4>üåä Convection</h4>
                    <p>Heat moves through liquids and gases (like warm air rising)</p>
                </div>
                <div class="info-card yellow-card">
                    <h4>‚òÄÔ∏è Radiation</h4>
                    <p>Heat travels through space (like warmth from the Sun)</p>
                </div>
            </div>
        `,
        notes: {
            text: "Energy transfer is fundamental to understanding how light and heat systems work. Light travels through electromagnetic radiation, while heat can transfer through conduction, convection, and radiation.",
            images: ["‚û°Ô∏è Light rays", "üîÑ Heat transfer"]
        }
    },
    {
        content: `
            <h3>Systems in Daily Life</h3>
            <p>Light and heat systems are everywhere in our daily lives, working together to help us!</p>
            <div class="grid-4">
                <div class="info-card yellow-card">
                    <div style="font-size: 1.5rem; margin-bottom: 8px;">üè†</div>
                    <h4>Home Systems</h4>
                    <p>Lights, heaters, ovens, windows</p>
                </div>
                <div class="info-card orange-card">
                    <div style="font-size: 1.5rem; margin-bottom: 8px;">üöó</div>
                    <h4>Transportation</h4>
                    <p>Headlights, engines, air conditioning</p>
                </div>
                <div class="info-card red-card">
                    <div style="font-size: 1.5rem; margin-bottom: 8px;">üè´</div>
                    <h4>School Systems</h4>
                    <p>Classroom lights, heating, computers</p>
                </div>
                <div class="info-card blue-card">
                    <div style="font-size: 1.5rem; margin-bottom: 8px;">üå±</div>
                    <h4>Nature Systems</h4>
                    <p>Photosynthesis, weather, seasons</p>
                </div>
            </div>
            <div class="system-diagram">
                <h4>Working Together:</h4>
                <ul>
                    <li>üí° <strong>Light Bulbs:</strong> Use electricity to make light AND heat</li>
                    <li>‚òÄÔ∏è <strong>Solar Panels:</strong> Convert light energy into electricity</li>
                    <li>üî• <strong>Campfires:</strong> Produce both light and heat from burning wood</li>
                    <li>üå°Ô∏è <strong>Thermometers:</strong> Use heat to measure temperature</li>
                </ul>
            </div>
            <div class="fun-fact">
                <h4>ü§î Think About It!</h4>
                <p>Can you think of something that produces light but no heat? Or heat but no light? Most things that make light also make some heat!</p>
            </div>
        `,
        notes: {
            text: "Understanding light and heat systems in daily life helps students connect scientific concepts to their experiences. This foundation prepares them for more detailed exploration of each system's properties.",
            images: ["üè† Home systems", "üåç Natural systems"]
        }
    },
    {
        content: `
            <h3>Properties of Light</h3>
            <p>Light has special properties that make it behave in predictable ways!</p>
            <div class="grid-2">
                <div class="info-card yellow-card">
                    <h4>‚ú® Light Properties:</h4>
                    <ul>
                        <li><strong>Travels in straight lines</strong></li>
                        <li><strong>Travels very fast</strong></li>
                        <li><strong>Can be reflected (bounced)</strong></li>
                        <li><strong>Can be absorbed</strong></li>
                        <li><strong>Can pass through some materials</strong></li>
                    </ul>
                </div>
                <div class="info-card blue-card">
                    <h4>üîç Materials & Light:</h4>
                    <ul>
                        <li><strong>Transparent:</strong> Light passes through (glass, water)</li>
                        <li><strong>Translucent:</strong> Some light passes through (frosted glass)</li>
                        <li><strong>Opaque:</strong> No light passes through (wood, metal)</li>
                    </ul>
                </div>
            </div>
            <div class="process-flow">
                <h4>What Happens When Light Hits Objects:</h4>
                <div class="process-step">
                    <div class="step-number">ü™û</div>
                    <div class="step-content">
                        <strong>Reflection</strong>
                        <p>Light bounces off shiny surfaces like mirrors</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">üï≥Ô∏è</div>
                    <div class="step-content">
                        <strong>Absorption</strong>
                        <p>Dark objects absorb light and may get warmer</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">üîç</div>
                    <div class="step-content">
                        <strong>Transmission</strong>
                        <p>Light passes through transparent materials like glass</p>
                    </div>
                </div>
            </div>
            <div class="fun-fact">
                <h4>üåà Rainbow Magic!</h4>
                <p>White light is actually made up of all colors mixed together. When light passes through a prism or water droplets, we can see all the colors separated into a rainbow!</p>
            </div>
        `,
        notes: {
            text: "Light properties are fundamental to understanding how we see and how shadows form. The behavior of light with different materials determines whether objects are visible, transparent, or create shadows.",
            images: ["üí° Light behavior", "üåà Light spectrum"]
        }
    },
    {
        content: `
            <h3>Light Sources</h3>
            <p>Light comes from many different sources, both natural and artificial!</p>
            <div class="grid-3">
                <div class="info-card yellow-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">‚òÄÔ∏è</div>
                    <h4>The Sun</h4>
                    <p>Our main source of natural light and energy</p>
                </div>
                <div class="info-card orange-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">üî•</div>
                    <h4>Fire</h4>
                    <p>Candles, campfires, gas flames</p>
                </div>
                <div class="info-card red-card">
                    <div style="font-size: 2rem; margin-bottom: 10px;">‚ö°</div>
                    <h4>Lightning</h4>
                    <p>Natural electrical discharge in storms</p>
                </div>
            </div>
            <div class="grid-4" style="margin-top: 20px;">
                <div class="info-card blue-card">
                    <div style="font-size: 1.5rem; margin-bottom: 8px;">üí°</div>
                    <h4>Light Bulbs</h4>
                    <p>LED, fluorescent, incandescent</p>
                </div>
                <div class="info-card purple-card">
                    <div style="font-size: 1.5rem; margin-bottom: 8px;">üî¶</div>
                    <h4>Flashlights</h4>
                    <p>Portable battery-powered lights</p>
                </div>
                <div class="info-card green-card">
                    <div style="font-size: 1.5rem; margin-bottom: 8px;">üì±</div>
                    <h4>Screens</h4>
                    <p>TV, computer, phone displays</p>
                </div>
                <div class="info-card pink-card">
                    <div style="font-size: 1.5rem; margin-bottom: 8px;">üåü</div>
                    <h4>Stars</h4>
                    <p>Distant suns that produce light</p>
                </div>
            </div>
            <div class="system-diagram">
                <h4>Primary vs Secondary Light Sources:</h4>
                <ul>
                    <li>üåü <strong>Primary Sources:</strong> Make their own light (Sun, fire, light bulbs)</li>
                    <li>üåô <strong>Secondary Sources:</strong> Reflect light from other sources (Moon, mirrors)</li>
                </ul>
            </div>
        `,
        notes: {
            text: "Understanding different light sources helps students recognize that light must come from somewhere to illuminate objects. This concept is crucial for understanding shadows and visibility.",
            images: ["‚òÄÔ∏è Natural sources", "üí° Artificial sources"]
        }
    },
    {
        content: `
            <h3>How Light Travels</h3>
            <p>Light travels in straight lines called rays, and this creates many interesting effects!</p>
            <div class="light-experiment" id="light-travel-demo">
                <h4 style="text-align: center; margin-bottom: 20px;">Interactive Light Travel Demo</h4>
                <div style="position: relative; height: 200px;">
                    <!-- Light source -->
                    <div class="light-source" id="demo-light-source" style="left: 50px; top: 80px;" onclick="toggleLightSource()"></div>
                    
                    <!-- Light rays -->
                    <div class="light-ray" id="ray1" style="left: 90px; top: 99px; width: 150px; transform: rotate(0deg);"></div>
                    <div class="light-ray" id="ray2" style="left: 90px; top: 99px; width: 140px; transform: rotate(15deg);"></div>
                    <div class="light-ray" id="ray3" style="left: 90px; top: 99px; width: 140px; transform: rotate(-15deg);"></div>
                    
                    <!-- Objects -->
                    <div class="shadow-object" id="demo-object" style="left: 300px; top: 70px; width: 40px; height: 60px;"></div>
                    
                    <!-- Instructions -->
                    <div style="position: absolute; bottom: 10px; left: 10px; font-size: 0.9rem; color: #fbbf24;">
                        Click the light source to turn it on/off!
                    </div>
                </div>
                
                <div class="experiment-controls">
                    <button class="experiment-btn" onclick="toggleLightSource()">üí° Toggle Light</button>
                    <button class="experiment-btn" onclick="resetLightDemo()">üîÑ Reset</button>
                </div>
            </div>
            <div class="process-flow">
                <h4>Light Travel Facts:</h4>
                <div class="process-step">
                    <div class="step-number">‚û°Ô∏è</div>
                    <div class="step-content">
                        <strong>Straight Lines</strong>
                        <p>Light always travels in perfectly straight lines</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">‚ö°</div>
                    <div class="step-content">
                        <strong>Speed of Light</strong>
                        <p>Light travels at 300,000 kilometers per second!</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">üö´</div>
                    <div class="step-content">
                        <strong>Blocked by Objects</strong>
                        <p>When light hits opaque objects, it cannot pass through</p>
                    </div>
                </div>
            </div>
        `,
        notes: {
            text: "The straight-line travel of light is fundamental to understanding shadows, reflection, and vision. This property allows us to predict where light will go and what effects it will create.",
            images: ["‚û°Ô∏è Light rays", "üîç Light paths"]
        }
    },
    {
        content: `
            <h3>Interactive Light Experiment</h3>
            <p>Explore how light behaves by moving the light source and objects around!</p>
            <div class="light-experiment" id="interactive-light-lab">
                <h4 style="text-align: center; margin-bottom: 20px;">üî¨ Virtual Light Laboratory</h4>
                <div style="position: relative; height: 250px; border: 2px solid #fbbf24; border-radius: 10px; background: rgba(0,0,0,0.1);">
                    <!-- Moveable light source -->
                    <div class="light-source active" id="lab-light-source" style="left: 30px; top: 100px;" onmousedown="startDragLight(event)" ontouchstart="startDragLight(event)"></div>
                    
                    <!-- Multiple light rays -->
                    <div class="light-ray visible" id="lab-ray1" style="left: 70px; top: 119px; width: 200px; transform: rotate(0deg);"></div>
                    <div class="light-ray visible" id="lab-ray2" style="left: 70px; top: 119px; width: 180px; transform: rotate(10deg);"></div>
                    <div class="light-ray visible" id="lab-ray3" style="left: 70px; top: 119px; width: 180px; transform: rotate(-10deg);"></div>
                    <div class="light-ray visible" id="lab-ray4" style="left: 70px; top: 119px; width: 160px; transform: rotate(20deg);"></div>
                    <div class="light-ray visible" id="lab-ray5" style="left: 70px; top: 119px; width: 160px; transform: rotate(-20deg);"></div>
                    
                    <!-- Moveable objects -->
                    <div class="shadow-object" id="lab-object1" style="left: 200px; top: 80px; width: 30px; height: 80px;" onmousedown="startDragObject(event, 'lab-object1')" ontouchstart="startDragObject(event, 'lab-object1')">üìö</div>
                    <div class="shadow-object" id="lab-object2" style="left: 300px; top: 120px; width: 50px; height: 40px;" onmousedown="startDragObject(event, 'lab-object2')" ontouchstart="startDragObject(event, 'lab-object2')">‚öΩ</div>
                    
                    <!-- Shadows -->
                    <div class="shadow-cast" id="shadow1" style="left: 230px; top: 80px; width: 60px; height: 80px;"></div>
                    <div class="shadow-cast" id="shadow2" style="left: 350px; top: 120px; width: 100px; height: 40px;"></div>
                    
                    <!-- Instructions -->
                    <div style="position: absolute; bottom: 10px; left: 10px; font-size: 0.8rem; color: #fbbf24;">
                        Drag the light source and objects to see how shadows change!
                    </div>
                </div>
                
                <div class="experiment-controls">
                    <button class="experiment-btn" onclick="addObject()">‚ûï Add Object</button>
                    <button class="experiment-btn" onclick="changeBackground()">üé® Change Background</button>
                    <button class="experiment-btn" onclick="resetLightLab()">üîÑ Reset Lab</button>
                </div>
                
                <div class="fun-fact" style="margin-top: 20px;">
                    <h4>üß™ Experiment Tips!</h4>
                    <p>Try moving the light closer and farther from objects. Notice how the shadow size changes! What happens when you put one object behind another?</p>
                </div>
            </div>
        `,
        notes: {
            text: "Interactive experiments help students discover light behavior through hands-on exploration. This virtual lab allows safe experimentation with light properties and shadow formation.",
            images: ["üî¨ Light experiments", "üéØ Interactive learning"]
        }
    },
    {
        content: `
            <h3>Straight-Line Travel</h3>
            <p>Light always travels in perfectly straight lines, which we can prove with simple experiments!</p>
            <div class="system-diagram">
                <h4>Evidence for Straight-Line Travel:</h4>
                <ul>
                    <li>üî¶ <strong>Flashlight Beams:</strong> Create straight beams of light</li>
                    <li>üåÖ <strong>Sunbeams:</strong> Sun rays through clouds appear straight</li>
                    <li>üëÅÔ∏è <strong>Line of Sight:</strong> We can only see objects in straight lines</li>
                    <li>üìè <strong>Laser Pointers:</strong> Create perfectly straight lines of light</li>
                </ul>
            </div>
            <div class="grid-2">
                <div class="info-card yellow-card">
                    <h4>üéØ Why This Matters:</h4>
                    <ul>
                        <li>Helps us predict where shadows will form</li>
                        <li>Explains how we see objects</li>
                        <li>Shows why we can't see around corners</li>
                        <li>Helps us aim flashlights and cameras</li>
                    </ul>
                </div>
                <div class="info-card blue-card">
                    <h4>üß™ Simple Test:</h4>
                    <p>Hold three pieces of paper with holes in a line. You can only see through all three holes when they're perfectly aligned - proving light travels straight!</p>
                </div>
            </div>
            <div class="process-flow">
                <h4>Light Ray Rules:</h4>
                <div class="process-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <strong>Always Straight</strong>
                        <p>Light never curves or bends on its own</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <strong>Travels Outward</strong>
                        <p>Light spreads out in all directions from a source</p>
                    </div>
                </div>
                <div class="process-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <strong>Can Be Blocked</strong>
                        <p>Opaque objects stop light and create shadows</p>
                    </div>
                </div>
            </div>
        `,
        notes: {
            text: "The straight-line travel of light is a fundamental principle that explains many everyday phenomena. This concept is essential for understanding shadows, vision, and optical instruments.",
            images: ["üìè Straight light rays", "üî¶ Light beams"]
        }
    },
    {
        content: `
            <h3>Light Ray Diagrams</h3>
            <p>Scientists use diagrams with arrows to show how light travels. Let's learn to draw light rays!</p>
            <div class="light-experiment" id="ray-diagram-demo">
                <h4 style="text-align: center; margin-bottom: 20px;">üìê Interactive Ray Diagram</h4>
                <div style="position: relative; height: 200px; background: white; border: 2px solid #f59e0b; border-radius: 10px;">
                    <!-- Light source -->
                    <div style="position: absolute; left: 50px; top: 90px; width: 20px; height: 20px; background: #fbbf24; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.8rem;">üí°</div>
                    
                    <!-- Ray arrows -->
                    <svg style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="#f59e0b" />
                            </marker>
                        </defs>
                        <line x1="70" y1="100" x2="200" y2="100" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrowhead)" />
                        <line x1="70" y1="100" x2="180" y2="60" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrowhead)" />
                        <line x1="70" y1="100" x2="180" y2="140" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrowhead)" />
                    </svg>
                    
                    <!-- Object -->
                    <div style="position: absolute; left: 250px; top: 70px; width: 30px; height: 60px; background: #374151; border-radius: 5px;"></div>
                    
                    <!-- Labels -->
                    <div style="position: absolute; left: 30px; top: 110px; font-size: 0.8rem; color: #f59e0b; font-weight: bold;">Light Source</div>
                    <div style="position: absolute; left: 120px; top: 80px; font-size: 0.8rem; color: #f59e0b;">Light Rays</div>
                    <div style="position: absolute; left: 230px; top: 140px; font-size: 0.8rem; color: #374151; font-weight: bold;">Object</div>
                </div>
                
                <div class="experiment-controls">
                    <button class="experiment-btn" onclick="showRayRules()">üìè Ray Rules</button>
                    <button class="experiment-btn" onclick="drawMoreRays()">‚ûï More Rays</button>
                    <button class="experiment-btn" onclick="hideRays()">üëÅÔ∏è Hide Rays</button>
                </div>
            </div>
            <div class="grid-2">
                <div class="info-card blue-card">
                    <h4>üìê Drawing Light Rays:</h4>
                    <ul>
                        <li>Use straight lines with arrows</li>
                        <li>Arrows show direction of light</li>
                        <li>Start from the light source</li>
                        <li>Show where light hits objects</li>
                    </ul>
                </div>
                <div class="info-card green-card">
                    <h4>üéØ Ray Diagram Uses:</h4>
                    <ul>
                        <li>Predict shadow locations</li>
                        <li>Design lighting systems</li>
                        <li>Understand how mirrors work</li>
                        <li>Plan photography setups</li>
                    </ul>
                </div>
            </div>
        `,
        notes: {
            text: "Ray diagrams are scientific tools that help visualize light behavior. Learning to draw and interpret these diagrams builds scientific thinking skills and prepares students for more advanced optics concepts.",
            images: ["üìê Ray diagrams", "üîç Light analysis"]
        }
    },
    {
        content: `
            <h3>Shadows Formation</h3>
            <p>Shadows form when light is blocked by opaque objects. Let's explore how shadows are created!</p>
            <div class="light-experiment" id="shadow-formation-demo">
                <h4 style="text-align: center; margin-bottom: 20px;">üåë Shadow Formation Demo</h4>
                <div style="position: relative; height: 220px; background: linear-gradient(to bottom, #1e1b4b 0%, #312e81 50%, #f3f4f6 50%, #f3f4f6 100%);">
                    <!-- Light source -->
                    <div class="light-source active" id="shadow-light" style="left: 80px; top: 40px;"></div>
                    
                    <!-- Light rays -->
                    <div class="light-ray visible" id="shadow-ray1" style="left: 120px; top: 59px; width: 100px; transform: rotate(20deg);"></div>
                    <div class="light-ray visible" id="shadow-ray2" style="left: 120px; top: 59px; width: 120px; transform: rotate(0deg);"></div>
                    <div class="light-ray visible" id="shadow-ray3" style="left: 120px; top: 59px; width: 100px; transform: rotate(-20deg);"></div>
                    
                    <!-- Object casting shadow -->
                    <div class="shadow-object" id="shadow-caster" style="left: 200px; top: 30px; width: 40px; height: 80px; background: #dc2626;">üè†</div>
                    
                    <!-- Shadow on ground -->
                    <div style="position: absolute; left: 250px; bottom: 0; width: 80px; height: 110px; background: rgba(0,0,0,0.6); border-radius: 10px;"></div>
                    
                    <!-- Ground line -->
                    <div style="position: absolute; bottom: 110px; left: 0; right: 0; height: 2px; background: #374151;"></div>
                    
                    <!-- Labels -->
                    <div style="position: absolute; left: 60px; top: 10px; font-size: 0.8rem; color: #fbbf24;">Light Source</div>
                    <div style="position: absolute; left: 180px; top: 10px; font-size: 0.8rem; color: #dc2626;">Object</div>
                    <div style="position: absolute; left: 270px; bottom: 50px; font-size: 0.8rem; color: white;">Shadow</div>
                </div>
                
                <div class="experiment-controls">
                    <button class="experiment-btn" onclick="moveLightUp()">‚¨ÜÔ∏è Move Light Up</button>
                    <button class="experiment-btn" onclick="moveLightDown()">‚¨áÔ∏è Move Light Down</button>
                    <button class="experiment-btn" onclick="changeShadowObject()">üîÑ Change Object</button>
                </div>
            </div>
            <div class="system-diagram">
                <h4>How Shadows Form:</h4>
                <ul>
                    <li>üí° <strong>Light Source:</strong> Produces light rays in all directions</li>
                    <li>üö´ <strong>Opaque Object:</strong> Blocks some of the light rays</li>
                    <li>üåë <strong>Shadow Area:</strong> Region where light cannot reach</li>
                    <li>üìê <strong>Straight Lines:</strong> Shadow edges follow light ray paths</li>
                </ul>
            </div>
        `,
        notes: {
            text: "Shadow formation demonstrates the straight-line travel of light and the concept of light being blocked by opaque materials. Understanding shadows helps students predict and explain everyday light phenomena.",
            images: ["üåë Shadow formation", "üìê Light blocking"]
        }
    },
    {
        content: `
            <h3>Shadow Theater</h3>
            <p>Create your own shadow puppet show and learn how shadows change with light position!</p>
            <div class="shadow-theater" id="shadow-theater-stage">
                <h4 style="text-align: center; margin-bottom: 20px;">üé≠ Interactive Shadow Theater</h4>
                
                <!-- Theater screen -->
                <div class="theater-screen" id="theater-screen">
                    <!-- Light source -->
                    <div class="theater-light" id="theater-light" style="left: 50px;"></div>
                    
                    <!-- Puppets -->
                    <div class="puppet" id="puppet1" style="left: 150px;" onmousedown="startDragPuppet(event, 'puppet1')" ontouchstart="startDragPuppet(event, 'puppet1')">üê∞</div>
                    <div class="puppet" id="puppet2" style="left: 200px;" onmousedown="startDragPuppet(event, 'puppet2')" ontouchstart="startDragPuppet(event, 'puppet2')">ü¶ã</div>
                    <div class="puppet" id="puppet3" style="left: 250px;" onmousedown="startDragPuppet(event, 'puppet3')" ontouchstart="startDragPuppet(event, 'puppet3')">üå≥</div>
                    
                    <!-- Puppet shadows -->
                    <div class="puppet-shadow" id="shadow-puppet1" style="left: 180px; width: 60px; height: 40px;"></div>
                    <div class="puppet-shadow" id="shadow-puppet2" style="left: 230px; width: 50px; height: 35px;"></div>
                    <div class="puppet-shadow" id="shadow-puppet3" style="left: 280px; width: 80px; height: 60px;"></div>
                </div>
                
                <div class="puppet-controls">
                    <button class="experiment-btn" onclick="moveLight('left')">‚¨ÖÔ∏è Light Left</button>
                    <button class="experiment-btn" onclick="moveLight('right')">‚û°Ô∏è Light Right</button>
                    <button class="experiment-btn" onclick="addPuppet()">üé≠ Add Puppet</button>
                    <button class="experiment-btn" onclick="startShow()">‚ñ∂Ô∏è Start Show</button>
                    <button class="experiment-btn" onclick="resetTheater()">üîÑ Reset</button>
                </div>
                
                <div class="fun-fact" style="margin-top: 20px;">
                    <h4>üé™ Theater Tips!</h4>
                    <p>Drag the puppets around the screen! Notice how their shadows change size and position when you move them closer to or farther from the light.</p>
                </div>
            </div>
        `,
        notes: {
            text: "Shadow theater combines learning with creativity, allowing students to explore shadow properties through play. This hands-on activity reinforces concepts about light sources, object distance, and shadow size relationships.",
            images: ["üé≠ Shadow puppets", "üé™ Creative learning"]
        }
    },
    {
        content: `
            <h3>Types of Shadows</h3>
            <p>Not all shadows are the same! There are different types depending on the light source and objects.</p>
            <div class="grid-2">
                <div class="info-card gray-card">
                    <h4>üåë Umbra (Dark Shadow)</h4>
                    <p>The darkest part of a shadow where no light reaches. This happens when light is completely blocked.</p>
                </div>
                <div class="info-card blue-card">
                    <h4>üåò Penumbra (Partial Shadow)</h4>
                    <p>The lighter part of a shadow where some light reaches. This creates a fuzzy edge around shadows.</p>
                </div>
            </div>
            <div class="light-experiment" id="shadow-types-demo">
                <h4 style="text-align: center; margin-bottom: 20px;">üîç Shadow Types Explorer</h4>
                <div style="position: relative; height: 180px; background: linear-gradient(to bottom, #1e1b4b 0%, #f3f4f6 60%, #f3f4f6 100%);">
                    <!-- Large light source -->
                    <div style="position: absolute; left: 50px; top: 30px; width: 60px; height: 60px; background: radial-gradient(circle, #fbbf24 0%, #f59e0b 70%); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">‚òÄÔ∏è</div>
                    
                    <!-- Object -->
                    <div style="position: absolute; left: 200px; top: 40px; width: 30px; height: 40px; background: #dc2626; border-radius: 5px;"></div>
                    
                    <!-- Umbra (dark shadow) -->
                    <div style="position: absolute; left: 240px; bottom: 0; width: 40px; height: 70px; background: rgba(0,0,0,0.8); border-radius: 5px;"></div>
                    
                    <!-- Penumbra (light shadow) -->
                    <div style="position: absolute; left: 220px; bottom: 0; width: 80px; height: 70px; background: rgba(0,0,0,0.3); border-radius: 10px;"></div>
                    
                    <!-- Labels -->
                    <div style="position: absolute; left: 30px; top: 100px; font-size: 0.8rem; color: #fbbf24;">Large Light Source</div>
                    <div style="position: absolute; left: 200px; bottom: 80px; font-size: 0.8rem; color: white;">Penumbra</div>
                    <div style="position: absolute; left: 245px; bottom: 80px; font-size: 0.8rem; color: white;">Umbra</div>
                </div>
                
                <div class="experiment-controls">
                    <button class="experiment-btn" onclick="toggleLightSize()">üîÑ Change Light Size</button>
                    <button class="experiment-btn" onclick="showShadowTypes()">üîç Show Types</button>
                </div>
            </div>
            <div class="system-diagram">
                <h4>Shadow Characteristics:</h4>
                <ul>
                    <li>üî¶ <strong>Point Light Source:</strong> Creates sharp, clear shadows</li>
                    <li>‚òÄÔ∏è <strong>Large Light Source:</strong> Creates fuzzy shadows with penumbra</li>
                    <li>üìè <strong>Distance Matters:</strong> Closer objects create larger shadows</li>
                    <li>üåÖ <strong>Multiple Lights:</strong> Create multiple overlapping shadows</li>
                </ul>
            </div>
        `,
        notes: {
            text: "Understanding different shadow types helps students recognize why some shadows are sharp while others are fuzzy. This concept connects to real-world observations of shadows throughout the day.",
            images: ["üåë Shadow types", "üîç Shadow analysis"]
        }
    },
    {
        content: `
            <h3>Shadow Size & Distance</h3>
            <p>The size of shadows changes based on how far objects are from the light source and the screen!</p>
            <div class="light-experiment" id="shadow-size-demo">
                <h4 style="text-align: center; margin-bottom: 20px;">üìè Shadow Size Explorer</h4>
                <div style="position: relative; height: 200px; background: linear-gradient(to bottom, #1e1b4b 0%, #f3f4f6 50%, #f3f4f6 100%);">
                    <!-- Fixed light source -->
                    <div class="light-source active" style="left: 50px; top: 70px;"></div>
                    
                    <!-- Moveable object -->
                    <div class="shadow-object" id="size-demo-object" style="left: 150px; top: 60px; width: 30px; height: 40px; cursor: pointer;" onclick="moveObjectCloser()">üì¶</div>
                    
                    <!-- Shadow that changes size -->
                    <div id="size-demo-shadow" style="position: absolute; right: 50px; bottom: 0; width: 60px; height: 80px; background: rgba(0,0,0,0.7); border-radius: 5px; transition: all 0.5s ease;"></div>
                    
                    <!-- Screen -->
                    <div style="position: absolute; right: 30px; top: 0; bottom: 0; width: 4px; background: #374151;"></div>
                    
                    <!-- Distance markers -->
                    <div style="position: absolute; left: 100px; bottom: 10px; font-size: 0.8rem; color: #fbbf24;">Close = Big Shadow</div>
                    <div style="position: absolute; left: 200px; bottom: 10px; font-size: 0.8rem; color: #fbbf24;">Far = Small Shadow</div>
                </div>
                
                <div class="experiment-controls">
                    <button class="experiment-btn" onclick="moveObjectCloser()">‚¨ÖÔ∏è Move Closer</button>
                    <button class="experiment-btn" onclick="moveObjectFarther()">‚û°Ô∏è Move Farther</button>
                    <button class="experiment-btn" onclick="resetSizeDemo()">üîÑ Reset</button>
                </div>
            </div>
            <div class="grid-2">
                <div class="info-card yellow-card">
                    <h4>üìê Shadow Size Rules:</h4>
                    <ul>
                        <li><strong>Closer to Light:</strong> Bigger shadow</li>
                        <li><strong>Farther from Light:</strong> Smaller shadow</li>
                        <li><strong>Closer to Screen:</strong> Smaller shadow</li>
                        <li><strong>Farther from Screen:</strong> Bigger shadow</li>
                    </ul>
                </div>
                <div class="info-card blue-card">
                    <h4>üåç Real-World Examples:</h4>
                    <ul>
                        <li>Your shadow is longest at sunrise/sunset</li>
                        <li>Shadow is shortest at noon</li>
                        <li>Flashlight shadows change as you move</li>
                        <li>Movie projectors use this principle</li>
                    </ul>
                </div>
            </div>
            <div class="fun-fact">
                <h4>üé¨ Movie Magic!</h4>
                <p>Movie projectors work by shining light through a small film image to create a huge image on the screen - just like making a giant shadow!</p>
            </div>
        `,
        notes: {
            text: "The relationship between object distance and shadow size demonstrates geometric principles and helps students understand perspective and proportion in the physical world.",
            images: ["üìè Shadow measurements", "üé¨ Projection principles"]
        }
    },
    {
        content: `
            <h3>Light Reflection</h3>
            <p>When light hits shiny surfaces, it bounces back in a predictable way called reflection!</p>
            <div class="light-experiment" id="reflection-demo">
                <h4 style="text-align: center; margin-bottom: 20px;">ü™û Reflection Explorer</h4>
                <div style="position: relative; height: 200px; background: #1e1b4b;">
                    <!-- Light source -->
                    <div class="light-source active" style="left: 50px; top: 50px;"></div>
                    
                    <!-- Incident ray -->
                    <div class="light-ray visible" style="left: 90px; top: 69px; width: 100px; transform: rotate(30deg);"></div>
                    
                    <!-- Mirror -->
                    <div style="position: absolute; left: 180px; top: 80px; width: 8px; height: 80px; background: linear-gradient(135deg, #e5e7eb, #9ca3af); border-radius: 4px;"></div>
                    
                    <!-- Reflected ray -->
                    <div class="light-ray visible" style="left: 188px; top: 109px; width: 100px; transform: rotate(-30deg);"></div>
                    
                    <!-- Normal line (dashed) -->
                    <div style="position: absolute; left: 182px; top: 60px; width: 4px; height: 120px; border-left: 2px dashed #fbbf24; opacity: 0.7;"></div>
                    
                    <!-- Angle markers -->
                    <div style="position: absolute; left: 140px; top: 90px; font-size: 0.8rem; color: #fbbf24;">Incident Ray</div>
                    <div style="position: absolute; left: 220px; top: 90px; font-size: 0.8rem; color: #fbbf24;">Reflected Ray</div>
                    <div style="position: absolute; left: 190px; top: 40px; font-size: 0.8rem; color: #fbbf24;">Normal</div>
                </div>
                
                <div class="experiment-controls">
                    <button class="experiment-btn" onclick="changeReflectionAngle()">üìê Change Angle</button>
                    <button class="experiment-btn" onclick="addMirror()">ü™û Add Mirror</button>
                    <button class="experiment-btn" onclick="resetReflection()">üîÑ Reset</button>
                </div>
            </div>
            <div class="system-diagram">
                <h4>Laws of Reflection:</h4>
                <ul>
                    <li>üìê <strong>Angle In = Angle Out:</strong> Light reflects at the same angle it hits</li>
                    <li>üìè <strong>Same Plane:</strong> All rays stay in the same flat surface</li>
                    <li>ü™û <strong>Smooth Surfaces:</strong> Give clear reflections (mirrors, water)</li>
                    <li>üåä <strong>Rough Surfaces:</strong> Scatter light in many directions</li>
                </ul>
            </div>
            <div class="grid-2">
                <div class="info-card blue-card">
                    <h4>ü™û Good Reflectors:</h4>
                    <ul>
                        <li>Mirrors</li>
                        <li>Still water</li>
                        <li>Polished metal</li>
                        <li>Glass surfaces</li>
                    </ul>
                </div>
                <div class="info-card green-card">
                    <h4>üåü Uses of Reflection:</h4>
                    <ul>
                        <li>Seeing ourselves in mirrors</li>
                        <li>Car headlights and reflectors</li>
                        <li>Telescopes and periscopes</li>
                        <li>Solar panels and collectors</li>
                    </ul>
                </div>
            </div>
        `,
        notes: {
            text: "Light reflection follows predictable laws that allow us to design mirrors, telescopes, and other optical devices. Understanding reflection helps explain how we see ourselves and objects around us.",
            images: ["ü™û Reflection diagrams", "üìê Angle measurements"]
        }
    },
    {
        content: `
            <h3>Mirrors & Reflection</h3>
            <p>Mirrors are special surfaces that reflect light very well, creating clear images of objects!</p>
            <div class="light-experiment" id="mirror-demo">
                <h4 style="text-align: center; margin-bottom: 20px;">ü™û Virtual Mirror Lab</h4>
                <div style="position: relative; height: 220px; background: #1e1b4b; border-radius: 10px;">
                    <!-- Object -->
                    <div style="position: absolute; left: 80px; top: 80px; font-size: 3rem;">üïØÔ∏è</div>
                    
                    <!-- Mirror -->
                    <div style="position: absolute; left: 200px; top: 40px; width: 8px; height: 140px; background: linear-gradient(135deg, #e5e7eb, #9ca3af); border-radius: 4px; box-shadow: 0 0 10px rgba(229, 231, 235, 0.5);"></div>
                    
                    <!-- Reflected image (appears behind mirror) -->
                    <div style="position: absolute; left: 280px; top: 80px; font-size: 3rem; opacity: 0.7; transform: scaleX(-1);">üïØÔ∏è</div>
                    
                    <!-- Light rays -->
                    <div class="light-ray visible" style="left: 110px; top: 99px; width: 90px; transform: rotate(0deg);"></div>
                    <div class="light-ray visible" style="left: 110px; top: 99px; width: 85px; transform: rotate(15deg);"></div>
                    <div class="light-ray visible" style="left: 110px; top: 99px; width: 85px; transform: rotate(-15deg);"></div>
                    
                    <!-- Reflected rays -->
                    <div class="light-ray visible" style="left: 208px; top: 99px; width: 90px; transform: rotate(180deg);"></div>
                    <div class="light-ray visible" style="left: 208px; top: 99px; width: 85px; transform: rotate(165deg);"></div>
                    <div class="light-ray visible" style="left: 208px; top: 99px; width: 85px; transform: rotate(195deg);"></div>
                    
                    <!-- Labels -->
                    <div style="position: absolute; left: 70px; top: 130px; font-size: 0.8rem; color: #fbbf24;">Real Object</div>
                    <div style="position: absolute; left: 180px; top: 20px; font-size: 0.8rem; color: #e5e7eb;">Mirror</div>
                    <div style="position: absolute; left: 260px; top: 130px; font-size: 0.8rem; color: #fbbf24;">Virtual Image</div>
                </div>
                
                <div class="experiment-controls">
                    <button class="experiment-btn" onclick="changeObject()">üîÑ Change Object</button>
                    <button class="experiment-btn" onclick="moveMirror()">‚ÜîÔ∏è Move Mirror</button>
                    <button class="experiment-btn" onclick="showRayPath()">üìê Show Ray Path</button>
                </div>
            </div>
            <div class="grid-3">
                <div class="info-card blue-card">
                    <h4>ü™û Mirror Properties:</h4>
                    <ul>
                        <li>Very smooth surface</li>
                        <li>Reflects almost all light</li>
                        <li>Creates clear images</li>
                        <li>Image appears behind mirror</li>
                    </ul>
                </div>
                <div class="info-card green-card">
                    <h4>üîç Image Properties:</h4>
                    <ul>
                        <li>Same size as object</li>
                        <li>Same distance behind mirror</li>
                        <li>Left-right reversed</li>
                        <li>Virtual (not real)</li>
                    </ul>
                </div>
                <div class="info-card yellow-card">
                    <h4>üåü Mirror Uses:</h4>
                    <ul>
                        <li>Bathrooms and bedrooms</li>
                        <li>Car rear-view mirrors</li>
                        <li>Telescopes and microscopes</li>
                        <li>Dental and medical tools</li>
                    </ul>
                </div>
            </div>
        `,
        notes: {
            text: "Mirrors demonstrate perfect reflection and help students understand how images form. The concept of virtual images introduces students to the idea that what we see isn't always where it appears to be.",
            images: ["ü™û Mirror images", "üîç Image formation"]
        }
    },
    {
        content: `
            <h3>Virtual Light Lab</h3>
            <p>Experiment with different light setups and discover how light behaves in various situations!</p>
            <div class="light-experiment" id="virtual-light-lab">
                <h4 style="text-align: center; margin-bottom: 20px;">üî¨ Advanced Light Laboratory</h4>
                <div style="position: relative; height: 250px; background: #1e1b4b; border: 3px solid #f59e0b; border-radius: 15px;">
                    <!-- Multiple light sources -->
                    <div class="light-source" id="lab-light1" style="left: 50px; top: 50px;" onclick="toggleLight('lab-light1')"></div>
                    <div class="light-source" id="lab-light2" style="left: 50px; top: 150px;" onclick="toggleLight('lab-light2')"></div>
                    
                    <!-- Adjustable objects -->
                    <div class="shadow-object" id="lab-obj1" style="left: 150px; top: 80px; width: 40px; height: 60px;" onmousedown="startDragLabObject(event, 'lab-obj1')">üè†</div>
                    <div class="shadow-object" id="lab-obj2" style="left: 220px; top: 120px; width: 30px; height: 30px; border-radius: 50%;" onmousedown="startDragLabObject(event, 'lab-obj2')">‚öΩ</div>
                    
                    <!-- Mirror -->
                    <div id="lab-mirror" style="position: absolute; left: 300px; top: 100px; width: 8px; height: 80px; background: linear-gradient(135deg, #e5e7eb, #9ca3af); border-radius: 4px; cursor: pointer;" onclick="rotateMirror()"></div>
                    
                    <!-- Screen -->
                    <div style="position: absolute; right: 20px; top: 20px; bottom: 20px; width: 6px; background: #f3f4f6; border-radius: 3px;"></div>
                    
                    <!-- Control panel -->
                    <div style="position: absolute; bottom: 10px; left: 10px; right: 10px; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
                        <div style="color: #fbbf24; font-size: 0.8rem;">
                            Lights: <span id="light-count">0</span> | Objects: <span id="object-count">2</span>
                        </div>
                        <div style="color: #fbbf24; font-size: 0.8rem;">
                            Click lights to toggle | Drag objects to move
                        </div>
                    </div>
                </div>
                
                <div class="experiment-controls">
                    <button class="experiment-btn" onclick="addLightSource()">üí° Add Light</button>
                    <button class="experiment-btn" onclick="addLabObject()">üì¶ Add Object</button>
                    <button class="experiment-btn" onclick="toggleMirror()">ü™û Toggle Mirror</button>
                    <button class="experiment-btn" onclick="changeBackground()">üé® Background</button>
                    <button class="experiment-btn" onclick="saveSetup()">üíæ Save Setup</button>
                    <button class="experiment-btn" onclick="resetVirtualLab()">üîÑ Reset Lab</button>
                </div>
                
                <div class="fun-fact" style="margin-top: 20px;">
                    <h4>üß™ Lab Challenges!</h4>
                    <p>Try these experiments: 1) Create overlapping shadows with multiple lights 2) Use the mirror to redirect light 3) Make the biggest shadow possible 4) Create a shadow with no penumbra</p>
                </div>
            </div>
        `,
        notes: {
            text: "The virtual light lab allows students to experiment freely with light concepts, encouraging discovery learning and hypothesis testing. This open-ended exploration builds scientific thinking skills.",
            images: ["üî¨ Virtual experiments", "üß™ Light exploration"]
        }
    },
    {
        content: `
            <h3>Shadow Puppet Game</h3>
            <p>Create amazing shadow puppet shows while learning about light and shadows!</p>
            <div class="shadow-theater" id="puppet-game-stage">
                <h4 style="text-align: center; margin-bottom: 20px;">üé≠ Shadow Puppet Adventure</h4>
                
                <!-- Game screen -->
                <div class="theater-screen" id="puppet-game-screen" style="height: 220px;">
                    <!-- Adjustable light -->
                    <div class="theater-light" id="game-light" style="left: 30px; top: 20px;" onmousedown="startDragGameLight(event)"></div>
                    
                    <!-- Puppet collection -->
                    <div class="puppet" id="game-puppet1" style="left: 100px; bottom: 0;" onmousedown="startDragGamePuppet(event, 'game-puppet1')">üê∞</div>
                    <div class="puppet" id="game-puppet2" style="left: 150px; bottom: 0;" onmousedown="startDragGamePuppet(event, 'game-puppet2')">ü¶ã</div>
                    <div class="puppet" id="game-puppet3" style="left: 200px; bottom: 0;" onmousedown="startDragGamePuppet(event, 'game-puppet3')">üå≥</div>
                    <div class="puppet" id="game-puppet4" style="left: 250px; bottom: 0;" onmousedown="startDragGamePuppet(event, 'game-puppet4')">üè∞</div>
                    
                    <!-- Dynamic shadows -->
                    <div class="puppet-shadow" id="game-shadow1" style="left: 120px; bottom: 0; width: 40px; height: 30px;"></div>
                    <div class="puppet-shadow" id="game-shadow2" style="left: 170px; bottom: 0; width: 35px; height: 25px;"></div>
                    <div class="puppet-shadow" id="game-shadow3" style="left: 220px; bottom: 0; width: 60px; height: 45px;"></div>
                    <div class="puppet-shadow" id="game-shadow4" style="left: 270px; bottom: 0; width: 80px; height: 60px;"></div>
                    
                    <!-- Story elements -->
                    <div style="position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.7); color: white; padding: 8px; border-radius: 5px; font-size: 0.8rem;">
                        Story Mode: <span id="story-mode">Free Play</span>
                    </div>
                </div>
                
                <div class="puppet-controls">
                    <button class="experiment-btn" onclick="startStoryMode()">üìñ Story Mode</button>
                    <button class="experiment-btn" onclick="addNewPuppet()">üé≠ New Puppet</button>
                    <button class="experiment-btn" onclick="recordShow()">üé¨ Record Show</button>
                    <button class="experiment-btn" onclick="playbackShow()">‚ñ∂Ô∏è Playback</button>
                    <button class="experiment-btn" onclick="shareShow()">üì§ Share</button>
                    <button class="experiment-btn" onclick="resetPuppetGame()">üîÑ Reset</button>
                </div>
                
                <!-- Story challenges -->
                <div class="system-diagram" style="margin-top: 20px;">
                    <h4>üé™ Story Challenges:</h4>
                    <ul>
                        <li>üåÖ <strong>Morning Scene:</strong> Make long shadows like sunrise</li>
                        <li>üåû <strong>Noon Scene:</strong> Create short shadows from above</li>
                        <li>üåô <strong>Night Scene:</strong> Use dim light for mysterious shadows</li>
                        <li>üé≠ <strong>Drama Scene:</strong> Use shadows to tell a story without words</li>
                    </ul>
                </div>
            </div>
        `,
        notes: {
            text: "Shadow puppet games combine creativity with scientific learning, allowing students to explore light concepts through storytelling and artistic expression. This multisensory approach enhances retention and engagement.",
            images: ["üé≠ Shadow puppets", "üìñ Story learning"]
        }
    },
    {
        content: `
            <h3>Light Path Tracer</h3>
            <p>Follow the path of light rays as they travel, reflect, and create amazing patterns!</p>
            <div class="light-experiment" id="light-path-tracer">
                <h4 style="text-align: center; margin-bottom: 20px;">üîç Interactive Light Path Tracer</h4>
                <div style="position: relative; height: 250px; background: #1e1b4b; border: 2px solid #f59e0b; border-radius: 10px;">
                    <!-- Light source with adjustable direction -->
                    <div class="light-source active" id="tracer-light" style="left: 50px; top: 100px;"></div>
                    
                    <!-- Adjustable mirrors -->
                    <div id="mirror1" style="position: absolute; left: 150px; top: 80px; width: 8px; height: 60px; background: linear-gradient(135deg, #e5e7eb, #9ca3af); border-radius: 4px; cursor: pointer; transform: rotate(45deg);" onclick="adjustMirror('mirror1')"></div>
                    <div id="mirror2" style="position: absolute; left: 250px; top: 120px; width: 8px; height: 60px; background: linear-gradient(135deg, #e5e7eb, #9ca3af); border-radius: 4px; cursor: pointer; transform: rotate(-30deg);" onclick="adjustMirror('mirror2')"></div>
                    
                    <!-- Target -->
                    <div id="light-target" style="position: absolute; right: 50px; top: 180px; width: 40px; height: 40px; background: #dc2626; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">üéØ</div>
                    
                    <!-- Light path visualization -->
                    <svg id="light-path-svg" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">
                        <defs>
                            <marker id="light-arrow" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
                                <polygon points="0 0, 8 3, 0 6" fill="#fbbf24" />
                            </marker>
                        </defs>
                        <!-- Light path will be drawn here dynamically -->
                    </svg>
                    
                    <!-- Score display -->
                    <div style="position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.7); color: #fbbf24; padding: 8px; border-radius: 5px; font-size: 0.9rem;">
                        Target Hit: <span id="target-score">0</span>/10
                    </div>
                    
                    <!-- Instructions -->
                    <div style="position: absolute; bottom: 10px; left: 10px; color: #fbbf24; font-size: 0.8rem;">
                        Click mirrors to rotate them and guide light to the target!
                    </div>
                </div>
                
                <div class="experiment-controls">
                    <button class="experiment-btn" onclick="rotateLightSource()">üîÑ Rotate Light</button>
                    <button class="experiment-btn" onclick="addMirrorToTracer()">ü™û Add Mirror</button>
                    <button class="experiment-btn" onclick="moveTarget()">üéØ Move Target</button>
                    <button class="experiment-btn" onclick="showLightPath()">üìê Show Path</button>
                    <button class="experiment-btn" onclick="nextTracerLevel()">‚¨ÜÔ∏è Next Level</button>
                    <button class="experiment-btn" onclick="resetTracer()">üîÑ Reset</button>
                </div>
                
                <div class="grid-2" style="margin-top: 20px;">
                    <div class="info-card yellow-card">
                        <h4>üéÆ Game Rules:</h4>
                        <ul>
                            <li>Guide light to hit the red target</li>
                            <li>Use mirrors to change light direction</li>
                            <li>Light travels in straight lines</li>
                            <li>Angle of reflection = Angle of incidence</li>
                        </ul>
                    </div>
                    <div class="info-card blue-card">
                        <h4>üèÜ Scoring:</h4>
                        <ul>
                            <li>Hit target: +1 point</li>
                            <li>Use fewer mirrors: Bonus points</li>
                            <li>Complete all levels to win</li>
                            <li>Challenge friends to beat your score!</li>
                        </ul>
                    </div>
                </div>
            </div>
        `,
        notes: {
            text: "The light path tracer gamifies learning about reflection and light travel, making abstract concepts concrete through interactive problem-solving. Students learn by doing and seeing immediate results.",
            images: ["üîç Light tracing", "üéÆ Educational games"]
        }
    },
    {
        content: `
            <h3>Reflection Explorer</h3>
            <p>Discover how different surfaces reflect light and create various effects!</p>
            <div class="light-experiment" id="reflection-explorer">
                <h4 style="text-align: center; margin-bottom: 20px;">ü™û Surface Reflection Laboratory</h4>
                <div style="position: relative; height: 220px; background: #1e1b4b; border-radius: 10px;">
                    <!-- Light source -->
                    <div class="light-source active" style="left: 80px; top: 80px;"></div>
                    
                    <!-- Different surface types -->
                    <div id="surface-selector" style="position: absolute; left: 200px; top: 60px; width: 120px; height: 100px;">
                        <!-- Current surface -->
                        <div id="current-surface" style="width: 100%; height: 100%; background: linear-gradient(135deg, #e5e7eb, #9ca3af); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 2rem; cursor: pointer;" onclick="changeSurface()">
                            ü™û
                        </div>
                        
                        <!-- Surface label -->
                        <div style="text-align: center; margin-top: 5px; color: #fbbf24; font-size: 0.9rem; font-weight: bold;" id="surface-label">
                            Smooth Mirror
                        </div>
                    </div>
                    
                    <!-- Incident light ray -->
                    <div class="light-ray visible" style="left: 120px; top: 99px; width: 80px; transform: rotate(20deg);"></div>
                    
                    <!-- Reflected rays (change based on surface) -->
                    <div id="reflected-rays">
                        <div class="light-ray visible" style="left: 320px; top: 119px; width: 80px; transform: rotate(-20deg);"></div>
                    </div>
                    
                    <!-- Reflection quality indicator -->
                    <div style="position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.7); color: #fbbf24; padding: 8px; border-radius: 5px; font-size: 0.8rem;">
                        Reflection Quality: <span id="reflection-quality">Perfect</span>
                    </div>
                </div>
                
                <div class="experiment-controls">
                    <button class="experiment-btn" onclick="changeSurface()">üîÑ Change Surface</button>
                    <button class="experiment-btn" onclick="adjustLightAngle()">üìê Adjust Angle</button>
                    <button class="experiment-btn" onclick="showReflectionRays()">üìä Show All Rays</button>
                    <button class="experiment-btn" onclick="measureAngles()">üìè Measure Angles</button>
                    <button class="experiment-btn" onclick="resetReflectionExplorer()">üîÑ Reset</button>
                </div>
                
                <!-- Surface types explanation -->
                <div class="grid-4" style="margin-top: 20px;">
                    <div class="info-card blue-card">
                        <div style="font-size: 1.5rem; margin-bottom: 8px;">ü™û</div>
                        <h4>Smooth Mirror</h4>
                        <p>Perfect reflection, clear image</p>
                    </div>
                    <div class="info-card gray-card">
                        <div style="font-size: 1.5rem; margin-bottom: 8px;">üåä</div>
                        <h4>Water Surface</h4>
                        <p>Good reflection when still</p>
                    </div>
                    <div class="info-card yellow-card">
                        <div style="font-size: 1.5rem; margin-bottom: 8px;">üìÑ</div>
                        <h4>Paper</h4>
                        <p>Diffuse reflection, no clear image</p>
                    </div>
                    <div class="info-card green-card">
                        <div style="font-size: 1.5rem; margin-bottom: 8px;">üß±</div>
                        <h4>Rough Wall</h4>
                        <p>Scattered reflection</p>
                    </div>
                </div>
                
                <div class="fun-fact" style="margin-top: 20px;">
                    <h4>üîç Reflection Facts!</h4>
                    <p>Smooth surfaces give specular (mirror-like) reflection, while rough surfaces give diffuse (scattered) reflection. This is why you can see yourself in a mirror but not in paper!</p>
                </div>
            </div>
        `,
        notes: {
            text: "Exploring different reflection types helps students understand why some surfaces act as mirrors while others don't. This concept connects to material properties and surface texture effects on light behavior.",
            images: ["ü™û Surface types", "üìä Reflection patterns"]
        }
    }
     ];

let currentSlideIndex = 0;
let sidebarOpen = false;
let aiHelpOpen = false;
let sidebarTouchStartX = 0;
let sidebarTouchEndX = 0;

function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const slideModal = document.getElementById('slide-modal');
    const menuToggle = document.getElementById('menu-toggle');
    const overlay = document.getElementById('sidebar-overlay');
    
    sidebarOpen = !sidebarOpen;
    
    if (sidebarOpen) {
        sidebar.classList.add('open');
        slideModal.classList.add('sidebar-open');
        menuToggle.classList.add('sidebar-open');
        menuToggle.innerHTML = '‚úï';
        overlay.classList.add('show');
        document.body.style.overflow = 'hidden';
    } else {
        sidebar.classList.remove('open');
        slideModal.classList.remove('sidebar-open');
        menuToggle.classList.remove('sidebar-open');
        menuToggle.innerHTML = '‚ò∞';
        overlay.classList.remove('show');
        document.body.style.overflow = '';
    }
}

function toggleAIHelp() {
    const panel = document.getElementById('ai-help-panel');
    const toggle = document.getElementById('ai-help-toggle');
    
    aiHelpOpen = !aiHelpOpen;
    
    if (aiHelpOpen) {
        panel.classList.add('open');
        toggle.classList.add('active');
        toggle.innerHTML = '‚úï';
    } else {
        panel.classList.remove('open');
        toggle.classList.remove('active');
        toggle.innerHTML = 'ü§ñ';
    }
}

function askAI(question) {
    const input = document.getElementById('ai-input');
    input.value = question;
    sendAIMessage();
}

function sendAIMessage() {
    const input = document.getElementById('ai-input');
    const messages = document.getElementById('ai-chat-messages');
    const question = input.value.trim();
    
    if (!question) return;
    
    const userMessage = document.createElement('div');
    userMessage.className = 'ai-message user';
    userMessage.textContent = question;
    messages.appendChild(userMessage);
    
    input.value = '';
    
    setTimeout(() => {
        const botMessage = document.createElement('div');
        botMessage.className = 'ai-message bot';
        botMessage.textContent = generateAIResponse(question);
        messages.appendChild(botMessage);
        messages.scrollTop = messages.scrollHeight;
    }, 1000);
    
    messages.scrollTop = messages.scrollHeight;
}

function generateAIResponse(question) {
    const responses = {
        'explain living things': 'Living things have 7 key characteristics: Movement, Respiration, Sensitivity, Growth, Reproduction, Excretion, and Nutrition (MRS GREN). They can respond to their environment and need food, water, and air to survive! üå±',
        'what is diversity': 'Diversity means variety! It\'s all the different types of living things, materials, and objects in our world. Think of all the different animals, plants, and materials you see around you - that\'s diversity! üåç',
        'help with quiz': 'Remember the key points: Living things grow and reproduce, non-living things don\'t. Natural materials come from nature (wood, wool), man-made materials are created by humans (plastic, glass). You\'ve got this! üí™',
        'natural materials': 'Natural materials come directly from nature - like wood from trees, cotton from plants, wool from sheep, and stone from the earth. They\'re not made by humans! üåø',
        'man-made materials': 'Man-made materials are created by humans, like plastic (from oil), glass (from sand), and steel (from iron). We use technology to make these! üè≠'
    };
    
    const key = question.toLowerCase();
    for (const [keyword, response] of Object.entries(responses)) {
        if (key.includes(keyword.replace(/\s+/g, '')) || key.includes(keyword)) {
            return response;
        }
    }
    
    return `That's a great question about diversity! Based on slide ${currentSlideIndex + 1}, I'd suggest focusing on the key concepts we've covered. Feel free to ask more specific questions! üòä`;
}

function handleAIKeyPress(event) {
    if (event.key === 'Enter') {
        event.preventDefault();
        sendAIMessage();
    }
}

function renderSidebar() {
    const sidebar = document.getElementById('sidebar');
    sidebar.innerHTML = '';
    
    subtopicSections.forEach(section => {
        const headerDiv = document.createElement('div');
        headerDiv.className = 'subtopic-section';
        
        const header = document.createElement('div');
        header.className = 'subtopic-header';
        header.textContent = section.title;
        headerDiv.appendChild(header);
        
        section.subtopics.forEach(subtopic => {
            const btn = document.createElement('button');
            btn.className = 'subtopic-btn' + (currentSlideIndex === subtopic.slideIndex ? ' active' : '');
            btn.textContent = subtopic.title;
            btn.onclick = () => {
                currentSlideIndex = subtopic.slideIndex;
                loadSlide();
                if (window.innerWidth <= 768) {
                    toggleSidebar();
                }
            };
            headerDiv.appendChild(btn);
        });
        
        sidebar.appendChild(headerDiv);
    });
}

function loadSlide() {
    const slideContentEl = document.getElementById('slide-content');
    
    slideContentEl.innerHTML = '';
    
    const mainArea = document.createElement('div');
    mainArea.className = 'main-slide-area';
    mainArea.id = 'main-slide-area';
    
    const slideEl = document.createElement('div');
    slideEl.className = 'slide active';
    slideEl.innerHTML = slides[currentSlideIndex].content;
    mainArea.appendChild(slideEl);
    
    slideContentEl.appendChild(mainArea);
    
    if (slides[currentSlideIndex].notes) {
        const notesSection = document.createElement('div');
        notesSection.className = 'notes-section';
        
        notesSection.innerHTML = `
            <div class="notes-header">
                <span>üìù</span>
                <span>Study Notes</span>
            </div>
            <div class="notes-content">
                <div class="notes-text">
                    ${slides[currentSlideIndex].notes.text}
                </div>
                <div class="notes-images">
                    ${slides[currentSlideIndex].notes.images.map(img => 
                        `<div class="bw-image">${img}</div>`
                    ).join('')}
                </div>
            </div>
        `;
        
        slideContentEl.appendChild(notesSection);
    }
    
    updateSlideCounter();
    updateNavigationButtons();
    updateSlideProgress();
    renderSidebar();
}

function updateSlideCounter() {
    document.getElementById('slide-counter').textContent = `${currentSlideIndex + 1} / ${slides.length}`;
}

function updateNavigationButtons() {
    document.getElementById('prev-slide-btn').disabled = currentSlideIndex === 0;
    document.getElementById('next-slide-btn').disabled = false;
    document.getElementById('next-slide-btn').textContent = (currentSlideIndex === slides.length - 1) ? 'Finish' : 'Next ‚Üí';
}

function updateSlideProgress() {
    const progressEl = document.getElementById('slide-progress');
    progressEl.innerHTML = '';
    for (let i = 0; i < slides.length; i++) {
        const dot = document.createElement('div');
        dot.className = 'progress-dot' + (i === currentSlideIndex ? ' active' : '');
        progressEl.appendChild(dot);
    }
}

function nextSlide() {
    if (currentSlideIndex < slides.length - 1) {
        currentSlideIndex++;
        loadSlide();
    } else {
        alert('Congratulations! You have completed the Living & Non-Living Things lesson!');
    }
}

function previousSlide() {
    if (currentSlideIndex > 0) {
        currentSlideIndex--;
        loadSlide();
    }
}

function selectQuizAnswer(button, isCorrect, slideNum) {
    const options = button.parentElement.querySelectorAll('.quiz-option');
    const explanation = document.getElementById(`explanation${slideNum}`);
    
    options.forEach(option => {
        option.disabled = true;
        option.style.pointerEvents = 'none';
    });
    
    button.classList.add('selected');
    
    if (isCorrect) {
        button.classList.add('correct');
    } else {
        button.classList.add('incorrect');
        options.forEach(option => {
            if (option.onclick.toString().includes('true')) {
                option.classList.add('correct');
            }
        });
    }
    
    explanation.classList.add('show');
}

let touchStartY = 0;
let touchEndY = 0;

document.addEventListener('touchstart', function(event) {
    touchStartY = event.changedTouches[0].screenY;
    if (sidebarOpen && event.target.closest('#sidebar')) {
        sidebarTouchStartX = event.changedTouches[0].screenX;
    }
}, false);

document.addEventListener('touchend', function(event) {
    touchEndY = event.changedTouches[0].screenY;
    if (sidebarOpen && event.target.closest('#sidebar')) {
        sidebarTouchEndX = event.changedTouches[0].screenX;
        handleSidebarSwipe();
    } else {
        handleSlideSwipe();
    }
}, false);

function handleSlideSwipe() {
    const swipeThreshold = 50;
    const swipeDistance = touchEndY - touchStartY;
    
    if (Math.abs(swipeDistance) > swipeThreshold) {
        if (swipeDistance > 0 && currentSlideIndex > 0) {
            previousSlide();
        } else if (swipeDistance < 0 && currentSlideIndex < slides.length - 1) {
            nextSlide();
        }
    }
}

function handleSidebarSwipe() {
    const swipeThreshold = 50;
    const swipeDistance = sidebarTouchEndX - sidebarTouchStartX;
    
    if (swipeDistance < -swipeThreshold && sidebarOpen) {
        toggleSidebar();
    }
}

document.addEventListener('click', function(event) {
    const sidebar = document.getElementById('sidebar');
    const menuToggle = document.getElementById('menu-toggle');
    const overlay = document.getElementById('sidebar-overlay');
    
    if (sidebarOpen && !sidebar.contains(event.target) && !menuToggle.contains(event.target) && event.target === overlay) {
        if (window.innerWidth <= 768) {
            toggleSidebar();
        }
    }
});

document.addEventListener('click', function(event) {
    const aiWidget = document.querySelector('.ai-help-widget');
    const aiPanel = document.getElementById('ai-help-panel');
    
    if (aiHelpOpen && !aiWidget.contains(event.target)) {
        toggleAIHelp();
    }
});

let lastTouchEnd = 0;
document.addEventListener('touchend', function(event) {
    const now = (new Date()).getTime();
    if (now - lastTouchEnd <= 300) {
        event.preventDefault();
    }
    lastTouchEnd = now;
}, false);

window.addEventListener('orientationchange', function() {
    setTimeout(function() {
        document.body.style.display = 'none';
        document.body.offsetHeight;
        document.body.style.display = '';
        if (sidebarOpen) {
            toggleSidebar();
        }
    }, 100);
});

// Light Experiment Functions
function toggleLightSource() {
    const lightSource = document.getElementById('demo-light-source');
    const rays = document.querySelectorAll('#light-travel-demo .light-ray');
    
    if (lightSource.classList.contains('active')) {
        lightSource.classList.remove('active');
        rays.forEach(ray => ray.classList.remove('visible'));
    } else {
        lightSource.classList.add('active');
        rays.forEach(ray => ray.classList.add('visible'));
    }
}

function resetLightDemo() {
    const lightSource = document.getElementById('demo-light-source');
    const rays = document.querySelectorAll('#light-travel-demo .light-ray');
    
    lightSource.classList.add('active');
    rays.forEach(ray => ray.classList.add('visible'));
}

// Interactive Light Lab Functions
let isDraggingLight = false;
let isDraggingObject = false;
let dragTarget = null;

function startDragLight(event) {
    event.preventDefault();
    isDraggingLight = true;
    dragTarget = event.target;
    
    const moveHandler = (e) => {
        if (!isDraggingLight) return;
        
        const rect = dragTarget.parentElement.getBoundingClientRect();
        const clientX = e.clientX || (e.touches && e.touches[0].clientX);
        const clientY = e.clientY || (e.touches && e.touches[0].clientY);
        
        const x = Math.max(0, Math.min(rect.width - 40, clientX - rect.left - 20));
        const y = Math.max(0, Math.min(rect.height - 40, clientY - rect.top - 20));
        
        dragTarget.style.left = x + 'px';
        dragTarget.style.top = y + 'px';
        
        updateLightRays();
    };
    
    const endHandler = () => {
        isDraggingLight = false;
        dragTarget = null;
        document.removeEventListener('mousemove', moveHandler);
        document.removeEventListener('mouseup', endHandler);
        document.removeEventListener('touchmove', moveHandler);
        document.removeEventListener('touchend', endHandler);
    };
    
    document.addEventListener('mousemove', moveHandler);
    document.addEventListener('mouseup', endHandler);
    document.addEventListener('touchmove', moveHandler);
    document.addEventListener('touchend', endHandler);
}

function startDragObject(event, objectId) {
    event.preventDefault();
    isDraggingObject = true;
    dragTarget = document.getElementById(objectId);
    
    const moveHandler = (e) => {
        if (!isDraggingObject) return;
        
        const rect = dragTarget.parentElement.getBoundingClientRect();
        const clientX = e.clientX || (e.touches && e.touches[0].clientX);
        const clientY = e.clientY || (e.touches && e.touches[0].clientY);
        
        const x = Math.max(0, Math.min(rect.width - 50, clientX - rect.left - 25));
        const y = Math.max(0, Math.min(rect.height - 80, clientY - rect.top - 40));
        
        dragTarget.style.left = x + 'px';
        dragTarget.style.top = y + 'px';
        
        updateShadows();
    };
    
    const endHandler = () => {
        isDraggingObject = false;
        dragTarget = null;
        document.removeEventListener('mousemove', moveHandler);
        document.removeEventListener('mouseup', endHandler);
        document.removeEventListener('touchmove', moveHandler);
        document.removeEventListener('touchend', endHandler);
    };
    
    document.addEventListener('mousemove', moveHandler);
    document.addEventListener('mouseup', endHandler);
    document.addEventListener('touchmove', moveHandler);
    document.addEventListener('touchend', endHandler);
}

function updateLightRays() {
    const lightSource = document.getElementById('lab-light-source');
    const rays = document.querySelectorAll('#interactive-light-lab .light-ray');
    
    if (!lightSource) return;
    
    const lightRect = lightSource.getBoundingClientRect();
    const containerRect = lightSource.parentElement.getBoundingClientRect();
    
    const lightX = lightRect.left - containerRect.left + 20;
    const lightY = lightRect.top - containerRect.top + 20;
    
    rays.forEach((ray, index) => {
        ray.style.left = lightX + 'px';
        ray.style.top = (lightY - 1) + 'px';
    });
}

function updateShadows() {
    // Update shadow positions based on object positions
    const objects = document.querySelectorAll('#interactive-light-lab .shadow-object');
    const shadows = document.querySelectorAll('#interactive-light-lab .shadow-cast');
    
    objects.forEach((obj, index) => {
        if (shadows[index]) {
            const objRect = obj.getBoundingClientRect();
            const containerRect = obj.parentElement.getBoundingClientRect();
            
            const objX = objRect.left - containerRect.left;
            const objY = objRect.top - containerRect.top;
            
            // Simple shadow calculation
            shadows[index].style.left = (objX + 30) + 'px';
            shadows[index].style.top = objY + 'px';
        }
    });
}

function addObject() {
    const container = document.getElementById('interactive-light-lab').querySelector('div[style*="position: relative"]');
    const newObject = document.createElement('div');
    newObject.className = 'shadow-object';
    newObject.style.cssText = 'left: 150px; top: 150px; width: 40px; height: 40px;';
    newObject.textContent = 'üì¶';
    newObject.onmousedown = (e) => startDragObject(e, newObject.id);
    newObject.ontouchstart = (e) => startDragObject(e, newObject.id);
    newObject.id = 'lab-object' + Date.now();
    
    container.appendChild(newObject);
}

function changeBackground() {
    const container = document.getElementById('interactive-light-lab').querySelector('div[style*="position: relative"]');
    const backgrounds = ['rgba(0,0,0,0.1)', 'rgba(0,0,100,0.1)', 'rgba(100,0,0,0.1)', 'rgba(0,100,0,0.1)'];
    const currentBg = container.style.background;
    const currentIndex = backgrounds.indexOf(currentBg);
    const nextIndex = (currentIndex + 1) % backgrounds.length;
    container.style.background = backgrounds[nextIndex];
}

function resetLightLab() {
    location.reload();
}

// Heat Transfer Functions
function toggleHeatTransfer() {
    const arrows = document.querySelectorAll('.heat-transfer-arrow');
    arrows.forEach(arrow => {
        arrow.classList.toggle('active');
    });
}

// Conductor Game Functions
function testMaterial(element, isConductor) {
    const lightBulb = document.querySelector('.light-bulb');
    const materials = document.querySelectorAll('.material-item');
    
    materials.forEach(item => item.classList.remove('selected'));
    element.classList.add('selected');
    
    if (isConductor) {
        element.classList.add('conductor');
        lightBulb.classList.add('lit');
        setTimeout(() => {
            alert('‚úÖ Correct! This material conducts electricity!');
        }, 500);
    } else {
        element.classList.add('insulator');
        lightBulb.classList.remove('lit');
        setTimeout(() => {
            alert('‚ùå This material is an insulator - it doesn\'t conduct electricity!');
        }, 500);
    }
}

// Shadow Theater Functions
let isDraggingPuppet = false;
let isDraggingGameLight = false;

function startDragPuppet(event, puppetId) {
    event.preventDefault();
    isDraggingPuppet = true;
    dragTarget = document.getElementById(puppetId);
    
    const moveHandler = (e) => {
        if (!isDraggingPuppet) return;
        
        const rect = dragTarget.parentElement.getBoundingClientRect();
        const clientX = e.clientX || (e.touches && e.touches[0].clientX);
        
        const x = Math.max(0, Math.min(rect.width - 50, clientX - rect.left - 25));
        
        dragTarget.style.left = x + 'px';
        updatePuppetShadows();
    };
    
    const endHandler = () => {
        isDraggingPuppet = false;
        dragTarget = null;
        document.removeEventListener('mousemove', moveHandler);
        document.removeEventListener('mouseup', endHandler);
        document.removeEventListener('touchmove', moveHandler);
        document.removeEventListener('touchend', endHandler);
    };
    
    document.addEventListener('mousemove', moveHandler);
    document.addEventListener('mouseup', endHandler);
    document.addEventListener('touchmove', moveHandler);
    document.addEventListener('touchend', endHandler);
}

function startDragGameLight(event) {
    event.preventDefault();
    isDraggingGameLight = true;
    dragTarget = event.target;
    
    const moveHandler = (e) => {
        if (!isDraggingGameLight) return;
        
        const rect = dragTarget.parentElement.getBoundingClientRect();
        const clientX = e.clientX || (e.touches && e.touches[0].clientX);
        
        const x = Math.max(0, Math.min(rect.width - 30, clientX - rect.left - 15));
        
        dragTarget.style.left = x + 'px';
        updatePuppetShadows();
    };
    
    const endHandler = () => {
        isDraggingGameLight = false;
        dragTarget = null;
        document.removeEventListener('mousemove', moveHandler);
        document.removeEventListener('mouseup', endHandler);
        document.removeEventListener('touchmove', moveHandler);
        document.removeEventListener('touchend', endHandler);
    };
    
    document.addEventListener('mousemove', moveHandler);
    document.addEventListener('mouseup', endHandler);
    document.addEventListener('touchmove', moveHandler);
    document.addEventListener('touchend', endHandler);
}

function updatePuppetShadows() {
    const puppets = document.querySelectorAll('.puppet');
    const shadows = document.querySelectorAll('.puppet-shadow');
    const light = document.querySelector('.theater-light');
    
    if (!light) return;
    
    const lightRect = light.getBoundingClientRect();
    const containerRect = light.parentElement.getBoundingClientRect();
    const lightX = lightRect.left - containerRect.left + 15;
    
    puppets.forEach((puppet, index) => {
        if (shadows[index]) {
            const puppetRect = puppet.getBoundingClientRect();
            const puppetX = puppetRect.left - containerRect.left + 25;
            
            // Calculate shadow position based on light position
            const shadowOffset = puppetX > lightX ? 30 : -30;
            const shadowSize = Math.abs(puppetX - lightX) / 5 + 20;
            
            shadows[index].style.left = (puppetX + shadowOffset) + 'px';
            shadows[index].style.width = shadowSize + 'px';
            shadows[index].style.height = (shadowSize * 0.7) + 'px';
        }
    });
}

function moveLight(direction) {
    const light = document.querySelector('.theater-light');
    const currentLeft = parseInt(light.style.left) || 50;
    
    if (direction === 'left' && currentLeft > 10) {
        light.style.left = (currentLeft - 20) + 'px';
    } else if (direction === 'right' && currentLeft < 200) {
        light.style.left = (currentLeft + 20) + 'px';
    }
    
    updatePuppetShadows();
}

function addPuppet() {
    const screen = document.querySelector('.theater-screen');
    const puppets = ['üê∏', 'ü¶ä', 'üêª', 'ü¶Å', 'üêº', 'ü¶ã', 'üå∫', '‚≠ê'];
    const randomPuppet = puppets[Math.floor(Math.random() * puppets.length)];
    
    const newPuppet = document.createElement('div');
    newPuppet.className = 'puppet';
    newPuppet.style.left = Math.random() * 200 + 'px';
    newPuppet.textContent = randomPuppet;
    newPuppet.id = 'puppet' + Date.now();
    newPuppet.onmousedown = (e) => startDragPuppet(e, newPuppet.id);
    newPuppet.ontouchstart = (e) => startDragPuppet(e, newPuppet.id);
    
    screen.appendChild(newPuppet);
    
    // Add corresponding shadow
    const newShadow = document.createElement('div');
    newShadow.className = 'puppet-shadow';
    newShadow.style.left = (parseInt(newPuppet.style.left) + 30) + 'px';
    newShadow.style.width = '40px';
    newShadow.style.height = '30px';
    
    screen.appendChild(newShadow);
}

function startShow() {
    alert('üé≠ Welcome to the Shadow Puppet Show! Move your puppets and light to create amazing stories!');
}

function resetTheater() {
    location.reload();
}

// Additional Interactive Functions
function showRayRules() {
    alert('üìè Light Ray Rules:\n1. Light travels in straight lines\n2. Light spreads out from sources\n3. Light can be blocked by objects\n4. Light reflects off shiny surfaces');
}

function drawMoreRays() {
    const container = document.getElementById('ray-diagram-demo');
    // Add more visual rays to the diagram
    alert('‚ûï More light rays added to show how light spreads out from the source!');
}

function hideRays() {
    const rays = document.querySelectorAll('#ray-diagram-demo .light-ray');
    rays.forEach(ray => {
        ray.style.opacity = ray.style.opacity === '0' ? '1' : '0';
    });
}

function moveLightUp() {
    const light = document.getElementById('shadow-light');
    const currentTop = parseInt(light.style.top) || 40;
    if (currentTop > 20) {
        light.style.top = (currentTop - 20) + 'px';
        updateShadowDemo();
    }
}

function moveLightDown() {
    const light = document.getElementById('shadow-light');
    const currentTop = parseInt(light.style.top) || 40;
    if (currentTop < 80) {
        light.style.top = (currentTop + 20) + 'px';
        updateShadowDemo();
    }
}

function changeShadowObject() {
    const objects = ['üè†', 'üå≥', 'üöó', '‚õ∞Ô∏è', 'üè∞'];
    const caster = document.getElementById('shadow-caster');
    const current = caster.textContent;
    const currentIndex = objects.indexOf(current);
    const nextIndex = (currentIndex + 1) % objects.length;
    caster.textContent = objects[nextIndex];
}

function updateShadowDemo() {
    // Update shadow position based on light position
    const light = document.getElementById('shadow-light');
    const shadow = document.querySelector('#shadow-formation-demo .shadow-cast');
    
    if (light && shadow) {
        const lightTop = parseInt(light.style.top) || 40;
        const shadowHeight = Math.max(60, 120 - lightTop);
        shadow.style.height = shadowHeight + 'px';
    }
}

// More interactive functions for advanced features
function toggleLightSize() {
    const light = document.querySelector('#shadow-types-demo div[style*="width: 60px"]');
    if (light) {
        const isLarge = light.style.width === '60px';
        light.style.width = isLarge ? '20px' : '60px';
        light.style.height = isLarge ? '20px' : '60px';
        light.textContent = isLarge ? 'üí°' : '‚òÄÔ∏è';
    }
}

function showShadowTypes() {
    alert('üåë Shadow Types:\n‚Ä¢ Umbra: Dark center shadow\n‚Ä¢ Penumbra: Lighter outer shadow\n‚Ä¢ Large light sources create fuzzy shadows\n‚Ä¢ Small light sources create sharp shadows');
}

function moveObjectCloser() {
    const obj = document.getElementById('size-demo-object');
    const shadow = document.getElementById('size-demo-shadow');
    
    const currentLeft = parseInt(obj.style.left) || 150;
    if (currentLeft > 100) {
        obj.style.left = (currentLeft - 20) + 'px';
        // Make shadow bigger when object is closer to light
        const shadowSize = Math.max(40, 100 - (currentLeft - 100));
        shadow.style.width = shadowSize + 'px';
        shadow.style.height = (shadowSize * 1.3) + 'px';
    }
}

function moveObjectFarther() {
    const obj = document.getElementById('size-demo-object');
    const shadow = document.getElementById('size-demo-shadow');
    
    const currentLeft = parseInt(obj.style.left) || 150;
    if (currentLeft < 250) {
        obj.style.left = (currentLeft + 20) + 'px';
        // Make shadow smaller when object is farther from light
        const shadowSize = Math.max(20, 100 - (currentLeft - 100));
        shadow.style.width = shadowSize + 'px';
        shadow.style.height = (shadowSize * 1.3) + 'px';
    }
}

function resetSizeDemo() {
    const obj = document.getElementById('size-demo-object');
    const shadow = document.getElementById('size-demo-shadow');
    
    obj.style.left = '150px';
    shadow.style.width = '60px';
    shadow.style.height = '80px';
}

// Placeholder functions for advanced features
function changeReflectionAngle() {
    alert('üìê Angle changed! Notice how the reflected ray angle matches the incident ray angle.');
}

function addMirror() {
    alert('ü™û New mirror added! Try reflecting light off multiple surfaces.');
}

function resetReflection() {
    alert('üîÑ Reflection demo reset to starting position.');
}

function changeObject() {
    const objects = ['üïØÔ∏è', 'üåü', 'üíé', 'üî•', 'üí°'];
    alert('üîÑ Object changed! See how different objects create different reflections.');
}

function moveMirror() {
    alert('‚ÜîÔ∏è Mirror moved! Watch how the reflected image position changes.');
}

function showRayPath() {
    alert('üìê Ray paths shown! Follow the light from object to eye via the mirror.');
}

// Advanced lab functions
function addLightSource() {
    alert('üí° New light source added! Multiple lights create interesting shadow patterns.');
}

function addLabObject() {
    alert('üì¶ New object added! Drag it around to see how shadows interact.');
}

function toggleMirror() {
    alert('ü™û Mirror toggled! Use mirrors to redirect light beams.');
}

function saveSetup() {
    alert('üíæ Setup saved! You can return to this configuration later.');
}

function resetVirtualLab() {
    location.reload();
}

// Game functions
function startStoryMode() {
    alert('üìñ Story Mode activated! Follow the prompts to create shadow puppet stories.');
}

function addNewPuppet() {
    addPuppet(); // Reuse the existing function
}

function recordShow() {
    alert('üé¨ Recording started! Your puppet show movements are being saved.');
}

function playbackShow() {
    alert('‚ñ∂Ô∏è Playing back your recorded show! Watch your puppet performance.');
}

function shareShow() {
    alert('üì§ Show shared! Your friends can now watch your shadow puppet creation.');
}

function resetPuppetGame() {
    location.reload();
}

// Advanced reflection functions
function changeSurface() {
    const surfaces = [
        { emoji: 'ü™û', label: 'Smooth Mirror', quality: 'Perfect' },
        { emoji: 'üåä', label: 'Water Surface', quality: 'Good' },
        { emoji: 'üìÑ', label: 'Paper', quality: 'Diffuse' },
        { emoji: 'üß±', label: 'Rough Wall', quality: 'Scattered' }
    ];
    
    const currentSurface = document.getElementById('current-surface');
    const label = document.getElementById('surface-label');
    const quality = document.getElementById('reflection-quality');
    
    const currentIndex = surfaces.findIndex(s => s.emoji === currentSurface.textContent);
    const nextIndex = (currentIndex + 1) % surfaces.length;
    const nextSurface = surfaces[nextIndex];
    
    currentSurface.textContent = nextSurface.emoji;
    label.textContent = nextSurface.label;
    quality.textContent = nextSurface.quality;
    
    // Update reflection pattern based on surface type
    updateReflectionPattern(nextSurface.quality);
}

function updateReflectionPattern(quality) {
    const reflectedRays = document.getElementById('reflected-rays');
    
    if (quality === 'Perfect') {
        reflectedRays.innerHTML = '<div class="light-ray visible" style="left: 320px; top: 119px; width: 80px; transform: rotate(-20deg);"></div>';
    } else if (quality === 'Scattered') {
        reflectedRays.innerHTML = `
            <div class="light-ray visible" style="left: 320px; top: 119px; width: 60px; transform: rotate(-10deg); opacity: 0.7;"></div>
            <div class="light-ray visible" style="left: 320px; top: 119px; width: 50px; transform: rotate(-30deg); opacity: 0.5;"></div>
            <div class="light-ray visible" style="left: 320px; top: 119px; width: 40px; transform: rotate(-45deg); opacity: 0.3;"></div>
        `;
    }
}

function adjustLightAngle() {
    alert('üìê Light angle adjusted! See how the reflection angle changes to match.');
}

function showReflectionRays() {
    alert('üìä All reflection rays shown! Notice the pattern of light scattering.');
}

function measureAngles() {
    alert('üìè Angles measured! Incident angle = Reflected angle (Law of Reflection)');
}

function resetReflectionExplorer() {
    location.reload();
}

window.onload = function() {
    loadSlide();
    
    const viewport = document.querySelector('meta[name="viewport"]');
    if (viewport) {
        viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover');
    }
};
</script>

</body>
</html>
